

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Thermal shift assay &#8212; Python For BIOC0029</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/ThermalShiftAssay';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chemical unfolding" href="ChemicalUnfolding.html" />
    <link rel="prev" title="Redox potential" href="RedoxPotential.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../WelcomeToPythonForBIOC0029.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../WelcomeToPythonForBIOC0029.html">
                    Welcome to Python for BIOC0029
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Running Python code</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapters/JupyterNotebooksGettingStarted.html">Jupyter Notebooks: Getting Started</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Python basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapters/VariablesDataTypesIndicesSlices.html">Variables, Data Types, Indices, and Slices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/ForLoopsLogicStatementsFunctions.html">For Loops, Logic Statements, and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/Libraries.html">Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/NumPyForArithmeticOperations.html">NumPy For Arithmetic Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/PandasForTabularData.html">Pandas For Working With Tabular Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/MatplotlibForPlotting.html">Matplotlib For Plotting And Data Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/SciPyForDataFitting.html">SciPy For Data Fitting</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DoseResponseCurve.html">Dose response curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="ColorimetricAssay.html">Colorimetric assay</a></li>
<li class="toctree-l1"><a class="reference internal" href="RedoxPotential.html">Redox potential</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Thermal shift assay</a></li>
<li class="toctree-l1"><a class="reference internal" href="ChemicalUnfolding.html">Chemical unfolding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Michaelis-MentenCurve.html">Michaelis-Menten curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="SimulatingData.html">Simulating data</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fexamples/ThermalShiftAssay.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/examples/ThermalShiftAssay.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Thermal shift assay</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-introduction-font"><strong><font color="blue">Introduction</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-data-font"><strong><font color="blue">Data</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-import-the-libraries-needed-font"><strong><font color="blue">Import the libraries needed</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-for-well-a1-font"><strong><font color="blue">For well A1</font></strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-red-read-the-data-from-the-file-and-select-well-a1-font"><strong><font color="red">Read the data from the file and select well A1</font></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-red-plot-fluorescence-y-versus-temperature-x-data-from-well-a1-font"><strong><font color="red">Plot “fluorescence (= <span class="math notranslate nohighlight">\(y\)</span>) versus temperature (= <span class="math notranslate nohighlight">\(x\)</span>)” data from well A1</font></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-red-analysis-1-first-derivative-method-font"><strong><font color="red">Analysis: 1. First derivative method</font></strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tip-how-to-make-a-plot-with-a-secondary-y-axis"><strong>Tip: How to make a plot with a secondary Y-axis?</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tip-how-to-smoothen-a-curve"><strong>Tip: How to smoothen a curve?</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-red-analysis-2-curve-fitting-using-a-boltzmann-model-font"><strong><font color="red">Analysis: 2. Curve-fitting using a Boltzmann model</font></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-red-analysis-3-curve-fitting-using-the-equation-describing-the-unfolding-of-a-monomer-via-a-two-state-mechanism-font"><strong><font color="red">Analysis: 3. Curve-fitting using the equation describing the unfolding of a monomer via a two-state mechanism</font></strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#advice-overfitting"><strong>Advice: Overfitting</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-and-now-for-each-well-font"><strong><font color="blue">And now for each well…</font></strong></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="thermal-shift-assay">
<h1>Thermal shift assay<a class="headerlink" href="#thermal-shift-assay" title="Permalink to this heading">#</a></h1>
<section id="font-color-blue-introduction-font">
<h2><strong><font color=blue>Introduction</font></strong><a class="headerlink" href="#font-color-blue-introduction-font" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>In a <strong>Thermal Shift Assay (TSA)</strong>, we use a protein-binding dye, such as SYPRO® Orange (Molecular Probes), and a real-time PCR system, such as the LightCycler® 480 Instrument II (Roche), to measure <strong>a protein melting curve</strong> (<em>i.e.</em> a fluorescence versus temperature plot). Basically, when the protein unfolds due to an increase in temperature, the dye binds to its exposed hydrophobic residues. This results in an increase in fluorescence. A typical result is shown below:</p>
<a class="reference internal image-reference" href="../_images/ThermalShiftAssayPrinciple.png"><img alt="Principle behind thermal shift assay" class="align-center" src="../_images/ThermalShiftAssayPrinciple.png" style="width: 600px;" /></a>
<p>These melting curves can be used to calculate <strong>the protein’s melting temperature, <em>i.e.</em> <span class="math notranslate nohighlight">\(T_m\)</span></strong>, for each test buffer. Changes in <span class="math notranslate nohighlight">\(T_m\)</span> are related to changes in protein stability.</p>
<p>This notebook shows you how to analyze protein melting curves generated by the LightCycler® 480 Instrument II using <em>Python</em>.</p>
</section>
<section id="font-color-blue-data-font">
<h2><strong><font color=blue>Data</font></strong><a class="headerlink" href="#font-color-blue-data-font" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>Get the data needed for this exercise <a class="reference external" href="https://github.com/renee-85/PythonForBIOC0029/tree/master/data">here</a>.</p>
<p>The data we will analyze are from an optimization run to determine the optimal protein and dye concentrations for the TSA.</p>
<ul class="simple">
<li><p><strong>Protein</strong>: T4 Lysozyme WT* (<em>i.e.</em> C54T/C97A)</p></li>
<li><p><strong>Protein storage buffer</strong>: 50 mM sodium phosphate, 2 mM ethylenediamine tetra-acetic acid, 350 mM NaCl, pH 6.5</p></li>
<li><p><strong>Dye</strong>: SYPRO® Orange (Thermo Scientific)</p></li>
<li><p><strong>Assay buffer</strong>: 1 x PBS (Lonza), pH 7.41</p></li>
<li><p><strong>Sample volume</strong>: 20 µl</p></li>
<li><p><strong>Protein concentration</strong>: 8, 4, 2, and 1 µM</p></li>
<li><p><strong>Dye concentration</strong>: 5, 6.67, 10 and 20 x</p></li>
<li><p><strong>Data acquisition</strong>:</p>
<ul>
<li><p>Excitation: 465nm</p></li>
<li><p>Emission: 580nm</p></li>
<li><p>Temperature: 20-85°C, in smooth ramp mode, rate of 0.06°C <span class="math notranslate nohighlight">\(s^{-1}\)</span></p></li>
</ul>
</li>
<li><p><strong>Plate</strong>: LightCycler® 480 multi-well plate 96, white (Roche) with sealing foil</p></li>
</ul>
<p>The  fluorescence measured at 580 nm after excitation at 465 nm as a function of temperature (from 20 to 85°C) is in A1 to D4. The figure below explains the 96-well plate lay-out:</p>
<a class="reference internal image-reference" href="../_images/ThermalShiftAssayPlate.png"><img alt="Plate set-up for the thermal shift assay" class="align-center" src="../_images/ThermalShiftAssayPlate.png" style="width: 600px;" /></a>
</section>
<section id="font-color-blue-import-the-libraries-needed-font">
<h2><strong><font color=blue>Import the libraries needed</font></strong><a class="headerlink" href="#font-color-blue-import-the-libraries-needed-font" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
<span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="kn">import</span> <span class="n">uniform_filter1d</span> <span class="c1"># to smoothen data, see the tip below</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">savgol_filter</span> <span class="c1"># to smoothen data, see the tip below</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="font-color-blue-for-well-a1-font">
<h2><strong><font color=blue>For well A1</font></strong><a class="headerlink" href="#font-color-blue-for-well-a1-font" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<section id="font-color-red-read-the-data-from-the-file-and-select-well-a1-font">
<h3><strong><font color=red>Read the data from the file and select well A1</font></strong><a class="headerlink" href="#font-color-red-read-the-data-from-the-file-and-select-well-a1-font" title="Permalink to this heading">#</a></h3>
<p>The data file contains a header with the experiment name, and 8 columns. We only read in columns 1, 2, 7 and 8, <em>i.e.</em> the sample position, the sample name, the temperature and the fluorescence signal. This is demonstrated in the figure below:</p>
<a class="reference internal image-reference" href="../_images/ThermalShiftAssayTxtFile.png"><img alt="Principle behind thermal shift assay" class="align-center" src="../_images/ThermalShiftAssayTxtFile.png" style="width: 600px;" /></a>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/ThermalShiftAssay.txt&#39;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="c1"># We use pd.read_csv to read in the file and store the information in a new dataframe, i.e. df.</span>
<span class="c1"># We use skiprows=1 to skip the first row.</span>
<span class="c1"># We use sep=&#39;\t&#39; to specify that we have a tab-delimited text format.</span>
<span class="c1"># We use usecols=[0, 1, 6, 7] to only read in columns 1, 2, 7, and 8.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      SamplePos  SampleName   Temp  465-580
0            A1  T4L wt 8uM  20.01     6.94
1            A1  T4L wt 8uM  20.01     6.99
2            A1  T4L wt 8uM  20.16     6.97
3            A1  T4L wt 8uM  20.32     7.00
4            A1  T4L wt 8uM  20.40     6.96
...         ...         ...    ...      ...
61915       H12       Empty  84.47     4.32
61916       H12       Empty  84.59     4.35
61917       H12       Empty  84.67     4.34
61918       H12       Empty  84.76     4.35
61919       H12       Empty  84.88     4.33

[61920 rows x 4 columns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfa1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SamplePos&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;A1&#39;</span><span class="p">]</span>
<span class="c1"># We select all rows that contain A1 as sample position and store them in a new dataframe, i.e. dfa1.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dfa1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    SamplePos  SampleName   Temp  465-580
0          A1  T4L wt 8uM  20.01     6.94
1          A1  T4L wt 8uM  20.01     6.99
2          A1  T4L wt 8uM  20.16     6.97
3          A1  T4L wt 8uM  20.32     7.00
4          A1  T4L wt 8uM  20.40     6.96
..        ...         ...    ...      ...
640        A1  T4L wt 8uM  84.47    78.21
641        A1  T4L wt 8uM  84.59    77.87
642        A1  T4L wt 8uM  84.67    77.57
643        A1  T4L wt 8uM  84.76    77.29
644        A1  T4L wt 8uM  84.88    76.92

[645 rows x 4 columns]
</pre></div>
</div>
</div>
</div>
</section>
<section id="font-color-red-plot-fluorescence-y-versus-temperature-x-data-from-well-a1-font">
<h3><strong><font color=red>Plot “fluorescence (= <span class="math notranslate nohighlight">\(y\)</span>) versus temperature (= <span class="math notranslate nohighlight">\(x\)</span>)” data from well A1</font></strong><a class="headerlink" href="#font-color-red-plot-fluorescence-y-versus-temperature-x-data-from-well-a1-font" title="Permalink to this heading">#</a></h3>
<p>We plot fluorescence versus temperature. We need to convert the temperature from °C to °K.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xdfa1</span><span class="o">=</span><span class="n">dfa1</span><span class="p">[</span><span class="s1">&#39;Temp&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">273.15</span>
<span class="c1"># We select the temperature = x and convert it from °C to °K, the result is stored in a new dataframe, i.e. xdfa1.</span>

<span class="n">ydfa1</span><span class="o">=</span><span class="n">dfa1</span><span class="p">[</span><span class="s1">&#39;465-580&#39;</span><span class="p">]</span>
<span class="c1"># We select the fluorescence signal = y, the result is stored in a new dataframe, i.e. ydfa1.</span>

<span class="c1"># We now plot the graph &quot;fluorescence signal&quot; versus &quot;temperature&quot;.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Thermal Shift Assay&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;T (°K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fluorescence (AU)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6c7bc8e3a7a43474647de222457b1ca69f8c430b426ac3e6a436e80274abaa54.png" src="../_images/6c7bc8e3a7a43474647de222457b1ca69f8c430b426ac3e6a436e80274abaa54.png" />
</div>
</div>
<p>We see the typical sigmoidal transition.</p>
<p>There are multiple ways to extract <span class="math notranslate nohighlight">\(T_m\)</span> (= the midpoint of the transition = the inflection point of the sigmoidal curve):</p>
<ul class="simple">
<li><p>The first derivative method</p></li>
<li><p>Curve-fitting methods. A sigmoidal function is used to fit the protein melting curve. Curve-fitting methods are known to be more robust and less sensitive to random noise than the first-derivative method. Multiple functions are used:</p>
<ul>
<li><p>A Boltzmann model</p></li>
<li><p>The equation describing the unfolding of a monomer via a two-state mechanism</p></li>
</ul>
</li>
</ul>
<p>The difference between both methods is demonstrated in the figure below:</p>
<a class="reference internal image-reference" href="../_images/ThermalShiftAssayAnalysis.png"><img alt="Analysing the thermal shift assay" class="align-center" src="../_images/ThermalShiftAssayAnalysis.png" style="width: 600px;" /></a>
</section>
<section id="font-color-red-analysis-1-first-derivative-method-font">
<h3><strong><font color=red>Analysis: 1. First derivative method</font></strong><a class="headerlink" href="#font-color-red-analysis-1-first-derivative-method-font" title="Permalink to this heading">#</a></h3>
<p>The first derivative of a function is the slope of the tangent line for any point on the function. It informs us when the function is increasing, decreasing, or constant.</p>
<p>A sigmoidal function has a bell-shaped first derivative. At the inflection point of the sigmoidal curve, the tangent has the steepest slope and the first derivative has its maximum.</p>
<p>The first-derivative method determines the midpoint of the transition (= the inflection point of the sigmoidal curve = <span class="math notranslate nohighlight">\(T_m\)</span>) by searching for the peak of the first-derivative curve.</p>
<p>In the following calculations, we work with Numpy arrays. To see why, try the following command and look at both outputs:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[293.16 293.16 293.31 293.47 293.55 293.69 293.84 293.92 294.08 294.08
 294.23 294.31 294.38 294.52 294.6  294.68 294.83 294.91 295.05 295.12
 295.19 295.34 295.41 295.49 295.56 295.7  295.84 295.91 295.98 296.05
 296.2  296.27 296.34 296.49 296.56 296.68 296.75 296.83 296.96 297.03
 297.18 297.24 297.31 297.44 297.51 297.58 297.71 297.78 297.92 298.05
 298.11 298.18 298.38 298.44 298.51 298.64 298.71 298.83 298.9  299.02
 299.16 299.22 299.35 299.48 299.55 299.6  299.79 299.92 299.98 300.1
 300.17 300.3  300.41 300.48 300.54 300.66 300.78 300.91 301.03 301.09
 301.2  301.32 301.45 301.51 301.63 301.68 301.8  301.92 302.03 302.1
 302.15 302.33 302.45 302.51 302.55 302.68 302.85 302.91 303.03 303.08
 303.2  303.36 303.47 303.59 303.59 303.7  303.81 303.92 304.02 304.14
 304.25 304.36 304.42 304.53 304.64 304.74 304.85 304.96 305.07 305.12
 305.28 305.39 305.45 305.54 305.65 305.76 305.87 305.92 306.02 306.13
 306.22 306.34 306.44 306.54 306.64 306.75 306.85 306.94 307.05 307.15
 307.25 307.36 307.46 307.56 307.62 307.71 307.85 307.96 308.06 308.16
 308.26 308.36 308.49 308.55 308.65 308.74 308.85 308.99 309.04 309.14
 309.23 309.32 309.47 309.56 309.66 309.76 309.85 309.98 310.08 310.17
 310.27 310.37 310.5  310.6  310.64 310.78 310.87 310.97 311.1  311.2
 311.29 311.37 311.47 311.6  311.69 311.79 311.88 311.96 312.06 312.14
 312.27 312.41 312.5  312.59 312.68 312.81 312.89 312.98 313.11 313.2
 313.29 313.37 313.47 313.59 313.67 313.81 313.89 313.98 314.11 314.2
 314.28 314.4  314.53 314.61 314.7  314.79 314.91 315.   315.12 315.2
 315.32 315.41 315.54 315.62 315.71 315.78 315.9  315.99 316.11 316.19
 316.32 316.4  316.48 316.64 316.72 316.84 316.92 317.   317.12 317.24
 317.32 317.44 317.51 317.64 317.76 317.83 317.92 318.03 318.14 318.23
 318.34 318.42 318.47 318.62 318.72 318.81 318.92 319.   319.16 319.23
 319.31 319.43 319.53 319.65 319.73 319.84 319.96 320.04 320.15 320.21
 320.33 320.44 320.52 320.67 320.74 320.83 320.93 321.04 321.15 321.26
 321.37 321.49 321.56 321.66 321.74 321.85 321.95 322.03 322.14 322.25
 322.37 322.46 322.57 322.64 322.75 322.87 322.97 323.04 323.15 323.25
 323.36 323.47 323.58 323.69 323.79 323.89 323.96 324.07 324.17 324.28
 324.35 324.49 324.57 324.66 324.77 324.87 324.98 325.08 325.19 325.26
 325.39 325.49 325.6  325.7  325.81 325.91 325.98 326.11 326.18 326.31
 326.39 326.49 326.59 326.7  326.79 326.92 327.02 327.13 327.19 327.33
 327.37 327.5  327.59 327.73 327.79 327.93 328.03 328.13 328.2  328.29
 328.39 328.49 328.59 328.72 328.79 328.92 329.02 329.11 329.21 329.31
 329.41 329.54 329.64 329.73 329.83 329.92 330.05 330.12 330.22 330.32
 330.41 330.51 330.6  330.73 330.83 330.93 331.02 331.12 331.22 331.3
 331.41 331.53 331.62 331.73 331.82 331.95 332.03 332.16 332.23 332.35
 332.42 332.54 332.64 332.73 332.85 332.95 333.05 333.14 333.23 333.32
 333.43 333.54 333.63 333.76 333.85 333.98 334.08 334.17 334.25 334.35
 334.44 334.56 334.66 334.75 334.87 334.96 335.06 335.18 335.24 335.34
 335.46 335.55 335.65 335.76 335.85 335.98 336.07 336.16 336.22 336.34
 336.45 336.55 336.67 336.76 336.86 336.98 337.04 337.16 337.25 337.36
 337.49 337.58 337.67 337.8  337.88 337.96 338.08 338.18 338.27 338.39
 338.45 338.57 338.68 338.78 338.89 338.98 339.08 339.2  339.28 339.4
 339.49 339.61 339.7  339.79 339.88 339.97 340.06 340.2  340.29 340.41
 340.5  340.59 340.68 340.8  340.88 341.   341.12 341.21 341.3  341.42
 341.51 341.59 341.7  341.8  341.92 342.   342.13 342.21 342.29 342.41
 342.53 342.62 342.71 342.83 342.91 343.03 343.11 343.23 343.32 343.44
 343.53 343.59 343.71 343.81 343.94 344.02 344.14 344.23 344.32 344.43
 344.49 344.6  344.75 344.84 344.93 345.07 345.14 345.24 345.33 345.42
 345.54 345.65 345.75 345.86 345.95 346.03 346.15 346.23 346.33 346.44
 346.53 346.65 346.72 346.84 346.96 347.05 347.16 347.23 347.37 347.45
 347.57 347.66 347.77 347.84 347.95 348.04 348.13 348.24 348.35 348.47
 348.56 348.67 348.77 348.88 348.96 349.05 349.17 349.28 349.4  349.46
 349.58 349.66 349.77 349.86 349.98 350.07 350.15 350.28 350.36 350.47
 350.59 350.68 350.76 350.86 350.97 351.1  351.17 351.29 351.4  351.5
 351.58 351.7  351.79 351.87 351.95 352.11 352.19 352.31 352.4  352.49
 352.57 352.66 352.8  352.93 353.01 353.13 353.22 353.31 353.42 353.51
 353.6  353.71 353.81 353.92 354.01 354.12 354.21 354.3  354.41 354.51
 354.6  354.71 354.8  354.91 355.03 355.1  355.21 355.3  355.4  355.51
 355.59 355.71 355.8  355.92 356.01 356.1  356.22 356.31 356.42 356.51
 356.63 356.72 356.81 356.94 357.01 357.13 357.2  357.32 357.43 357.53
 357.62 357.74 357.82 357.91 358.03]
0      293.16
1      293.16
2      293.31
3      293.47
4      293.55
        ...  
640    357.62
641    357.74
642    357.82
643    357.91
644    358.03
Name: Temp, Length: 645, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The essential difference is the presence of the index: while the Numpy array has an implicitly defined integer index used to access the values, the Pandas series has an explicitly defined index associated with the values.</p>
<p>To calculate the derivative of our fluorescence (= <span class="math notranslate nohighlight">\(y\)</span>) versus temperature (= <span class="math notranslate nohighlight">\(x\)</span>) data, we subtract two adjacent elements in <span class="math notranslate nohighlight">\(y\)</span>, and divide by the difference in the two corresponding elements in <span class="math notranslate nohighlight">\(x\)</span>. This is represented with the following formula:</p>
<div class="math notranslate nohighlight">
\[
\frac{dy}{dx} = \frac{y_2 - y_1}{x_2 - x_1} .
\]</div>
<p>Note that this <em>approximated derivative</em> has size <span class="math notranslate nohighlight">\(n-1\)</span> with <span class="math notranslate nohighlight">\(n\)</span> being our amount of data points.</p>
<p>We use the <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.diff.html">numpy.diff</a> and <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.divide.html">numpy.divide</a> functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outa1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ydfa1</span><span class="p">))</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<span class="n">derya1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ydfa1</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">)),</span> <span class="n">out</span><span class="o">=</span><span class="n">outa1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">))</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># The np.diff function calculates the n-th discrete difference. When n = 1 (default), np.diff calculates the difference between subsequent elements in our array, and returns an array that is one element shorter. </span>
<span class="c1"># The np.divide function returns a division of the inputs. To prevent division by zero, we can take advantage of the &quot;where&quot; option.</span>
<span class="c1"># We pre-initialize the output &#39;outa1&#39; that we will use when the &quot;divide by zero encountered&quot; error happens. The input of &#39;out=&#39; needs to be an array.</span>
<span class="c1"># To create the array &#39;outa1&#39;, we use the np.ones function which returns an array of given shape (i.e. n-1 data points, the &#39;len()&#39; function gives us n) and type, filled with ones.</span>

<span class="n">derxa1</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="mi">2</span>
<span class="c1"># The derivative is of size n-1, and is evaluated at the midpoints. The x data for the derivative can be calculated via (all but the last elements of x (represented by x[:-1]) + all but the first element of x (represented by x[1:])) / 2.</span>

<span class="c1"># We now plot the graph &quot;fluorescence signal&quot; versus &quot;temperature&quot; and add the calculated first derivative to it.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">derxa1</span><span class="p">,</span> <span class="n">derya1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Thermal Shift Assay&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;T (°K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fluorescence (AU)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/586a27c089b390dd25a8b719ba218afe82d536dfe6740a90a89054a54d9b6c59.png" src="../_images/586a27c089b390dd25a8b719ba218afe82d536dfe6740a90a89054a54d9b6c59.png" />
</div>
</div>
<p>Ok, but I want to <em>pimp my graph</em> by (1) using a secondary Y-axis and (2) smoothing the first derivative curve.</p>
<section id="tip-how-to-make-a-plot-with-a-secondary-y-axis">
<h4><strong>Tip: How to make a plot with a secondary Y-axis?</strong><a class="headerlink" href="#tip-how-to-make-a-plot-with-a-secondary-y-axis" title="Permalink to this heading">#</a></h4>
<p>A secondary Y-axis is a Y-axis drawn on the right-hand side of the graph. The primary Y-axis is on the left-hand side of the graph. You can use a secondary Y-axis with a different scale than the primary Y-axis to plot a series of data on a different scale. This lets you compare two series of data more easily on the same graph.</p>
<p>Use the <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html">matplotlib.pyplot.subplots</a> and the <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.twinx.html">matplotlib.axes.Axes.twinx</a> functions to create a secondary Y-axis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="c1"># create figure and axis objects with subplots()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="c1"># make a plot</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;T (°K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Fluorescence (AU)&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1"># set x- and y-axis labels</span>

<span class="n">ax2</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="c1"># instantiate a second axes that shares the same x-axis</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">derxa1</span><span class="p">,</span> <span class="n">derya1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="c1"># make a plot with different y-axis using second axis object</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;First derivative&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1"># set y-axis label for the second axis object</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f33f2d11f6c4d659627d330df1de5ead41fed18c157630d32f17f3ae10b6e504.png" src="../_images/f33f2d11f6c4d659627d330df1de5ead41fed18c157630d32f17f3ae10b6e504.png" />
</div>
</div>
</section>
<section id="tip-how-to-smoothen-a-curve">
<h4><strong>Tip: How to smoothen a curve?</strong><a class="headerlink" href="#tip-how-to-smoothen-a-curve" title="Permalink to this heading">#</a></h4>
<p>Smoothing is usually done to help us see patterns in data series. We smooth out the <em>roughness</em> to see a clearer signal. How? The data points are modified so that points higher than the adjacent points (presumably because of noise) are reduced, and points lower than the adjacent points (presumably because of noise) are increased.</p>
<p>You can smooth data several ways in <em>Python</em>. Have a look at the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.uniform_filter1d.html">scipy.ndimage.uniform_filter1d</a> function for a moving average filter and the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.savgol_filter.html">scipy.signal.savgol_filter</a> function for a Savitzky-Golay filter.</p>
<p>A <strong>moving average filter</strong> is the simplest filter to understand and use. It is commonly used to smooth out short-term fluctuations. For example, using a filer of length 3, the <em>new, smoothed</em> point <span class="math notranslate nohighlight">\(x\)</span> is the average of the <em>old</em> points <span class="math notranslate nohighlight">\(x-1\)</span>, <span class="math notranslate nohighlight">\(x\)</span>, and <span class="math notranslate nohighlight">\(x+1\)</span>.</p>
<p>A <strong>Savitzky-Golay filter</strong> uses least squares to regress a small window of the data onto a polynomial, then uses the polynomial to estimate the point in the center of the window. Finally the window is shifted forward by one data point and the process repeats. This continues until every point has been optimally adjusted relative to its neighbours.</p>
<p>The example below shows the difference between both methods:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xtestsmooth</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>
<span class="n">ytestsmooth</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xtestsmooth</span><span class="p">,</span> <span class="n">ytestsmooth</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xtestsmooth</span><span class="p">,</span> <span class="n">uniform_filter1d</span><span class="p">(</span><span class="n">ytestsmooth</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Moving average&#39;</span><span class="p">)</span> <span class="c1"># length of filter is 3</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xtestsmooth</span><span class="p">,</span> <span class="n">savgol_filter</span><span class="p">(</span><span class="n">ytestsmooth</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Savitzky-Golay&#39;</span><span class="p">)</span> <span class="c1"># window size is 5, polynomial order is 3</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Smoothing&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8bd39d70de210e9ff96dd79d3a8330b384c71f305a41702bc5b7eccfac2f2d94.png" src="../_images/8bd39d70de210e9ff96dd79d3a8330b384c71f305a41702bc5b7eccfac2f2d94.png" />
</div>
</div>
<p>A Saviztky-Golay filter is often better than a moving average filter because it tends to preserve features of the data which are usually attenuated by a moving average filter, <em>i.e.</em> area, position and width of peaks. A moving average filter can produce significant distortions and reduce the signal intensity, with the subsequent loss of adjacent small signals. Off course, all depends on the filter size, window size and polynomial order used.</p>
<p>Back to our data, now with a secondary Y-axis and a smooth first derivative:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;T (°K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Fluorescence (AU)&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">derxa1</span><span class="p">,</span> <span class="n">savgol_filter</span><span class="p">(</span><span class="n">derya1</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;First derivative&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fb5681d501619d2f7f80560956b323dad1c1ac6338e2f00497af20ba22666da6.png" src="../_images/fb5681d501619d2f7f80560956b323dad1c1ac6338e2f00497af20ba22666da6.png" />
</div>
</div>
<p>That looks much better!</p>
<p>We now need to find the y-value for the peak in the first derivative signal (<em>i.e.</em> the maximum value) and its corresponding x-value, which is the <span class="math notranslate nohighlight">\(T_m\)</span> we are looking for.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">max_derya1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">derya1</span><span class="p">)</span>
<span class="c1"># find the maximum y value</span>

<span class="n">max_derxa1</span> <span class="o">=</span> <span class="n">derxa1</span><span class="p">[</span><span class="n">derya1</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span> 
<span class="c1"># find the x value corresponding to the maximum y value</span>

<span class="nb">print</span><span class="p">(</span><span class="n">max_derxa1</span><span class="p">,</span> <span class="n">max_derya1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>334.21 36.62499999998117
</pre></div>
</div>
</div>
</div>
<p>The <span class="math notranslate nohighlight">\(T_m\)</span> is 334 °K.</p>
</section>
</section>
<section id="font-color-red-analysis-2-curve-fitting-using-a-boltzmann-model-font">
<h3><strong><font color=red>Analysis: 2. Curve-fitting using a Boltzmann model</font></strong><a class="headerlink" href="#font-color-red-analysis-2-curve-fitting-using-a-boltzmann-model-font" title="Permalink to this heading">#</a></h3>
<p>Using the Boltzmann equation:</p>
<div class="math notranslate nohighlight">
\[
Y = Y_{min} + \frac{(Y_{max} - Y_{min})}{1 + exp (\frac{T_m - T}{a})}
\]</div>
<p>where <span class="math notranslate nohighlight">\(Y\)</span> is the observed fluorescence intensity, <span class="math notranslate nohighlight">\(Y_{min}\)</span> and <span class="math notranslate nohighlight">\(Y_{max}\)</span> are pretransitional and posttransitional fluorescence intensities, and <span class="math notranslate nohighlight">\(a\)</span> is a slope factor. <span class="math notranslate nohighlight">\(T\)</span> is the temperature and <span class="math notranslate nohighlight">\(T_m\)</span> is the midpoint of the thermal unfolding curve.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We define the function to fit the data.</span>
<span class="k">def</span> <span class="nf">funcBoltzmann</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Ymin</span><span class="p">,</span> <span class="n">Ymax</span><span class="p">,</span> <span class="n">Tm</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">Ymin</span> <span class="o">+</span> <span class="p">((</span><span class="n">Ymax</span><span class="p">)</span> <span class="o">-</span> <span class="n">Ymin</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">Tm</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">a</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>We test input parameters for <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html">scipy.optimize.curve_fit</a> based on visual inspection (see figure below), this involves trial and error.</p>
<a class="reference internal image-reference" href="../_images/ThermalShiftAssayParametersBoltzmann.png"><img alt="Analysing the thermal shift assay" class="align-center" src="../_images/ThermalShiftAssayParametersBoltzmann.png" style="width: 600px;" /></a>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We plot our curve with initial guesses for the parameters onto the data. Change these guesses if needed.</span>
<span class="c1"># Note that we first create a list of temperatures as input for our function using the numpy.linspace command.</span>

<span class="n">xin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">290</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="n">funcBoltzmann</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">333</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Guess&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Thermal Shift Assay&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;T (°K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fluorescence (AU)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/75c3733cfe20313ddda20d8d4f40abc979d093f18ec7c82fb06798adf9ea6e06.png" src="../_images/75c3733cfe20313ddda20d8d4f40abc979d093f18ec7c82fb06798adf9ea6e06.png" />
</div>
</div>
<p>Looks ok. We can now run <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html">scipy.optimize.curve_fit</a> and plot the resulting curve on the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We fit the data.</span>
<span class="n">paramsBoltzmann</span><span class="p">,</span> <span class="n">params_covarianceBoltzmann</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">funcBoltzmann</span><span class="p">,</span> <span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span>
                                               <span class="p">[</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">333</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">maxfev</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="c1"># We print the fitted parameters.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">paramsBoltzmann</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covarianceBoltzmann</span><span class="p">)))</span>

<span class="c1"># We plot the fitted curve onto the data.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="n">funcBoltzmann</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="o">*</span><span class="n">paramsBoltzmann</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Thermal Shift Assay&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;T (°K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fluorescence (AU)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  8.46641251 117.38342176 332.50319245   0.96940869]
[0.72752489 0.92834356 0.10142863 0.08840673]
</pre></div>
</div>
<img alt="../_images/4fd298817d1848144c5201637bbb82efdf5bd4ccf833c4c53dbace5c0c988cdb.png" src="../_images/4fd298817d1848144c5201637bbb82efdf5bd4ccf833c4c53dbace5c0c988cdb.png" />
</div>
</div>
<p>This does not look good! The Boltzmann function does not take post-peak fluorescence into account, often observed in TSAs due to protein aggregation and dye dissociation at higher temperatures. We can include an empirical term to model fluorescence decrease with temperature after peak fluorescence:</p>
<div class="math notranslate nohighlight">
\[
Y = Y_{min} + \frac{(Y_{max} - b(T - T_m) - Y_{min})}{1 + exp (\frac{T_m - T}{a})}
\]</div>
<p>where <span class="math notranslate nohighlight">\(Y\)</span> is the observed fluorescence intensity, <span class="math notranslate nohighlight">\(Y_{min}\)</span> and <span class="math notranslate nohighlight">\(Y_{max}\)</span> are pretransitional and posttransitional fluorescence intensities, <span class="math notranslate nohighlight">\(a\)</span> is a slope factor for the transition, and <span class="math notranslate nohighlight">\(b\)</span> accounts for the decrease in <span class="math notranslate nohighlight">\(Y\)</span> after peak fluorescence. <span class="math notranslate nohighlight">\(T\)</span> is the temperature and <span class="math notranslate nohighlight">\(T_m\)</span> is the midpoint of the thermal unfolding curve.</p>
<p>As this is an empirical model, multiple options to include fluorescence decrease with temperature after peak fluorescence are possible!</p>
<p>Let’s see if this works:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We define the new function.</span>
<span class="k">def</span> <span class="nf">funcBoltzmannEmpirical</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Ymin</span><span class="p">,</span> <span class="n">Ymax</span><span class="p">,</span> <span class="n">Tm</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">Ymin</span> <span class="o">+</span> <span class="p">((</span><span class="n">Ymax</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">Tm</span><span class="p">)</span> <span class="o">-</span> <span class="n">Ymin</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">Tm</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">a</span><span class="p">)))</span>

<span class="c1"># We fit the data.</span>
<span class="n">paramsBoltzmannEmpirical</span><span class="p">,</span> <span class="n">params_covarianceBoltzmannEmpirical</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">funcBoltzmannEmpirical</span><span class="p">,</span> <span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span>
                                               <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">333</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">maxfev</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="c1"># We print the fitted parameters.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">paramsBoltzmannEmpirical</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covarianceBoltzmannEmpirical</span><span class="p">)))</span>

<span class="c1"># We plot the fitted curve onto the data.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="n">funcBoltzmannEmpirical</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="o">*</span><span class="n">paramsBoltzmannEmpirical</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Thermal Shift Assay&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;T (°K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fluorescence (AU)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  7.85990258 171.68481688 333.74524363   1.52565204   3.97356596]
[0.09701873 0.33837075 0.01447148 0.0111816  0.0236133 ]
</pre></div>
</div>
<img alt="../_images/184039ce196a6ce2511466912f4d4daa3bbc663c4397b239975f2c8f3af60bca.png" src="../_images/184039ce196a6ce2511466912f4d4daa3bbc663c4397b239975f2c8f3af60bca.png" />
</div>
</div>
<p>The <span class="math notranslate nohighlight">\(T_m\)</span> is 333.75 <span class="math notranslate nohighlight">\(\pm\)</span> 0.01 °K.</p>
</section>
<section id="font-color-red-analysis-3-curve-fitting-using-the-equation-describing-the-unfolding-of-a-monomer-via-a-two-state-mechanism-font">
<h3><strong><font color=red>Analysis: 3. Curve-fitting using the equation describing the unfolding of a monomer via a two-state mechanism</font></strong><a class="headerlink" href="#font-color-red-analysis-3-curve-fitting-using-the-equation-describing-the-unfolding-of-a-monomer-via-a-two-state-mechanism-font" title="Permalink to this heading">#</a></h3>
<p>Using the equation describing the unfolding of a monomer via a two-state mechanism:</p>
<div class="math notranslate nohighlight">
\[
Y = \frac{(Y_{n'} + m_n T) + (Y_{u'} + m_u T)  \exp (\frac{\Delta H_m (\frac{T}{T_m} - 1) + \Delta C_p (T_m - T + T ln (\frac{T}{T_m}))}{RT})}
{1 + \exp (\frac{\Delta H_m (\frac{T}{T_m} - 1) + \Delta C_p (T_m - T + T ln (\frac{T}{T_m}))}{RT})} .
\]</div>
<p>where <span class="math notranslate nohighlight">\(Y\)</span> is the observed fluorescence intensity, <span class="math notranslate nohighlight">\(m_n\)</span> and <span class="math notranslate nohighlight">\(m_u\)</span> account for changes in the signals of the pre- and post-transition regions with changes in temperature and <span class="math notranslate nohighlight">\(Y_{n'}\)</span> and <span class="math notranslate nohighlight">\(Y_{u'}\)</span> are the signal of the native and unfolded states. <span class="math notranslate nohighlight">\(T\)</span> is the temperature, <span class="math notranslate nohighlight">\(T_m\)</span> is the midpoint of the thermal unfolding curve, <span class="math notranslate nohighlight">\(\Delta H_m\)</span> is the enthalpy change for protein unfolding at <span class="math notranslate nohighlight">\(T_m\)</span> and <span class="math notranslate nohighlight">\(\Delta C_p\)</span> is the change in heat capacity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">funcUF</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">yn</span><span class="p">,</span> <span class="n">mn</span><span class="p">,</span> <span class="n">yu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">DHm</span><span class="p">,</span> <span class="n">Tm</span><span class="p">,</span> <span class="n">DCp</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="p">((</span><span class="n">yn</span> <span class="o">+</span> <span class="n">mn</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">yu</span> <span class="o">+</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">DHm</span> <span class="o">*</span> <span class="p">((</span><span class="n">x</span> <span class="o">/</span> <span class="n">Tm</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">DCp</span> <span class="o">*</span> <span class="p">(</span><span class="n">Tm</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">Tm</span><span class="p">)))</span> <span class="o">/</span> <span class="p">(</span><span class="mf">8.314</span> <span class="o">*</span> <span class="n">x</span><span class="p">)))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">DHm</span> <span class="o">*</span> <span class="p">((</span><span class="n">x</span> <span class="o">/</span> <span class="n">Tm</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">DCp</span> <span class="o">*</span> <span class="p">(</span><span class="n">Tm</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">Tm</span><span class="p">)))</span> <span class="o">/</span> <span class="p">(</span><span class="mf">8.314</span> <span class="o">*</span> <span class="n">x</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<p>First, test input parameters for <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html">scipy.optimize.curve_fit</a> based on visual inspection. I usually start with a <span class="math notranslate nohighlight">\(\Delta H_m\)</span>-value around 300 kJ mol<span class="math notranslate nohighlight">\(^{-1}\)</span> and a <span class="math notranslate nohighlight">\(\Delta C_p\)</span>-value around 10 kJ mol<span class="math notranslate nohighlight">\(^{−1}\)</span> K<span class="math notranslate nohighlight">\(^{-1}\)</span>. Finding good guesses involves trial and error, I included my final result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="n">funcUF</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">402000</span><span class="p">,</span> <span class="mi">330</span><span class="p">,</span> <span class="mi">6000</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Thermal Shift Assay&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;T (°K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fluorescence (AU)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bf413d79b83cb1ce45ab920f57bed75187b98ee428351079a9576b83ebb0d9e9.png" src="../_images/bf413d79b83cb1ce45ab920f57bed75187b98ee428351079a9576b83ebb0d9e9.png" />
</div>
</div>
<p>Second, run <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html">scipy.optimize.curve_fit</a> and plot the resulting curve on the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">paramsUF</span><span class="p">,</span> <span class="n">params_covarianceUF</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">funcUF</span><span class="p">,</span> <span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span>
                                               <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">402000</span><span class="p">,</span> <span class="mi">330</span><span class="p">,</span> <span class="mi">6000</span><span class="p">],</span> <span class="n">maxfev</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">paramsUF</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covarianceUF</span><span class="p">)))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="n">funcUF</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="o">*</span><span class="n">paramsUF</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Thermal Shift Assay&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;T (°K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fluorescence (AU)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-3.60741800e+01  1.40218168e-01  1.46004700e+03 -3.86614730e+00
  6.48921008e+05  3.33813581e+02  2.63591358e+04]
[2.16781537e+00 6.94593293e-03 4.86727186e+00 1.39736487e-02
 3.32159245e+03 9.06504468e-03 2.19021576e+02]
</pre></div>
</div>
<img alt="../_images/8d1ce15933bac366bc42582c86756e43b037609f0c1c461dd9446df7a650c23b.png" src="../_images/8d1ce15933bac366bc42582c86756e43b037609f0c1c461dd9446df7a650c23b.png" />
</div>
</div>
<p>From this fit, we can conclude that <span class="math notranslate nohighlight">\(\Delta H_m\)</span> is 649 <span class="math notranslate nohighlight">\(\pm\)</span> 3 kJ mol<span class="math notranslate nohighlight">\(^{-1}\)</span> K<span class="math notranslate nohighlight">\(^{-1}\)</span>, <span class="math notranslate nohighlight">\(\Delta C_p\)</span> 26.4 <span class="math notranslate nohighlight">\(\pm\)</span> 0.2 kJ mol<span class="math notranslate nohighlight">\(^{−1}\)</span> K<span class="math notranslate nohighlight">\(^{-1}\)</span> and that <span class="math notranslate nohighlight">\(T_m\)</span> is 333.81 <span class="math notranslate nohighlight">\(\pm\)</span> 0.01 K.</p>
<section id="advice-overfitting">
<h4><strong>Advice: Overfitting</strong><a class="headerlink" href="#advice-overfitting" title="Permalink to this heading">#</a></h4>
<p>Overfitting happens when the model is too complex for the data. In our case, can we justify the use of all parameters?</p>
<p>When the enthalpy and entropy are temperature independent, we can write:</p>
<div class="math notranslate nohighlight">
\[
Y = \frac{(Y_{n'} + m_n T) + (Y_{u'} + m_u T)  \exp(\frac{\Delta H_m}{R} (\frac{1}{T_m} - \frac{1}{T}))}
{1 + \exp(\frac{\Delta H_m}{R} (\frac{1}{T_m} - \frac{1}{T}))} ,
\]</div>
<p>Now we only have 6 variables… Let us see if that works:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">funcUFnoDCp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">yn</span><span class="p">,</span> <span class="n">mn</span><span class="p">,</span> <span class="n">yu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">DHm</span><span class="p">,</span> <span class="n">Tm</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="p">((</span><span class="n">yn</span> <span class="o">+</span> <span class="n">mn</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">yu</span> <span class="o">+</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">DHm</span> <span class="o">/</span> <span class="mf">8.314</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="n">Tm</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">x</span><span class="p">))))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">DHm</span> <span class="o">/</span> <span class="mf">8.314</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="n">Tm</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">x</span><span class="p">))))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">paramsUFnoDCp</span><span class="p">,</span> <span class="n">params_covarianceUFnoDCp</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">funcUFnoDCp</span><span class="p">,</span> <span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span>
                                               <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">402000</span><span class="p">,</span> <span class="mi">330</span><span class="p">],</span> <span class="n">maxfev</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">paramsUFnoDCp</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covarianceUFnoDCp</span><span class="p">)))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="n">funcUF</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="o">*</span><span class="n">paramsUF</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Change in heat capacity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="n">funcUFnoDCp</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="o">*</span><span class="n">paramsUFnoDCp</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Change in heat capacity = 0&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Unfolding&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;T (°K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\Delta$$A_</span><span class="si">{286nm}</span><span class="s1">$ (AU) x 100&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-3.87419869e+01  1.50303538e-01  1.48440857e+03 -3.93535895e+00
  6.41886743e+05  3.33812832e+02]
[2.47012998e+00 7.94675118e-03 6.88836674e+00 1.97610448e-02
 4.46184075e+03 1.24515726e-02]
</pre></div>
</div>
<img alt="../_images/7df068d184553be7abfbe7d8674f516e725b7836a1ea94ee723e54241318a025.png" src="../_images/7df068d184553be7abfbe7d8674f516e725b7836a1ea94ee723e54241318a025.png" />
</div>
</div>
<p>From this fit, we can conclude that <span class="math notranslate nohighlight">\(\Delta H_m\)</span> is 642 <span class="math notranslate nohighlight">\(\pm\)</span> 4 kJ mol<span class="math notranslate nohighlight">\(^{-1}\)</span> K<span class="math notranslate nohighlight">\(^{-1}\)</span> and that <span class="math notranslate nohighlight">\(T_m\)</span> is 333.81 <span class="math notranslate nohighlight">\(\pm\)</span> 0.01 K. Very similar to the previous fit…</p>
</section>
</section>
</section>
<section id="font-color-blue-and-now-for-each-well-font">
<h2><strong><font color=blue>And now for each well…</font></strong><a class="headerlink" href="#font-color-blue-and-now-for-each-well-font" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>Let’s have a look at all wells. We first group by SamplePos column and convert its result into a dictionary of DataFrames. More information on dictionaries and tuples in <em>Python</em> is available <a class="reference external" href="https://problemsolvingwithpython.com/04-Data-Types-and-Variables/04.05-Dictionaries-and-Tuples/">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dict_of_wells</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;SamplePos&quot;</span><span class="p">)))</span>
<span class="c1"># We group by SamplePos column and convert its result into a dictionary of DataFrames.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dict_of_wells</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;A1&#39;:     SamplePos  SampleName   Temp  465-580
0          A1  T4L wt 8uM  20.01     6.94
1          A1  T4L wt 8uM  20.01     6.99
2          A1  T4L wt 8uM  20.16     6.97
3          A1  T4L wt 8uM  20.32     7.00
4          A1  T4L wt 8uM  20.40     6.96
..        ...         ...    ...      ...
640        A1  T4L wt 8uM  84.47    78.21
641        A1  T4L wt 8uM  84.59    77.87
642        A1  T4L wt 8uM  84.67    77.57
643        A1  T4L wt 8uM  84.76    77.29
644        A1  T4L wt 8uM  84.88    76.92

[645 rows x 4 columns], &#39;A10&#39;:      SamplePos SampleName   Temp  465-580
5805       A10      Empty  20.01     5.22
5806       A10      Empty  20.01     5.23
5807       A10      Empty  20.16     5.20
5808       A10      Empty  20.32     5.19
5809       A10      Empty  20.40     5.20
...        ...        ...    ...      ...
6445       A10      Empty  84.47     3.11
6446       A10      Empty  84.59     3.13
6447       A10      Empty  84.67     3.12
6448       A10      Empty  84.76     3.09
6449       A10      Empty  84.88     3.11

[645 rows x 4 columns], &#39;A11&#39;:      SamplePos SampleName   Temp  465-580
6450       A11      Empty  20.01     6.95
6451       A11      Empty  20.01     6.93
6452       A11      Empty  20.16     6.91
6453       A11      Empty  20.32     6.91
6454       A11      Empty  20.40     6.88
...        ...        ...    ...      ...
7090       A11      Empty  84.47     4.02
7091       A11      Empty  84.59     4.02
7092       A11      Empty  84.67     4.03
7093       A11      Empty  84.76     4.04
7094       A11      Empty  84.88     4.01

[645 rows x 4 columns], &#39;A12&#39;:      SamplePos SampleName   Temp  465-580
7095       A12      Empty  20.01     7.11
7096       A12      Empty  20.01     7.06
7097       A12      Empty  20.16     7.08
7098       A12      Empty  20.32     7.09
7099       A12      Empty  20.40     7.05
...        ...        ...    ...      ...
7735       A12      Empty  84.47     4.14
7736       A12      Empty  84.59     4.11
7737       A12      Empty  84.67     4.10
7738       A12      Empty  84.76     4.11
7739       A12      Empty  84.88     4.11

[645 rows x 4 columns], &#39;A2&#39;:      SamplePos  SampleName   Temp  465-580
645         A2  T4L wt 8uM  20.01     7.15
646         A2  T4L wt 8uM  20.01     7.12
647         A2  T4L wt 8uM  20.16     7.15
648         A2  T4L wt 8uM  20.32     7.12
649         A2  T4L wt 8uM  20.40     7.16
...        ...         ...    ...      ...
1285        A2  T4L wt 8uM  84.47    73.00
1286        A2  T4L wt 8uM  84.59    72.65
1287        A2  T4L wt 8uM  84.67    72.36
1288        A2  T4L wt 8uM  84.76    72.08
1289        A2  T4L wt 8uM  84.88    71.80

[645 rows x 4 columns], &#39;A3&#39;:      SamplePos  SampleName   Temp  465-580
1290        A3  T4L wt 8uM  20.01     8.77
1291        A3  T4L wt 8uM  20.01     8.78
1292        A3  T4L wt 8uM  20.16     8.78
1293        A3  T4L wt 8uM  20.32     8.80
1294        A3  T4L wt 8uM  20.40     8.82
...        ...         ...    ...      ...
1930        A3  T4L wt 8uM  84.47    49.05
1931        A3  T4L wt 8uM  84.59    48.96
1932        A3  T4L wt 8uM  84.67    48.80
1933        A3  T4L wt 8uM  84.76    48.57
1934        A3  T4L wt 8uM  84.88    48.41

[645 rows x 4 columns], &#39;A4&#39;:      SamplePos  SampleName   Temp  465-580
1935        A4  T4L wt 8uM  20.01     7.77
1936        A4  T4L wt 8uM  20.01     7.80
1937        A4  T4L wt 8uM  20.16     7.76
1938        A4  T4L wt 8uM  20.32     7.83
1939        A4  T4L wt 8uM  20.40     7.82
...        ...         ...    ...      ...
2575        A4  T4L wt 8uM  84.47    24.66
2576        A4  T4L wt 8uM  84.59    24.58
2577        A4  T4L wt 8uM  84.67    24.51
2578        A4  T4L wt 8uM  84.76    24.47
2579        A4  T4L wt 8uM  84.88    24.36

[645 rows x 4 columns], &#39;A5&#39;:      SamplePos SampleName   Temp  465-580
2580        A5      Empty  20.01     7.61
2581        A5      Empty  20.01     7.59
2582        A5      Empty  20.16     7.55
2583        A5      Empty  20.32     7.59
2584        A5      Empty  20.40     7.55
...        ...        ...    ...      ...
3220        A5      Empty  84.47     4.32
3221        A5      Empty  84.59     4.35
3222        A5      Empty  84.67     4.34
3223        A5      Empty  84.76     4.35
3224        A5      Empty  84.88     4.33

[645 rows x 4 columns], &#39;A6&#39;:      SamplePos SampleName   Temp  465-580
3225        A6      Empty  20.01     7.61
3226        A6      Empty  20.01     7.59
3227        A6      Empty  20.16     7.55
3228        A6      Empty  20.32     7.59
3229        A6      Empty  20.40     7.55
...        ...        ...    ...      ...
3865        A6      Empty  84.47     4.32
3866        A6      Empty  84.59     4.35
3867        A6      Empty  84.67     4.34
3868        A6      Empty  84.76     4.35
3869        A6      Empty  84.88     4.33

[645 rows x 4 columns], &#39;A7&#39;:      SamplePos SampleName   Temp  465-580
3870        A7      Empty  20.01     7.61
3871        A7      Empty  20.01     7.59
3872        A7      Empty  20.16     7.55
3873        A7      Empty  20.32     7.59
3874        A7      Empty  20.40     7.55
...        ...        ...    ...      ...
4510        A7      Empty  84.47     4.32
4511        A7      Empty  84.59     4.35
4512        A7      Empty  84.67     4.34
4513        A7      Empty  84.76     4.35
4514        A7      Empty  84.88     4.33

[645 rows x 4 columns], &#39;A8&#39;:      SamplePos SampleName   Temp  465-580
4515        A8      Empty  20.01     7.61
4516        A8      Empty  20.01     7.59
4517        A8      Empty  20.16     7.55
4518        A8      Empty  20.32     7.59
4519        A8      Empty  20.40     7.55
...        ...        ...    ...      ...
5155        A8      Empty  84.47     4.32
5156        A8      Empty  84.59     4.35
5157        A8      Empty  84.67     4.34
5158        A8      Empty  84.76     4.35
5159        A8      Empty  84.88     4.33

[645 rows x 4 columns], &#39;A9&#39;:      SamplePos SampleName   Temp  465-580
5160        A9      Empty  20.01     6.45
5161        A9      Empty  20.01     6.44
5162        A9      Empty  20.16     6.41
5163        A9      Empty  20.32     6.39
5164        A9      Empty  20.40     6.41
...        ...        ...    ...      ...
5800        A9      Empty  84.47     3.73
5801        A9      Empty  84.59     3.74
5802        A9      Empty  84.67     3.75
5803        A9      Empty  84.76     3.75
5804        A9      Empty  84.88     3.72

[645 rows x 4 columns], &#39;B1&#39;:      SamplePos   SampleName   Temp  465-580
7740        B1  T4L wt 4 uM  20.01     5.48
7741        B1  T4L wt 4 uM  20.01     5.47
7742        B1  T4L wt 4 uM  20.16     5.46
7743        B1  T4L wt 4 uM  20.32     5.47
7744        B1  T4L wt 4 uM  20.40     5.48
...        ...          ...    ...      ...
8380        B1  T4L wt 4 uM  84.47    37.90
8381        B1  T4L wt 4 uM  84.59    37.86
8382        B1  T4L wt 4 uM  84.67    37.63
8383        B1  T4L wt 4 uM  84.76    37.48
8384        B1  T4L wt 4 uM  84.88    37.29

[645 rows x 4 columns], &#39;B10&#39;:       SamplePos SampleName   Temp  465-580
13545       B10      Empty  20.01     7.45
13546       B10      Empty  20.01     7.43
13547       B10      Empty  20.16     7.44
13548       B10      Empty  20.32     7.40
13549       B10      Empty  20.40     7.41
...         ...        ...    ...      ...
14185       B10      Empty  84.47     4.24
14186       B10      Empty  84.59     4.25
14187       B10      Empty  84.67     4.26
14188       B10      Empty  84.76     4.28
14189       B10      Empty  84.88     4.26

[645 rows x 4 columns], &#39;B11&#39;:       SamplePos SampleName   Temp  465-580
14190       B11      Empty  20.01     7.87
14191       B11      Empty  20.01     7.89
14192       B11      Empty  20.16     7.86
14193       B11      Empty  20.32     7.84
14194       B11      Empty  20.40     7.82
...         ...        ...    ...      ...
14830       B11      Empty  84.47     4.50
14831       B11      Empty  84.59     4.49
14832       B11      Empty  84.67     4.50
14833       B11      Empty  84.76     4.50
14834       B11      Empty  84.88     4.50

[645 rows x 4 columns], &#39;B12&#39;:       SamplePos SampleName   Temp  465-580
14835       B12      Empty  20.01     6.61
14836       B12      Empty  20.01     6.60
14837       B12      Empty  20.16     6.59
14838       B12      Empty  20.32     6.56
14839       B12      Empty  20.40     6.60
...         ...        ...    ...      ...
15475       B12      Empty  84.47     3.82
15476       B12      Empty  84.59     3.81
15477       B12      Empty  84.67     3.80
15478       B12      Empty  84.76     3.84
15479       B12      Empty  84.88     3.80

[645 rows x 4 columns], &#39;B2&#39;:      SamplePos   SampleName   Temp  465-580
8385        B2  T4L wt 4 uM  20.01     7.09
8386        B2  T4L wt 4 uM  20.01     7.09
8387        B2  T4L wt 4 uM  20.16     7.07
8388        B2  T4L wt 4 uM  20.32     7.10
8389        B2  T4L wt 4 uM  20.40     7.09
...        ...          ...    ...      ...
9025        B2  T4L wt 4 uM  84.47    35.78
9026        B2  T4L wt 4 uM  84.59    35.55
9027        B2  T4L wt 4 uM  84.67    35.58
9028        B2  T4L wt 4 uM  84.76    35.45
9029        B2  T4L wt 4 uM  84.88    35.30

[645 rows x 4 columns], &#39;B3&#39;:      SamplePos   SampleName   Temp  465-580
9030        B3  T4L wt 4 uM  20.01     7.55
9031        B3  T4L wt 4 uM  20.01     7.60
9032        B3  T4L wt 4 uM  20.16     7.61
9033        B3  T4L wt 4 uM  20.32     7.60
9034        B3  T4L wt 4 uM  20.40     7.60
...        ...          ...    ...      ...
9670        B3  T4L wt 4 uM  84.47    20.66
9671        B3  T4L wt 4 uM  84.59    20.57
9672        B3  T4L wt 4 uM  84.67    20.52
9673        B3  T4L wt 4 uM  84.76    20.52
9674        B3  T4L wt 4 uM  84.88    20.48

[645 rows x 4 columns], &#39;B4&#39;:       SamplePos   SampleName   Temp  465-580
9675         B4  T4L wt 4 uM  20.01     7.04
9676         B4  T4L wt 4 uM  20.01     7.05
9677         B4  T4L wt 4 uM  20.16     7.07
9678         B4  T4L wt 4 uM  20.32     7.04
9679         B4  T4L wt 4 uM  20.40     7.08
...         ...          ...    ...      ...
10315        B4  T4L wt 4 uM  84.47    11.98
10316        B4  T4L wt 4 uM  84.59    11.97
10317        B4  T4L wt 4 uM  84.67    11.96
10318        B4  T4L wt 4 uM  84.76    11.91
10319        B4  T4L wt 4 uM  84.88    11.86

[645 rows x 4 columns], &#39;B5&#39;:       SamplePos SampleName   Temp  465-580
10320        B5      Empty  20.01     7.61
10321        B5      Empty  20.01     7.59
10322        B5      Empty  20.16     7.55
10323        B5      Empty  20.32     7.59
10324        B5      Empty  20.40     7.55
...         ...        ...    ...      ...
10960        B5      Empty  84.47     4.32
10961        B5      Empty  84.59     4.35
10962        B5      Empty  84.67     4.34
10963        B5      Empty  84.76     4.35
10964        B5      Empty  84.88     4.33

[645 rows x 4 columns], &#39;B6&#39;:       SamplePos SampleName   Temp  465-580
10965        B6      Empty  20.01     7.61
10966        B6      Empty  20.01     7.59
10967        B6      Empty  20.16     7.55
10968        B6      Empty  20.32     7.59
10969        B6      Empty  20.40     7.55
...         ...        ...    ...      ...
11605        B6      Empty  84.47     4.32
11606        B6      Empty  84.59     4.35
11607        B6      Empty  84.67     4.34
11608        B6      Empty  84.76     4.35
11609        B6      Empty  84.88     4.33

[645 rows x 4 columns], &#39;B7&#39;:       SamplePos SampleName   Temp  465-580
11610        B7      Empty  20.01     7.61
11611        B7      Empty  20.01     7.59
11612        B7      Empty  20.16     7.55
11613        B7      Empty  20.32     7.59
11614        B7      Empty  20.40     7.55
...         ...        ...    ...      ...
12250        B7      Empty  84.47     4.32
12251        B7      Empty  84.59     4.35
12252        B7      Empty  84.67     4.34
12253        B7      Empty  84.76     4.35
12254        B7      Empty  84.88     4.33

[645 rows x 4 columns], &#39;B8&#39;:       SamplePos SampleName   Temp  465-580
12255        B8      Empty  20.01     7.61
12256        B8      Empty  20.01     7.59
12257        B8      Empty  20.16     7.55
12258        B8      Empty  20.32     7.59
12259        B8      Empty  20.40     7.55
...         ...        ...    ...      ...
12895        B8      Empty  84.47     4.32
12896        B8      Empty  84.59     4.35
12897        B8      Empty  84.67     4.34
12898        B8      Empty  84.76     4.35
12899        B8      Empty  84.88     4.33

[645 rows x 4 columns], &#39;B9&#39;:       SamplePos SampleName   Temp  465-580
12900        B9      Empty  20.01     6.97
12901        B9      Empty  20.01     6.95
12902        B9      Empty  20.16     6.95
12903        B9      Empty  20.32     6.96
12904        B9      Empty  20.40     6.94
...         ...        ...    ...      ...
13540        B9      Empty  84.47     4.01
13541        B9      Empty  84.59     4.01
13542        B9      Empty  84.67     4.04
13543        B9      Empty  84.76     4.01
13544        B9      Empty  84.88     3.99

[645 rows x 4 columns], &#39;C1&#39;:       SamplePos   SampleName   Temp  465-580
15480        C1  T4L wt 2 uM  20.01     4.71
15481        C1  T4L wt 2 uM  20.01     4.71
15482        C1  T4L wt 2 uM  20.16     4.70
15483        C1  T4L wt 2 uM  20.32     4.70
15484        C1  T4L wt 2 uM  20.40     4.72
...         ...          ...    ...      ...
16120        C1  T4L wt 2 uM  84.47    19.52
16121        C1  T4L wt 2 uM  84.59    19.46
16122        C1  T4L wt 2 uM  84.67    19.37
16123        C1  T4L wt 2 uM  84.76    19.31
16124        C1  T4L wt 2 uM  84.88    19.23

[645 rows x 4 columns], &#39;C10&#39;:       SamplePos SampleName   Temp  465-580
21285       C10      Empty  20.01     7.36
21286       C10      Empty  20.01     7.35
21287       C10      Empty  20.16     7.35
21288       C10      Empty  20.32     7.33
21289       C10      Empty  20.40     7.31
...         ...        ...    ...      ...
21925       C10      Empty  84.47     4.23
21926       C10      Empty  84.59     4.20
21927       C10      Empty  84.67     4.19
21928       C10      Empty  84.76     4.20
21929       C10      Empty  84.88     4.19

[645 rows x 4 columns], &#39;C11&#39;:       SamplePos SampleName   Temp  465-580
21930       C11      Empty  20.01     7.01
21931       C11      Empty  20.01     7.01
21932       C11      Empty  20.16     7.00
21933       C11      Empty  20.32     6.98
21934       C11      Empty  20.40     7.01
...         ...        ...    ...      ...
22570       C11      Empty  84.47     4.07
22571       C11      Empty  84.59     4.07
22572       C11      Empty  84.67     4.07
22573       C11      Empty  84.76     4.04
22574       C11      Empty  84.88     4.05

[645 rows x 4 columns], &#39;C12&#39;:       SamplePos SampleName   Temp  465-580
22575       C12      Empty  20.01     4.76
22576       C12      Empty  20.01     4.74
22577       C12      Empty  20.16     4.75
22578       C12      Empty  20.32     4.74
22579       C12      Empty  20.40     4.71
...         ...        ...    ...      ...
23215       C12      Empty  84.47     2.74
23216       C12      Empty  84.59     2.77
23217       C12      Empty  84.67     2.74
23218       C12      Empty  84.76     2.71
23219       C12      Empty  84.88     2.71

[645 rows x 4 columns], &#39;C2&#39;:       SamplePos   SampleName   Temp  465-580
16125        C2  T4L wt 2 uM  20.01     5.72
16126        C2  T4L wt 2 uM  20.01     5.70
16127        C2  T4L wt 2 uM  20.16     5.71
16128        C2  T4L wt 2 uM  20.32     5.70
16129        C2  T4L wt 2 uM  20.40     5.72
...         ...          ...    ...      ...
16765        C2  T4L wt 2 uM  84.47    17.49
16766        C2  T4L wt 2 uM  84.59    17.48
16767        C2  T4L wt 2 uM  84.67    17.38
16768        C2  T4L wt 2 uM  84.76    17.31
16769        C2  T4L wt 2 uM  84.88    17.27

[645 rows x 4 columns], &#39;C3&#39;:       SamplePos   SampleName   Temp  465-580
16770        C3  T4L wt 2 uM  20.01     6.25
16771        C3  T4L wt 2 uM  20.01     6.29
16772        C3  T4L wt 2 uM  20.16     6.32
16773        C3  T4L wt 2 uM  20.32     6.30
16774        C3  T4L wt 2 uM  20.40     6.33
...         ...          ...    ...      ...
17410        C3  T4L wt 2 uM  84.47    10.23
17411        C3  T4L wt 2 uM  84.59    10.23
17412        C3  T4L wt 2 uM  84.67    10.18
17413        C3  T4L wt 2 uM  84.76    10.17
17414        C3  T4L wt 2 uM  84.88    10.18

[645 rows x 4 columns], &#39;C4&#39;:       SamplePos   SampleName   Temp  465-580
17415        C4  T4L wt 2 uM  20.01     6.07
17416        C4  T4L wt 2 uM  20.01     6.09
17417        C4  T4L wt 2 uM  20.16     6.05
17418        C4  T4L wt 2 uM  20.32     6.07
17419        C4  T4L wt 2 uM  20.40     6.09
...         ...          ...    ...      ...
18055        C4  T4L wt 2 uM  84.47     7.37
18056        C4  T4L wt 2 uM  84.59     7.36
18057        C4  T4L wt 2 uM  84.67     7.34
18058        C4  T4L wt 2 uM  84.76     7.34
18059        C4  T4L wt 2 uM  84.88     7.32

[645 rows x 4 columns], &#39;C5&#39;:       SamplePos SampleName   Temp  465-580
18060        C5      Empty  20.01     7.61
18061        C5      Empty  20.01     7.59
18062        C5      Empty  20.16     7.55
18063        C5      Empty  20.32     7.59
18064        C5      Empty  20.40     7.55
...         ...        ...    ...      ...
18700        C5      Empty  84.47     4.32
18701        C5      Empty  84.59     4.35
18702        C5      Empty  84.67     4.34
18703        C5      Empty  84.76     4.35
18704        C5      Empty  84.88     4.33

[645 rows x 4 columns], &#39;C6&#39;:       SamplePos SampleName   Temp  465-580
18705        C6      Empty  20.01     7.61
18706        C6      Empty  20.01     7.59
18707        C6      Empty  20.16     7.55
18708        C6      Empty  20.32     7.59
18709        C6      Empty  20.40     7.55
...         ...        ...    ...      ...
19345        C6      Empty  84.47     4.32
19346        C6      Empty  84.59     4.35
19347        C6      Empty  84.67     4.34
19348        C6      Empty  84.76     4.35
19349        C6      Empty  84.88     4.33

[645 rows x 4 columns], &#39;C7&#39;:       SamplePos SampleName   Temp  465-580
19350        C7      Empty  20.01     7.61
19351        C7      Empty  20.01     7.59
19352        C7      Empty  20.16     7.55
19353        C7      Empty  20.32     7.59
19354        C7      Empty  20.40     7.55
...         ...        ...    ...      ...
19990        C7      Empty  84.47     4.32
19991        C7      Empty  84.59     4.35
19992        C7      Empty  84.67     4.34
19993        C7      Empty  84.76     4.35
19994        C7      Empty  84.88     4.33

[645 rows x 4 columns], &#39;C8&#39;:       SamplePos SampleName   Temp  465-580
19995        C8      Empty  20.01     7.61
19996        C8      Empty  20.01     7.59
19997        C8      Empty  20.16     7.55
19998        C8      Empty  20.32     7.59
19999        C8      Empty  20.40     7.55
...         ...        ...    ...      ...
20635        C8      Empty  84.47     4.32
20636        C8      Empty  84.59     4.35
20637        C8      Empty  84.67     4.34
20638        C8      Empty  84.76     4.35
20639        C8      Empty  84.88     4.33

[645 rows x 4 columns], &#39;C9&#39;:       SamplePos SampleName   Temp  465-580
20640        C9      Empty  20.01     7.19
20641        C9      Empty  20.01     7.14
20642        C9      Empty  20.16     7.16
20643        C9      Empty  20.32     7.12
20644        C9      Empty  20.40     7.12
...         ...        ...    ...      ...
21280        C9      Empty  84.47     4.12
21281        C9      Empty  84.59     4.12
21282        C9      Empty  84.67     4.12
21283        C9      Empty  84.76     4.10
21284        C9      Empty  84.88     4.09

[645 rows x 4 columns], &#39;D1&#39;:       SamplePos   SampleName   Temp  465-580
23220        D1  T4L wt 1 uM  20.01     4.53
23221        D1  T4L wt 1 uM  20.01     4.57
23222        D1  T4L wt 1 uM  20.16     4.55
23223        D1  T4L wt 1 uM  20.32     4.55
23224        D1  T4L wt 1 uM  20.40     4.57
...         ...          ...    ...      ...
23860        D1  T4L wt 1 uM  84.47    10.43
23861        D1  T4L wt 1 uM  84.59    10.41
23862        D1  T4L wt 1 uM  84.67    10.37
23863        D1  T4L wt 1 uM  84.76    10.32
23864        D1  T4L wt 1 uM  84.88    10.32

[645 rows x 4 columns], &#39;D10&#39;:       SamplePos SampleName   Temp  465-580
29025       D10      Empty  20.01     6.80
29026       D10      Empty  20.01     6.80
29027       D10      Empty  20.16     6.79
29028       D10      Empty  20.32     6.74
29029       D10      Empty  20.40     6.75
...         ...        ...    ...      ...
29665       D10      Empty  84.47     3.94
29666       D10      Empty  84.59     3.94
29667       D10      Empty  84.67     3.91
29668       D10      Empty  84.76     3.92
29669       D10      Empty  84.88     3.94

[645 rows x 4 columns], &#39;D11&#39;:       SamplePos SampleName   Temp  465-580
29670       D11      Empty  20.01     6.91
29671       D11      Empty  20.01     6.88
29672       D11      Empty  20.16     6.91
29673       D11      Empty  20.32     6.88
29674       D11      Empty  20.40     6.85
...         ...        ...    ...      ...
30310       D11      Empty  84.47     3.97
30311       D11      Empty  84.59     3.99
30312       D11      Empty  84.67     3.97
30313       D11      Empty  84.76     3.99
30314       D11      Empty  84.88     4.01

[645 rows x 4 columns], &#39;D12&#39;:       SamplePos SampleName   Temp  465-580
30315       D12      Empty  20.01     6.67
30316       D12      Empty  20.01     6.62
30317       D12      Empty  20.16     6.62
30318       D12      Empty  20.32     6.60
30319       D12      Empty  20.40     6.58
...         ...        ...    ...      ...
30955       D12      Empty  84.47     3.86
30956       D12      Empty  84.59     3.85
30957       D12      Empty  84.67     3.86
30958       D12      Empty  84.76     3.87
30959       D12      Empty  84.88     3.85

[645 rows x 4 columns], &#39;D2&#39;:       SamplePos   SampleName   Temp  465-580
23865        D2  T4L wt 1 uM  20.01     4.97
23866        D2  T4L wt 1 uM  20.01     4.99
23867        D2  T4L wt 1 uM  20.16     4.99
23868        D2  T4L wt 1 uM  20.32     4.96
23869        D2  T4L wt 1 uM  20.40     4.98
...         ...          ...    ...      ...
24505        D2  T4L wt 1 uM  84.47    11.06
24506        D2  T4L wt 1 uM  84.59    11.03
24507        D2  T4L wt 1 uM  84.67    10.96
24508        D2  T4L wt 1 uM  84.76    10.98
24509        D2  T4L wt 1 uM  84.88    10.93

[645 rows x 4 columns], &#39;D3&#39;:       SamplePos   SampleName   Temp  465-580
24510        D3  T4L wt 1 uM  20.01     5.14
24511        D3  T4L wt 1 uM  20.01     5.17
24512        D3  T4L wt 1 uM  20.16     5.22
24513        D3  T4L wt 1 uM  20.32     5.15
24514        D3  T4L wt 1 uM  20.40     5.16
...         ...          ...    ...      ...
25150        D3  T4L wt 1 uM  84.47     7.46
25151        D3  T4L wt 1 uM  84.59     7.43
25152        D3  T4L wt 1 uM  84.67     7.43
25153        D3  T4L wt 1 uM  84.76     7.42
25154        D3  T4L wt 1 uM  84.88     7.41

[645 rows x 4 columns], &#39;D4&#39;:       SamplePos   SampleName   Temp  465-580
25155        D4  T4L wt 1 uM  20.01     5.53
25156        D4  T4L wt 1 uM  20.01     5.54
25157        D4  T4L wt 1 uM  20.16     5.54
25158        D4  T4L wt 1 uM  20.32     5.54
25159        D4  T4L wt 1 uM  20.40     5.53
...         ...          ...    ...      ...
25795        D4  T4L wt 1 uM  84.47     4.93
25796        D4  T4L wt 1 uM  84.59     4.93
25797        D4  T4L wt 1 uM  84.67     4.95
25798        D4  T4L wt 1 uM  84.76     4.94
25799        D4  T4L wt 1 uM  84.88     4.94

[645 rows x 4 columns], &#39;D5&#39;:       SamplePos SampleName   Temp  465-580
25800        D5      Empty  20.01     7.61
25801        D5      Empty  20.01     7.59
25802        D5      Empty  20.16     7.55
25803        D5      Empty  20.32     7.59
25804        D5      Empty  20.40     7.55
...         ...        ...    ...      ...
26440        D5      Empty  84.47     4.32
26441        D5      Empty  84.59     4.35
26442        D5      Empty  84.67     4.34
26443        D5      Empty  84.76     4.35
26444        D5      Empty  84.88     4.33

[645 rows x 4 columns], &#39;D6&#39;:       SamplePos SampleName   Temp  465-580
26445        D6      Empty  20.01     7.61
26446        D6      Empty  20.01     7.59
26447        D6      Empty  20.16     7.55
26448        D6      Empty  20.32     7.59
26449        D6      Empty  20.40     7.55
...         ...        ...    ...      ...
27085        D6      Empty  84.47     4.32
27086        D6      Empty  84.59     4.35
27087        D6      Empty  84.67     4.34
27088        D6      Empty  84.76     4.35
27089        D6      Empty  84.88     4.33

[645 rows x 4 columns], &#39;D7&#39;:       SamplePos SampleName   Temp  465-580
27090        D7      Empty  20.01     7.61
27091        D7      Empty  20.01     7.59
27092        D7      Empty  20.16     7.55
27093        D7      Empty  20.32     7.59
27094        D7      Empty  20.40     7.55
...         ...        ...    ...      ...
27730        D7      Empty  84.47     4.32
27731        D7      Empty  84.59     4.35
27732        D7      Empty  84.67     4.34
27733        D7      Empty  84.76     4.35
27734        D7      Empty  84.88     4.33

[645 rows x 4 columns], &#39;D8&#39;:       SamplePos SampleName   Temp  465-580
27735        D8      Empty  20.01     7.61
27736        D8      Empty  20.01     7.59
27737        D8      Empty  20.16     7.55
27738        D8      Empty  20.32     7.59
27739        D8      Empty  20.40     7.55
...         ...        ...    ...      ...
28375        D8      Empty  84.47     4.32
28376        D8      Empty  84.59     4.35
28377        D8      Empty  84.67     4.34
28378        D8      Empty  84.76     4.35
28379        D8      Empty  84.88     4.33

[645 rows x 4 columns], &#39;D9&#39;:       SamplePos SampleName   Temp  465-580
28380        D9      Empty  20.01     7.51
28381        D9      Empty  20.01     7.49
28382        D9      Empty  20.16     7.51
28383        D9      Empty  20.32     7.49
28384        D9      Empty  20.40     7.45
...         ...        ...    ...      ...
29020        D9      Empty  84.47     4.32
29021        D9      Empty  84.59     4.30
29022        D9      Empty  84.67     4.30
29023        D9      Empty  84.76     4.32
29024        D9      Empty  84.88     4.31

[645 rows x 4 columns], &#39;E1&#39;:       SamplePos SampleName   Temp  465-580
30960        E1      Empty  20.01     6.56
30961        E1      Empty  20.01     6.53
30962        E1      Empty  20.16     6.56
30963        E1      Empty  20.32     6.56
30964        E1      Empty  20.40     6.48
...         ...        ...    ...      ...
31600        E1      Empty  84.47     3.79
31601        E1      Empty  84.59     3.79
31602        E1      Empty  84.67     3.79
31603        E1      Empty  84.76     3.80
31604        E1      Empty  84.88     3.77

[645 rows x 4 columns], &#39;E10&#39;:       SamplePos SampleName   Temp  465-580
36765       E10      Empty  20.01     7.19
36766       E10      Empty  20.01     7.20
36767       E10      Empty  20.16     7.20
36768       E10      Empty  20.32     7.15
36769       E10      Empty  20.40     7.15
...         ...        ...    ...      ...
37405       E10      Empty  84.47     4.16
37406       E10      Empty  84.59     4.16
37407       E10      Empty  84.67     4.16
37408       E10      Empty  84.76     4.18
37409       E10      Empty  84.88     4.15

[645 rows x 4 columns], &#39;E11&#39;:       SamplePos SampleName   Temp  465-580
37410       E11      Empty  20.01     7.18
37411       E11      Empty  20.01     7.13
37412       E11      Empty  20.16     7.12
37413       E11      Empty  20.32     7.11
37414       E11      Empty  20.40     7.12
...         ...        ...    ...      ...
38050       E11      Empty  84.47     4.12
38051       E11      Empty  84.59     4.13
38052       E11      Empty  84.67     4.14
38053       E11      Empty  84.76     4.12
38054       E11      Empty  84.88     4.09

[645 rows x 4 columns], &#39;E12&#39;:       SamplePos SampleName   Temp  465-580
38055       E12      Empty  20.01     6.73
38056       E12      Empty  20.01     6.75
38057       E12      Empty  20.16     6.75
38058       E12      Empty  20.32     6.72
38059       E12      Empty  20.40     6.68
...         ...        ...    ...      ...
38695       E12      Empty  84.47     3.90
38696       E12      Empty  84.59     3.91
38697       E12      Empty  84.67     3.91
38698       E12      Empty  84.76     3.91
38699       E12      Empty  84.88     3.89

[645 rows x 4 columns], &#39;E2&#39;:       SamplePos SampleName   Temp  465-580
31605        E2      Empty  20.01     6.79
31606        E2      Empty  20.01     6.79
31607        E2      Empty  20.16     6.77
31608        E2      Empty  20.32     6.77
31609        E2      Empty  20.40     6.77
...         ...        ...    ...      ...
32245        E2      Empty  84.47     3.91
32246        E2      Empty  84.59     3.93
32247        E2      Empty  84.67     3.93
32248        E2      Empty  84.76     3.95
32249        E2      Empty  84.88     3.92

[645 rows x 4 columns], &#39;E3&#39;:       SamplePos SampleName   Temp  465-580
32250        E3      Empty  20.01     7.01
32251        E3      Empty  20.01     6.98
32252        E3      Empty  20.16     6.96
32253        E3      Empty  20.32     6.95
32254        E3      Empty  20.40     6.94
...         ...        ...    ...      ...
32890        E3      Empty  84.47     4.02
32891        E3      Empty  84.59     4.02
32892        E3      Empty  84.67     4.03
32893        E3      Empty  84.76     4.02
32894        E3      Empty  84.88     4.03

[645 rows x 4 columns], &#39;E4&#39;:       SamplePos SampleName   Temp  465-580
32895        E4      Empty  20.01     7.12
32896        E4      Empty  20.01     7.09
32897        E4      Empty  20.16     7.05
32898        E4      Empty  20.32     7.06
32899        E4      Empty  20.40     7.04
...         ...        ...    ...      ...
33535        E4      Empty  84.47     4.08
33536        E4      Empty  84.59     4.05
33537        E4      Empty  84.67     4.08
33538        E4      Empty  84.76     4.09
33539        E4      Empty  84.88     4.05

[645 rows x 4 columns], &#39;E5&#39;:       SamplePos SampleName   Temp  465-580
33540        E5      Empty  20.01     7.24
33541        E5      Empty  20.01     7.22
33542        E5      Empty  20.16     7.20
33543        E5      Empty  20.32     7.21
33544        E5      Empty  20.40     7.18
...         ...        ...    ...      ...
34180        E5      Empty  84.47     4.13
34181        E5      Empty  84.59     4.14
34182        E5      Empty  84.67     4.16
34183        E5      Empty  84.76     4.15
34184        E5      Empty  84.88     4.12

[645 rows x 4 columns], &#39;E6&#39;:       SamplePos SampleName   Temp  465-580
34185        E6      Empty  20.01     7.07
34186        E6      Empty  20.01     7.06
34187        E6      Empty  20.16     7.06
34188        E6      Empty  20.32     7.03
34189        E6      Empty  20.40     7.00
...         ...        ...    ...      ...
34825        E6      Empty  84.47     4.03
34826        E6      Empty  84.59     4.07
34827        E6      Empty  84.67     4.06
34828        E6      Empty  84.76     4.05
34829        E6      Empty  84.88     4.02

[645 rows x 4 columns], &#39;E7&#39;:       SamplePos SampleName   Temp  465-580
34830        E7      Empty  20.01     7.17
34831        E7      Empty  20.01     7.14
34832        E7      Empty  20.16     7.09
34833        E7      Empty  20.32     7.07
34834        E7      Empty  20.40     7.06
...         ...        ...    ...      ...
35470        E7      Empty  84.47     4.09
35471        E7      Empty  84.59     4.08
35472        E7      Empty  84.67     4.09
35473        E7      Empty  84.76     4.07
35474        E7      Empty  84.88     4.06

[645 rows x 4 columns], &#39;E8&#39;:       SamplePos SampleName   Temp  465-580
35475        E8      Empty  20.01     7.38
35476        E8      Empty  20.01     7.35
35477        E8      Empty  20.16     7.37
35478        E8      Empty  20.32     7.36
35479        E8      Empty  20.40     7.34
...         ...        ...    ...      ...
36115        E8      Empty  84.47     4.22
36116        E8      Empty  84.59     4.22
36117        E8      Empty  84.67     4.24
36118        E8      Empty  84.76     4.24
36119        E8      Empty  84.88     4.21

[645 rows x 4 columns], &#39;E9&#39;:       SamplePos SampleName   Temp  465-580
36120        E9      Empty  20.01     7.26
36121        E9      Empty  20.01     7.23
36122        E9      Empty  20.16     7.24
36123        E9      Empty  20.32     7.19
36124        E9      Empty  20.40     7.18
...         ...        ...    ...      ...
36760        E9      Empty  84.47     4.17
36761        E9      Empty  84.59     4.18
36762        E9      Empty  84.67     4.16
36763        E9      Empty  84.76     4.17
36764        E9      Empty  84.88     4.15

[645 rows x 4 columns], &#39;F1&#39;:       SamplePos SampleName   Temp  465-580
38700        F1      Empty  20.01     6.68
38701        F1      Empty  20.01     6.67
38702        F1      Empty  20.16     6.66
38703        F1      Empty  20.32     6.66
38704        F1      Empty  20.40     6.64
...         ...        ...    ...      ...
39340        F1      Empty  84.47     3.81
39341        F1      Empty  84.59     3.84
39342        F1      Empty  84.67     3.81
39343        F1      Empty  84.76     3.83
39344        F1      Empty  84.88     3.80

[645 rows x 4 columns], &#39;F10&#39;:       SamplePos SampleName   Temp  465-580
44505       F10      Empty  20.01     8.51
44506       F10      Empty  20.01     8.46
44507       F10      Empty  20.16     8.47
44508       F10      Empty  20.32     8.45
44509       F10      Empty  20.40     8.45
...         ...        ...    ...      ...
45145       F10      Empty  84.47     4.79
45146       F10      Empty  84.59     4.81
45147       F10      Empty  84.67     4.79
45148       F10      Empty  84.76     4.77
45149       F10      Empty  84.88     4.77

[645 rows x 4 columns], &#39;F11&#39;:       SamplePos SampleName   Temp  465-580
45150       F11      Empty  20.01     7.14
45151       F11      Empty  20.01     7.10
45152       F11      Empty  20.16     7.11
45153       F11      Empty  20.32     7.10
45154       F11      Empty  20.40     7.11
...         ...        ...    ...      ...
45790       F11      Empty  84.47     4.10
45791       F11      Empty  84.59     4.13
45792       F11      Empty  84.67     4.11
45793       F11      Empty  84.76     4.12
45794       F11      Empty  84.88     4.11

[645 rows x 4 columns], &#39;F12&#39;:       SamplePos SampleName   Temp  465-580
45795       F12      Empty  20.01     6.92
45796       F12      Empty  20.01     6.87
45797       F12      Empty  20.16     6.87
45798       F12      Empty  20.32     6.89
45799       F12      Empty  20.40     6.84
...         ...        ...    ...      ...
46435       F12      Empty  84.47     3.97
46436       F12      Empty  84.59     4.01
46437       F12      Empty  84.67     3.95
46438       F12      Empty  84.76     4.00
46439       F12      Empty  84.88     3.99

[645 rows x 4 columns], &#39;F2&#39;:       SamplePos SampleName   Temp  465-580
39345        F2      Empty  20.01     7.08
39346        F2      Empty  20.01     7.04
39347        F2      Empty  20.16     7.08
39348        F2      Empty  20.32     7.05
39349        F2      Empty  20.40     7.05
...         ...        ...    ...      ...
39985        F2      Empty  84.47     4.02
39986        F2      Empty  84.59     4.03
39987        F2      Empty  84.67     4.03
39988        F2      Empty  84.76     4.04
39989        F2      Empty  84.88     4.04

[645 rows x 4 columns], &#39;F3&#39;:       SamplePos SampleName   Temp  465-580
39990        F3      Empty  20.01     7.67
39991        F3      Empty  20.01     7.69
39992        F3      Empty  20.16     7.67
39993        F3      Empty  20.32     7.66
39994        F3      Empty  20.40     7.64
...         ...        ...    ...      ...
40630        F3      Empty  84.47     4.34
40631        F3      Empty  84.59     4.32
40632        F3      Empty  84.67     4.35
40633        F3      Empty  84.76     4.37
40634        F3      Empty  84.88     4.35

[645 rows x 4 columns], &#39;F4&#39;:       SamplePos SampleName   Temp  465-580
40635        F4      Empty  20.01     7.32
40636        F4      Empty  20.01     7.33
40637        F4      Empty  20.16     7.30
40638        F4      Empty  20.32     7.29
40639        F4      Empty  20.40     7.27
...         ...        ...    ...      ...
41275        F4      Empty  84.47     4.17
41276        F4      Empty  84.59     4.20
41277        F4      Empty  84.67     4.18
41278        F4      Empty  84.76     4.21
41279        F4      Empty  84.88     4.16

[645 rows x 4 columns], &#39;F5&#39;:       SamplePos SampleName   Temp  465-580
41280        F5      Empty  20.01     7.22
41281        F5      Empty  20.01     7.22
41282        F5      Empty  20.16     7.20
41283        F5      Empty  20.32     7.21
41284        F5      Empty  20.40     7.19
...         ...        ...    ...      ...
41920        F5      Empty  84.47     4.12
41921        F5      Empty  84.59     4.14
41922        F5      Empty  84.67     4.13
41923        F5      Empty  84.76     4.13
41924        F5      Empty  84.88     4.13

[645 rows x 4 columns], &#39;F6&#39;:       SamplePos SampleName   Temp  465-580
41925        F6      Empty  20.01     8.07
41926        F6      Empty  20.01     8.08
41927        F6      Empty  20.16     8.04
41928        F6      Empty  20.32     8.03
41929        F6      Empty  20.40     8.04
...         ...        ...    ...      ...
42565        F6      Empty  84.47     4.53
42566        F6      Empty  84.59     4.53
42567        F6      Empty  84.67     4.53
42568        F6      Empty  84.76     4.56
42569        F6      Empty  84.88     4.56

[645 rows x 4 columns], &#39;F7&#39;:       SamplePos SampleName   Temp  465-580
42570        F7      Empty  20.01     8.21
42571        F7      Empty  20.01     8.16
42572        F7      Empty  20.16     8.17
42573        F7      Empty  20.32     8.15
42574        F7      Empty  20.40     8.12
...         ...        ...    ...      ...
43210        F7      Empty  84.47     4.61
43211        F7      Empty  84.59     4.62
43212        F7      Empty  84.67     4.61
43213        F7      Empty  84.76     4.64
43214        F7      Empty  84.88     4.59

[645 rows x 4 columns], &#39;F8&#39;:       SamplePos SampleName   Temp  465-580
43215        F8      Empty  20.01     7.34
43216        F8      Empty  20.01     7.30
43217        F8      Empty  20.16     7.32
43218        F8      Empty  20.32     7.32
43219        F8      Empty  20.40     7.30
...         ...        ...    ...      ...
43855        F8      Empty  84.47     4.20
43856        F8      Empty  84.59     4.25
43857        F8      Empty  84.67     4.21
43858        F8      Empty  84.76     4.21
43859        F8      Empty  84.88     4.20

[645 rows x 4 columns], &#39;F9&#39;:       SamplePos SampleName   Temp  465-580
43860        F9      Empty  20.01     7.08
43861        F9      Empty  20.01     7.11
43862        F9      Empty  20.16     7.06
43863        F9      Empty  20.32     7.06
43864        F9      Empty  20.40     7.08
...         ...        ...    ...      ...
44500        F9      Empty  84.47     4.05
44501        F9      Empty  84.59     4.08
44502        F9      Empty  84.67     4.04
44503        F9      Empty  84.76     4.05
44504        F9      Empty  84.88     4.03

[645 rows x 4 columns], &#39;G1&#39;:       SamplePos SampleName   Temp  465-580
46440        G1      Empty  20.01     6.72
46441        G1      Empty  20.01     6.67
46442        G1      Empty  20.16     6.69
46443        G1      Empty  20.32     6.66
46444        G1      Empty  20.40     6.63
...         ...        ...    ...      ...
47080        G1      Empty  84.47     3.83
47081        G1      Empty  84.59     3.81
47082        G1      Empty  84.67     3.82
47083        G1      Empty  84.76     3.81
47084        G1      Empty  84.88     3.82

[645 rows x 4 columns], &#39;G10&#39;:       SamplePos SampleName   Temp  465-580
52245       G10      Empty  20.01     7.85
52246       G10      Empty  20.01     7.85
52247       G10      Empty  20.16     7.78
52248       G10      Empty  20.32     7.79
52249       G10      Empty  20.40     7.77
...         ...        ...    ...      ...
52885       G10      Empty  84.47     4.49
52886       G10      Empty  84.59     4.47
52887       G10      Empty  84.67     4.46
52888       G10      Empty  84.76     4.45
52889       G10      Empty  84.88     4.43

[645 rows x 4 columns], &#39;G11&#39;:       SamplePos SampleName   Temp  465-580
52890       G11      Empty  20.01     7.99
52891       G11      Empty  20.01     7.98
52892       G11      Empty  20.16     7.95
52893       G11      Empty  20.32     7.97
52894       G11      Empty  20.40     7.98
...         ...        ...    ...      ...
53530       G11      Empty  84.47     4.61
53531       G11      Empty  84.59     4.59
53532       G11      Empty  84.67     4.59
53533       G11      Empty  84.76     4.60
53534       G11      Empty  84.88     4.57

[645 rows x 4 columns], &#39;G12&#39;:       SamplePos SampleName   Temp  465-580
53535       G12      Empty  20.01     6.92
53536       G12      Empty  20.01     6.92
53537       G12      Empty  20.16     6.86
53538       G12      Empty  20.32     6.87
53539       G12      Empty  20.40     6.85
...         ...        ...    ...      ...
54175       G12      Empty  84.47     4.04
54176       G12      Empty  84.59     4.02
54177       G12      Empty  84.67     4.00
54178       G12      Empty  84.76     4.00
54179       G12      Empty  84.88     4.01

[645 rows x 4 columns], &#39;G2&#39;:       SamplePos SampleName   Temp  465-580
47085        G2      Empty  20.01     7.21
47086        G2      Empty  20.01     7.17
47087        G2      Empty  20.16     7.17
47088        G2      Empty  20.32     7.14
47089        G2      Empty  20.40     7.14
...         ...        ...    ...      ...
47725        G2      Empty  84.47     4.07
47726        G2      Empty  84.59     4.10
47727        G2      Empty  84.67     4.12
47728        G2      Empty  84.76     4.10
47729        G2      Empty  84.88     4.09

[645 rows x 4 columns], &#39;G3&#39;:       SamplePos SampleName   Temp  465-580
47730        G3      Empty  20.01     7.34
47731        G3      Empty  20.01     7.32
47732        G3      Empty  20.16     7.31
47733        G3      Empty  20.32     7.29
47734        G3      Empty  20.40     7.28
...         ...        ...    ...      ...
48370        G3      Empty  84.47     4.19
48371        G3      Empty  84.59     4.18
48372        G3      Empty  84.67     4.18
48373        G3      Empty  84.76     4.17
48374        G3      Empty  84.88     4.19

[645 rows x 4 columns], &#39;G4&#39;:       SamplePos SampleName   Temp  465-580
48375        G4      Empty  20.01     6.96
48376        G4      Empty  20.01     6.97
48377        G4      Empty  20.16     6.99
48378        G4      Empty  20.32     6.98
48379        G4      Empty  20.40     6.92
...         ...        ...    ...      ...
49015        G4      Empty  84.47     3.98
49016        G4      Empty  84.59     3.99
49017        G4      Empty  84.67     3.99
49018        G4      Empty  84.76     3.99
49019        G4      Empty  84.88     3.99

[645 rows x 4 columns], &#39;G5&#39;:       SamplePos SampleName   Temp  465-580
49020        G5      Empty  20.01     7.50
49021        G5      Empty  20.01     7.47
49022        G5      Empty  20.16     7.49
49023        G5      Empty  20.32     7.49
49024        G5      Empty  20.40     7.47
...         ...        ...    ...      ...
49660        G5      Empty  84.47     4.31
49661        G5      Empty  84.59     4.32
49662        G5      Empty  84.67     4.31
49663        G5      Empty  84.76     4.29
49664        G5      Empty  84.88     4.31

[645 rows x 4 columns], &#39;G6&#39;:       SamplePos SampleName   Temp  465-580
49665        G6      Empty  20.01     7.44
49666        G6      Empty  20.01     7.45
49667        G6      Empty  20.16     7.44
49668        G6      Empty  20.32     7.42
49669        G6      Empty  20.40     7.41
...         ...        ...    ...      ...
50305        G6      Empty  84.47     4.27
50306        G6      Empty  84.59     4.28
50307        G6      Empty  84.67     4.27
50308        G6      Empty  84.76     4.26
50309        G6      Empty  84.88     4.28

[645 rows x 4 columns], &#39;G7&#39;:       SamplePos SampleName   Temp  465-580
50310        G7      Empty  20.01     7.65
50311        G7      Empty  20.01     7.64
50312        G7      Empty  20.16     7.63
50313        G7      Empty  20.32     7.61
50314        G7      Empty  20.40     7.59
...         ...        ...    ...      ...
50950        G7      Empty  84.47     4.35
50951        G7      Empty  84.59     4.37
50952        G7      Empty  84.67     4.36
50953        G7      Empty  84.76     4.34
50954        G7      Empty  84.88     4.36

[645 rows x 4 columns], &#39;G8&#39;:       SamplePos SampleName   Temp  465-580
50955        G8      Empty  20.01     7.64
50956        G8      Empty  20.01     7.62
50957        G8      Empty  20.16     7.61
50958        G8      Empty  20.32     7.61
50959        G8      Empty  20.40     7.60
...         ...        ...    ...      ...
51595        G8      Empty  84.47     4.39
51596        G8      Empty  84.59     4.40
51597        G8      Empty  84.67     4.39
51598        G8      Empty  84.76     4.38
51599        G8      Empty  84.88     4.36

[645 rows x 4 columns], &#39;G9&#39;:       SamplePos SampleName   Temp  465-580
51600        G9      Empty  20.01     7.41
51601        G9      Empty  20.01     7.43
51602        G9      Empty  20.16     7.41
51603        G9      Empty  20.32     7.37
51604        G9      Empty  20.40     7.38
...         ...        ...    ...      ...
52240        G9      Empty  84.47     4.27
52241        G9      Empty  84.59     4.25
52242        G9      Empty  84.67     4.26
52243        G9      Empty  84.76     4.23
52244        G9      Empty  84.88     4.25

[645 rows x 4 columns], &#39;H1&#39;:       SamplePos SampleName   Temp  465-580
54180        H1      Empty  20.01     7.14
54181        H1      Empty  20.01     7.08
54182        H1      Empty  20.16     7.06
54183        H1      Empty  20.32     7.03
54184        H1      Empty  20.40     7.07
...         ...        ...    ...      ...
54820        H1      Empty  84.47     4.04
54821        H1      Empty  84.59     4.03
54822        H1      Empty  84.67     4.07
54823        H1      Empty  84.76     4.02
54824        H1      Empty  84.88     4.04

[645 rows x 4 columns], &#39;H10&#39;:       SamplePos SampleName   Temp  465-580
59985       H10      Empty  20.01     7.59
59986       H10      Empty  20.01     7.62
59987       H10      Empty  20.16     7.56
59988       H10      Empty  20.32     7.52
59989       H10      Empty  20.40     7.58
...         ...        ...    ...      ...
60625       H10      Empty  84.47     4.36
60626       H10      Empty  84.59     4.40
60627       H10      Empty  84.67     4.37
60628       H10      Empty  84.76     4.37
60629       H10      Empty  84.88     4.36

[645 rows x 4 columns], &#39;H11&#39;:       SamplePos SampleName   Temp  465-580
60630       H11      Empty  20.01     7.46
60631       H11      Empty  20.01     7.45
60632       H11      Empty  20.16     7.39
60633       H11      Empty  20.32     7.39
60634       H11      Empty  20.40     7.39
...         ...        ...    ...      ...
61270       H11      Empty  84.47     4.29
61271       H11      Empty  84.59     4.33
61272       H11      Empty  84.67     4.29
61273       H11      Empty  84.76     4.29
61274       H11      Empty  84.88     4.28

[645 rows x 4 columns], &#39;H12&#39;:       SamplePos SampleName   Temp  465-580
61275       H12      Empty  20.01     7.61
61276       H12      Empty  20.01     7.59
61277       H12      Empty  20.16     7.55
61278       H12      Empty  20.32     7.59
61279       H12      Empty  20.40     7.55
...         ...        ...    ...      ...
61915       H12      Empty  84.47     4.32
61916       H12      Empty  84.59     4.35
61917       H12      Empty  84.67     4.34
61918       H12      Empty  84.76     4.35
61919       H12      Empty  84.88     4.33

[645 rows x 4 columns], &#39;H2&#39;:       SamplePos SampleName   Temp  465-580
54825        H2      Empty  20.01     7.01
54826        H2      Empty  20.01     7.02
54827        H2      Empty  20.16     6.97
54828        H2      Empty  20.32     6.97
54829        H2      Empty  20.40     6.96
...         ...        ...    ...      ...
55465        H2      Empty  84.47     4.01
55466        H2      Empty  84.59     4.01
55467        H2      Empty  84.67     4.02
55468        H2      Empty  84.76     3.99
55469        H2      Empty  84.88     3.99

[645 rows x 4 columns], &#39;H3&#39;:       SamplePos SampleName   Temp  465-580
55470        H3      Empty  20.01     7.24
55471        H3      Empty  20.01     7.25
55472        H3      Empty  20.16     7.22
55473        H3      Empty  20.32     7.20
55474        H3      Empty  20.40     7.18
...         ...        ...    ...      ...
56110        H3      Empty  84.47     4.12
56111        H3      Empty  84.59     4.12
56112        H3      Empty  84.67     4.12
56113        H3      Empty  84.76     4.12
56114        H3      Empty  84.88     4.11

[645 rows x 4 columns], &#39;H4&#39;:       SamplePos SampleName   Temp  465-580
56115        H4      Empty  20.01     7.27
56116        H4      Empty  20.01     7.25
56117        H4      Empty  20.16     7.20
56118        H4      Empty  20.32     7.23
56119        H4      Empty  20.40     7.24
...         ...        ...    ...      ...
56755        H4      Empty  84.47     4.14
56756        H4      Empty  84.59     4.17
56757        H4      Empty  84.67     4.11
56758        H4      Empty  84.76     4.12
56759        H4      Empty  84.88     4.12

[645 rows x 4 columns], &#39;H5&#39;:       SamplePos SampleName   Temp  465-580
56760        H5      Empty  20.01     6.72
56761        H5      Empty  20.01     6.72
56762        H5      Empty  20.16     6.69
56763        H5      Empty  20.32     6.70
56764        H5      Empty  20.40     6.69
...         ...        ...    ...      ...
57400        H5      Empty  84.47     3.83
57401        H5      Empty  84.59     3.83
57402        H5      Empty  84.67     3.84
57403        H5      Empty  84.76     3.84
57404        H5      Empty  84.88     3.82

[645 rows x 4 columns], &#39;H6&#39;:       SamplePos SampleName   Temp  465-580
57405        H6      Empty  20.01     6.96
57406        H6      Empty  20.01     6.98
57407        H6      Empty  20.16     6.94
57408        H6      Empty  20.32     6.93
57409        H6      Empty  20.40     6.90
...         ...        ...    ...      ...
58045        H6      Empty  84.47     3.97
58046        H6      Empty  84.59     4.00
58047        H6      Empty  84.67     3.95
58048        H6      Empty  84.76     3.99
58049        H6      Empty  84.88     3.95

[645 rows x 4 columns], &#39;H7&#39;:       SamplePos SampleName   Temp  465-580
58050        H7      Empty  20.01     7.49
58051        H7      Empty  20.01     7.45
58052        H7      Empty  20.16     7.40
58053        H7      Empty  20.32     7.41
58054        H7      Empty  20.40     7.40
...         ...        ...    ...      ...
58690        H7      Empty  84.47     4.24
58691        H7      Empty  84.59     4.27
58692        H7      Empty  84.67     4.24
58693        H7      Empty  84.76     4.22
58694        H7      Empty  84.88     4.23

[645 rows x 4 columns], &#39;H8&#39;:       SamplePos SampleName   Temp  465-580
58695        H8      Empty  20.01     6.75
58696        H8      Empty  20.01     6.75
58697        H8      Empty  20.16     6.74
58698        H8      Empty  20.32     6.68
58699        H8      Empty  20.40     6.73
...         ...        ...    ...      ...
59335        H8      Empty  84.47     3.90
59336        H8      Empty  84.59     3.89
59337        H8      Empty  84.67     3.90
59338        H8      Empty  84.76     3.89
59339        H8      Empty  84.88     3.89

[645 rows x 4 columns], &#39;H9&#39;:       SamplePos SampleName   Temp  465-580
59340        H9      Empty  20.01     7.15
59341        H9      Empty  20.01     7.13
59342        H9      Empty  20.16     7.12
59343        H9      Empty  20.32     7.12
59344        H9      Empty  20.40     7.08
...         ...        ...    ...      ...
59980        H9      Empty  84.47     4.11
59981        H9      Empty  84.59     4.13
59982        H9      Empty  84.67     4.10
59983        H9      Empty  84.76     4.08
59984        H9      Empty  84.88     4.14

[645 rows x 4 columns]}
</pre></div>
</div>
</div>
</div>
<p>We now plot the raw data for each well of the plate. We use the <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.gridspec.GridSpec.html#matplotlib.gridspec.GridSpec">matplotlib.gridspec.GridSpec</a> function to make a grid of plots. This takes a while.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WellsAll96</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span><span class="s1">&#39;A5&#39;</span><span class="p">,</span><span class="s1">&#39;A6&#39;</span><span class="p">,</span><span class="s1">&#39;A7&#39;</span><span class="p">,</span><span class="s1">&#39;A8&#39;</span><span class="p">,</span><span class="s1">&#39;A9&#39;</span><span class="p">,</span><span class="s1">&#39;A10&#39;</span><span class="p">,</span><span class="s1">&#39;A11&#39;</span><span class="p">,</span><span class="s1">&#39;A12&#39;</span><span class="p">,</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span><span class="s1">&#39;B6&#39;</span><span class="p">,</span><span class="s1">&#39;B7&#39;</span><span class="p">,</span><span class="s1">&#39;B8&#39;</span><span class="p">,</span><span class="s1">&#39;B9&#39;</span><span class="p">,</span><span class="s1">&#39;B10&#39;</span><span class="p">,</span><span class="s1">&#39;B11&#39;</span><span class="p">,</span><span class="s1">&#39;B12&#39;</span><span class="p">,</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span><span class="s1">&#39;C5&#39;</span><span class="p">,</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span><span class="s1">&#39;C7&#39;</span><span class="p">,</span><span class="s1">&#39;C8&#39;</span><span class="p">,</span><span class="s1">&#39;C9&#39;</span><span class="p">,</span><span class="s1">&#39;C10&#39;</span><span class="p">,</span><span class="s1">&#39;C11&#39;</span><span class="p">,</span><span class="s1">&#39;C12&#39;</span><span class="p">,</span><span class="s1">&#39;D1&#39;</span><span class="p">,</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span><span class="s1">&#39;D3&#39;</span><span class="p">,</span><span class="s1">&#39;D4&#39;</span><span class="p">,</span><span class="s1">&#39;D5&#39;</span><span class="p">,</span><span class="s1">&#39;D6&#39;</span><span class="p">,</span><span class="s1">&#39;D7&#39;</span><span class="p">,</span><span class="s1">&#39;D8&#39;</span><span class="p">,</span><span class="s1">&#39;D9&#39;</span><span class="p">,</span><span class="s1">&#39;D10&#39;</span><span class="p">,</span><span class="s1">&#39;D11&#39;</span><span class="p">,</span><span class="s1">&#39;D12&#39;</span><span class="p">,</span><span class="s1">&#39;E1&#39;</span><span class="p">,</span><span class="s1">&#39;E2&#39;</span><span class="p">,</span><span class="s1">&#39;E3&#39;</span><span class="p">,</span><span class="s1">&#39;E4&#39;</span><span class="p">,</span><span class="s1">&#39;E5&#39;</span><span class="p">,</span><span class="s1">&#39;E6&#39;</span><span class="p">,</span><span class="s1">&#39;E7&#39;</span><span class="p">,</span><span class="s1">&#39;E8&#39;</span><span class="p">,</span><span class="s1">&#39;E9&#39;</span><span class="p">,</span><span class="s1">&#39;E10&#39;</span><span class="p">,</span><span class="s1">&#39;E11&#39;</span><span class="p">,</span><span class="s1">&#39;E12&#39;</span><span class="p">,</span><span class="s1">&#39;F1&#39;</span><span class="p">,</span><span class="s1">&#39;F2&#39;</span><span class="p">,</span><span class="s1">&#39;F3&#39;</span><span class="p">,</span><span class="s1">&#39;F4&#39;</span><span class="p">,</span><span class="s1">&#39;F5&#39;</span><span class="p">,</span><span class="s1">&#39;F6&#39;</span><span class="p">,</span><span class="s1">&#39;F7&#39;</span><span class="p">,</span><span class="s1">&#39;F8&#39;</span><span class="p">,</span><span class="s1">&#39;F9&#39;</span><span class="p">,</span><span class="s1">&#39;F10&#39;</span><span class="p">,</span><span class="s1">&#39;F11&#39;</span><span class="p">,</span><span class="s1">&#39;F12&#39;</span><span class="p">,</span><span class="s1">&#39;G1&#39;</span><span class="p">,</span><span class="s1">&#39;G2&#39;</span><span class="p">,</span><span class="s1">&#39;G3&#39;</span><span class="p">,</span><span class="s1">&#39;G4&#39;</span><span class="p">,</span><span class="s1">&#39;G5&#39;</span><span class="p">,</span><span class="s1">&#39;G6&#39;</span><span class="p">,</span><span class="s1">&#39;G7&#39;</span><span class="p">,</span><span class="s1">&#39;G8&#39;</span><span class="p">,</span><span class="s1">&#39;G9&#39;</span><span class="p">,</span><span class="s1">&#39;G10&#39;</span><span class="p">,</span><span class="s1">&#39;G11&#39;</span><span class="p">,</span><span class="s1">&#39;G12&#39;</span><span class="p">,</span><span class="s1">&#39;H1&#39;</span><span class="p">,</span><span class="s1">&#39;H2&#39;</span><span class="p">,</span><span class="s1">&#39;H3&#39;</span><span class="p">,</span><span class="s1">&#39;H4&#39;</span><span class="p">,</span><span class="s1">&#39;H5&#39;</span><span class="p">,</span><span class="s1">&#39;H6&#39;</span><span class="p">,</span><span class="s1">&#39;H7&#39;</span><span class="p">,</span><span class="s1">&#39;H8&#39;</span><span class="p">,</span><span class="s1">&#39;H9&#39;</span><span class="p">,</span><span class="s1">&#39;H10&#39;</span><span class="p">,</span><span class="s1">&#39;H11&#39;</span><span class="p">,</span><span class="s1">&#39;H12&#39;</span><span class="p">]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># We create a figure object. If we don&#39;t use constrained_layout, then labels overlap the axes.</span>

<span class="n">gs1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="c1"># We use gridspec to create grid-shaped combinations of graphs. P.S. an alternative is to use subplots.</span>
<span class="c1"># The number of rows (in our case 8) and number of columns (in our case 12) of the grid need to be set.</span>

<span class="n">axs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">WellsAll96</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">97</span><span class="p">)):</span>
    <span class="n">axs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="n">num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]))</span>
    <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dict_of_wells</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Temp&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">,</span> <span class="n">dict_of_wells</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;465-580&#39;</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="c1"># We loop over all wells i using for. We have 96 wells, hence range(1,97).</span>
    <span class="c1"># We append each plot to the grid previously created. The title of each plot is the name of the well, e.g. A1, A2.</span>
   
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/981ec301ceb604eac59ded79f625cd65d62a1da85363090a67758257e381f0a0.png" src="../_images/981ec301ceb604eac59ded79f625cd65d62a1da85363090a67758257e381f0a0.png" />
</div>
</div>
<p>Let’s now fit all data corresponding to T4 Lysozyme WT* (<em>i.e.</em> A1 to D4, the other wells are empty) using the equation describing the unfolding of a monomer via a two-state mechanism but with temperature-independent enthalpy and entropy. We do first create an empty DataFrame with only column names, we will store the fitted melting temperatures in this DataFrame. We use the <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.concat.html">pandas.concat</a> function in the loop to add rows to it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfObj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SamplePos&#39;</span><span class="p">,</span> <span class="s1">&#39;Tm&#39;</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">])</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gs1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">axs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span><span class="s1">&#39;D1&#39;</span><span class="p">,</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span><span class="s1">&#39;D3&#39;</span><span class="p">,</span><span class="s1">&#39;D4&#39;</span><span class="p">],</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">17</span><span class="p">)):</span>
    
    <span class="n">x</span><span class="o">=</span><span class="n">dict_of_wells</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Temp&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">273.15</span> <span class="c1"># convert from °C to °K </span>
    <span class="n">y</span><span class="o">=</span><span class="n">dict_of_wells</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;465-580&#39;</span><span class="p">]</span>
    
    <span class="n">params</span><span class="p">,</span> <span class="n">params_covariance</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">funcUFnoDCp</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,[</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">402000</span><span class="p">,</span> <span class="mi">330</span><span class="p">],</span> <span class="n">maxfev</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span> <span class="c1"># initial guess for curve_fit - this might not be a good estimate for each condition!</span>
    
    <span class="n">dfAdd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;SamplePos&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;Tm&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="mi">5</span><span class="p">]],</span> <span class="s1">&#39;Error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covariance</span><span class="p">))[</span><span class="mi">5</span><span class="p">]]})</span>
    
    <span class="n">dfObj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">dfObj</span><span class="p">,</span> <span class="n">dfAdd</span><span class="p">),</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        
    <span class="n">axs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="n">num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]))</span>
    <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dict_of_wells</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Temp&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">,</span> <span class="n">dict_of_wells</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;465-580&#39;</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">funcUFnoDCp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dfObj</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/62787d69da24b8c8d174309e45332524dee6d715675d24f62e17b83f9e66685f.png" src="../_images/62787d69da24b8c8d174309e45332524dee6d715675d24f62e17b83f9e66685f.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  SamplePos          Tm     Error
0        A1  333.812832  0.012452
0        A2  333.365094  0.014226
0        A3  332.896370  0.021205
0        A4  331.564137  0.018647
0        B1  333.540712  0.021271
0        B2  333.053548  0.022692
0        B3  331.686003  0.015675
0        B4  329.483934  0.013724
0        C1  332.858759  0.024700
0        C2  332.166180  0.018651
0        C3  329.744508  0.014210
0        C4  327.951536  0.032072
0        D1  332.359852  0.021023
0        D2  331.910076  0.017261
0        D3  328.908492  0.023433
0        D4  326.209046  0.099373
</pre></div>
</div>
</div>
</div>
<p>We can see that wells C4, D3, and D4 - those wells with low amounts of protein and high amount of dye - do not give the expected, characteristic signal and, consequently, cannot be fitted nicely.</p>
<p>We can see that wells A4, B3, B4, C1, C2, C3, D1, and D2 do give the expected characteristic signal, but the overall fluorescence change is small (from 0 to &lt;50).</p>
<p>We can conclude that the experimental conditions in wells A1, A2, A3, B1, and B2 are suitable. However, based on the overall fluorescence change, I am more inclined to choose the conditions of A1.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./examples"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="RedoxPotential.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Redox potential</p>
      </div>
    </a>
    <a class="right-next"
       href="ChemicalUnfolding.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chemical unfolding</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-introduction-font"><strong><font color="blue">Introduction</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-data-font"><strong><font color="blue">Data</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-import-the-libraries-needed-font"><strong><font color="blue">Import the libraries needed</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-for-well-a1-font"><strong><font color="blue">For well A1</font></strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-red-read-the-data-from-the-file-and-select-well-a1-font"><strong><font color="red">Read the data from the file and select well A1</font></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-red-plot-fluorescence-y-versus-temperature-x-data-from-well-a1-font"><strong><font color="red">Plot “fluorescence (= <span class="math notranslate nohighlight">\(y\)</span>) versus temperature (= <span class="math notranslate nohighlight">\(x\)</span>)” data from well A1</font></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-red-analysis-1-first-derivative-method-font"><strong><font color="red">Analysis: 1. First derivative method</font></strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tip-how-to-make-a-plot-with-a-secondary-y-axis"><strong>Tip: How to make a plot with a secondary Y-axis?</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tip-how-to-smoothen-a-curve"><strong>Tip: How to smoothen a curve?</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-red-analysis-2-curve-fitting-using-a-boltzmann-model-font"><strong><font color="red">Analysis: 2. Curve-fitting using a Boltzmann model</font></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-red-analysis-3-curve-fitting-using-the-equation-describing-the-unfolding-of-a-monomer-via-a-two-state-mechanism-font"><strong><font color="red">Analysis: 3. Curve-fitting using the equation describing the unfolding of a monomer via a two-state mechanism</font></strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#advice-overfitting"><strong>Advice: Overfitting</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-and-now-for-each-well-font"><strong><font color="blue">And now for each well…</font></strong></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Renee Vancraenenbroeck, UCL
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>