

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Colorimetric assay &#8212; Python For BIOC0029</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/ColorimetricAssay';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Redox potential" href="RedoxPotential.html" />
    <link rel="prev" title="Dose response curve" href="DoseResponseCurve.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../WelcomeToPythonForBIOC0029.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../WelcomeToPythonForBIOC0029.html">
                    Welcome to Python for BIOC0029
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Running Python code</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapters/JupyterNotebooksGettingStarted.html">Jupyter Notebooks: Getting Started</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Python basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapters/VariablesDataTypesIndicesSlices.html">Variables, Data Types, Indices, and Slices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/ForLoopsLogicStatementsFunctions.html">For Loops, Logic Statements, and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/Libraries.html">Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/NumPyForArithmeticOperations.html">NumPy For Arithmetic Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/PandasForTabularData.html">Pandas For Working With Tabular Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/MatplotlibForPlotting.html">Matplotlib For Plotting And Data Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/SciPyForDataFitting.html">SciPy For Data Fitting</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DoseResponseCurve.html">Dose response curve</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Colorimetric assay</a></li>
<li class="toctree-l1"><a class="reference internal" href="RedoxPotential.html">Redox potential</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fexamples/ColorimetricAssay.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/examples/ColorimetricAssay.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Colorimetric assay</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-introduction-font"><strong><font color="blue">Introduction</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-data-font"><strong><font color="blue">Data</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-data-analysis-creating-the-standard-curve-font"><strong><font color="blue">Data analysis - creating the standard curve</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-data-analysis-using-the-standard-curve-font"><strong><font color="blue">Data analysis - using the standard curve</font></strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-concentration-for-each-of-the-dilution-factors"><em>Calculate the concentration for each of the dilution factors</em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#take-the-dilution-factors-into-account"><em>Take the dilution factors into account</em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-overal-concentration"><em>Calculate the overal concentration</em></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="colorimetric-assay">
<h1>Colorimetric assay<a class="headerlink" href="#colorimetric-assay" title="Permalink to this heading">#</a></h1>
<section id="font-color-blue-introduction-font">
<h2><strong><font color=blue>Introduction</font></strong><a class="headerlink" href="#font-color-blue-introduction-font" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p><strong>Colorimetric assays</strong> are based on a simple principle: add appropriate reagents to your protein samples to initiate a chemical reaction whose product is colored. The concentration of colored product, and its <strong>absorbance</strong>, is proportional to the initial protein concentration.</p>
<p>To calculate the protein concentration of an <strong>unknown sample</strong>, we use a standard curve that is generated from <strong>known protein standards</strong>.</p>
<p>When the relation between protein concentration of the known standards (X-axis) and their absorbance (Y-axis) is plotted, this produces a <strong>straight line</strong> or, in some cases, a <strong>parabola</strong>. They can be fit using</p>
<ul class="simple">
<li><p>a line equation</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
 Absorbance = a * x + b
\]</div>
<ul class="simple">
<li><p>a polynomial equation</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
 Absorbance = a * x^2 + b * x + c
\]</div>
<p>Where <span class="math notranslate nohighlight">\(Absorbance\)</span> is the measured signal, <span class="math notranslate nohighlight">\(x\)</span> is the protein concentration of the known standards, and <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> (and <span class="math notranslate nohighlight">\(c\)</span>) are model parameters.</p>
<p>See <a class="reference external" href="https://assets.thermofisher.com/TFS-Assets/LSG/Application-Notes/TR0057-Read-std-curves.pdf">here</a> for more information.</p>
</section>
<section id="font-color-blue-data-font">
<h2><strong><font color=blue>Data</font></strong><a class="headerlink" href="#font-color-blue-data-font" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>The spreadsheet “ColorimetricAssay.xlsx” contains the absorbances measured at 562 nm of the external standards and unknown protein samples on a plate reader. All samples were measured in duplicate at the same time.</p>
<p>The absorbances for the eight external standards (2000, 1500, 1000, 750, 500, 250, 125, 0 <span class="math notranslate nohighlight">\(\mu\)</span>g/mL) are in A5 to H6. The 0 <span class="math notranslate nohighlight">\(\mu\)</span>g/mL external standard is also known as the blank.
The absorbances for the unknown protein samples (dilution factor 2.5, 5, 10 and 20) are in A7 to D8.
E7 to H8 are empty wells.</p>
<a class="reference internal image-reference" href="../_images/DataColorimetricAssay.png"><img alt="Colorimetric assay data" class="align-center" src="../_images/DataColorimetricAssay.png" style="width: 600px;" /></a>
</section>
<section id="font-color-blue-data-analysis-creating-the-standard-curve-font">
<h2><strong><font color=blue>Data analysis - creating the standard curve</font></strong><a class="headerlink" href="#font-color-blue-data-analysis-creating-the-standard-curve-font" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<div class="exercise admonition" id="myexample2-exercise1">

<p class="admonition-title"><span class="caption-number">Exercise 46 </span></p>
<section id="exercise-content">
<p>Import the libraries needed. Use convenient naming.</p>
</section>
</div>
<div class="solution dropdown admonition" id="myexample2-solution1">

<p class="admonition-title">Solution to<a class="reference internal" href="#myexample2-exercise1"> Exercise 46</a></p>
<section id="solution-content">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Import the libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
</pre></div>
</div>
</section>
</div>
<div class="exercise admonition" id="myexample2-exercise2">

<p class="admonition-title"><span class="caption-number">Exercise 47 </span></p>
<section id="exercise-content">
<p>Read the data from the Excel file. Use only the columns and rows containing data, <em>i.e.</em> from A5 to H8. Name the columns BSA-1, BSA-2, Sample-1, and Sample-2. Store in a pandas DataFrame.</p>
</section>
</div>
<div class="solution dropdown admonition" id="myexample2-solution2">

<p class="admonition-title">Solution to<a class="reference internal" href="#myexample2-exercise2"> Exercise 47</a></p>
<section id="solution-content">
<p>Here’s one possible solution.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Read the Excel file</span>
<span class="n">dfCA</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span> <span class="p">(</span><span class="s1">&#39;../data/ColorimetricAssay.xlsx&#39;</span><span class="p">,</span>   <span class="c1">#create a pandas DataFrame from the filename with file path and extension shown</span>
                    <span class="n">sheet_name</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>   <span class="c1">#use the first sheet (no need to specifically include this as we use the default setting)</span>
                    <span class="n">skiprows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>   <span class="c1">#skip the first three rows</span>
                    <span class="n">skipfooter</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>   <span class="c1">#skip the last three rows </span>
                    <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span>   <span class="c1">#only import columns 6 to 9 - be aware that column numbers start with zero!</span>
                    <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>   <span class="c1">#our data does not have column names</span>
                    <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;BSA-1&#39;</span><span class="p">,</span><span class="s1">&#39;BSA-2&#39;</span><span class="p">,</span> <span class="s1">&#39;Sample-1&#39;</span><span class="p">,</span> <span class="s1">&#39;Sample-2&#39;</span><span class="p">])</span>   <span class="c1">#use BSA-1, BSA-2, Sample-1, and Sample-2 as column names</span>

<span class="nb">print</span> <span class="p">(</span><span class="n">dfCA</span><span class="p">)</span>   <span class="c1">#print the DataFrame created</span>
</pre></div>
</div>
</section>
</div>
<div class="exercise admonition" id="myexample2-exercise3">

<p class="admonition-title"><span class="caption-number">Exercise 48 </span></p>
<section id="exercise-content">
<p>Add a new column containing the concentrations of the eight standard points (<em>i.e.</em> 2000, 1500, 1000, 750, 500, 250, 125 and 0 <span class="math notranslate nohighlight">\(\mu\)</span>g/mL) to the existing DataFrame.</p>
</section>
</div>
<div class="solution dropdown admonition" id="myexample2-solution3">

<p class="admonition-title">Solution to<a class="reference internal" href="#myexample2-exercise3"> Exercise 48</a></p>
<section id="solution-content">
<p>Here’s one possible solution.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Insert a column containing the concentrations of the standards</span>
<span class="n">x1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>   <span class="c1">#create a list with integers containing the concentrations</span>

<span class="n">dfCA</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;[BSA]&#39;</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>   <span class="c1">#insert the column at index 0 (i.e. make it the first column) in dfCA, name the column [BSA], and fill it with the data provided by x1</span>

<span class="nb">print</span><span class="p">(</span><span class="n">dfCA</span><span class="p">)</span>   <span class="c1">#print the DataFrame created</span>
</pre></div>
</div>
</section>
</div>
<div class="exercise admonition" id="myexample2-exercise4">

<p class="admonition-title"><span class="caption-number">Exercise 49 </span></p>
<section id="exercise-content">
<p>Plot the data: <span class="math notranslate nohighlight">\([BSA]\)</span> in <span class="math notranslate nohighlight">\(\mu\)</span>g/mL versus absorbance in AU.</p>
<p><strong>Inspect the data!</strong></p>
<ul class="simple">
<li><p>Do we discern a clear trend in our data?</p>
<ul>
<li><p>Do the data show a positive (sloping upward), negative (sloping downward), or no (spread out) correlation?</p></li>
<li><p>Do we notice a linear or a non-linear relationship between x- and y-values?</p></li>
<li><p>Are the errors concentration dependent? Time dependent?</p></li>
</ul>
</li>
<li><p>Do we have outliers?</p>
<ul>
<li><p>Where the values entered correctly?</p></li>
<li><p>Where there any experimental errors? <em>E.g.</em> a calculation error that we picked up afterwards when looking at our lab notebook?</p></li>
<li><p>Are the data points a mistake? <em>E.g.</em> a pipetting error?</p></li>
</ul>
</li>
</ul>
<p>To deal with outliers for replicate data points at each value of x, we can use <strong>weighted linear regression</strong> (see AMC TB 27-2007, <em>Why are we weighting?</em>, available <a class="reference external" href="https://www.rsc.org/images/why-weighting-technical-brief-27_tcm18-214826.pdf">here</a> and further). Alternatively, when each concentration used to construct a calibration curve is measured at least three times, one can use <strong>statistical tests</strong> developed for identifying outliers amongst replicate values (see AMC TB 69-2015, <em>Using the Grubbs and Cochran tests to identify outliers</em>, available <a class="reference external" href="https://www.rsc.org/images/TB%2069_tcm18-247571.pdf">here</a>).</p>
</section>
</div>
<div class="solution dropdown admonition" id="myexample2-solution4">

<p class="admonition-title">Solution to<a class="reference internal" href="#myexample2-exercise4"> Exercise 49</a></p>
<section id="solution-content">
<p>Here’s one possible solution.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot the data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>   <span class="c1">#start a figure object</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;[BSA]&#39;</span><span class="p">],</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-1&#39;</span><span class="p">],</span>   <span class="c1">#plot a set of x (= the concentrations),y (= the measured absorbances) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>   <span class="c1">#use a round, gray marker with size 8</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;[BSA]&#39;</span><span class="p">],</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-2&#39;</span><span class="p">],</span>   <span class="c1">#plot another set of x (= the concentrations),y (= the measured absorbances) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>   <span class="c1">#use a round, black marker with size 8</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Standard Curve&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>   <span class="c1">#title of graph</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$[BSA]$ ($\mu$g $ml^{-1}$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#X-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Absorbance (AU)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#Y-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>   <span class="c1">#axis boundaries, in this case from -10 to 2200 for the X-axis and 0 to 1.5 for the Y-axis</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1">#show the figure object</span>
</pre></div>
</div>
<p>We see a trend - a positive correlation; maybe a straight line, maybe a parabola - between <span class="math notranslate nohighlight">\([BSA]\)</span> and absorbance. No data points are spotted as outliers. We also see a concentration-dependent error: the variation in replicates seems larger at high <span class="math notranslate nohighlight">\([BSA]\)</span>.</p>
</section>
</div>
<div class="exercise admonition" id="myexample2-exercise5">

<p class="admonition-title"><span class="caption-number">Exercise 50 </span></p>
<section id="exercise-content">
<p>Calculate the mean and the standard deviation for the duplicates, add them to the existing DataFrame.</p>
</section>
</div>
<div class="solution dropdown admonition" id="myexample2-solution5">

<p class="admonition-title">Solution to<a class="reference internal" href="#myexample2-exercise5"> Exercise 50</a></p>
<section id="solution-content">
<p>Here’s one possible solution.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate mean and stdev</span>
<span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCA</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>   <span class="c1">#we use axis 1 to get the mean of the elements of one row, we use columns 1 = BSA-1 and 2 = BSA-2, represented by [1:3]. The result is added to a new column.</span>
<span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCA</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>   <span class="c1">#we use axis 1 to get the standard deviation of the elements of one row, we use columns 1 = BSA-1 and 2 = BSA-2, represented by [1:3]. The result is added to a new column.</span>

<span class="nb">print</span><span class="p">(</span><span class="n">dfCA</span><span class="p">)</span>   <span class="c1">#print the DataFrame created</span>
</pre></div>
</div>
</section>
</div>
<div class="exercise admonition" id="myexample2-exercise6">

<p class="admonition-title"><span class="caption-number">Exercise 51 </span></p>
<section id="exercise-content">
<p>From the graph, it is unclear whether we have a line or a parabola. Define both functions that we can use to fit the data: a line and a quadratic curve.</p>
</section>
</div>
<div class="solution dropdown admonition" id="myexample2-solution6">

<p class="admonition-title">Solution to<a class="reference internal" href="#myexample2-exercise6"> Exercise 51</a></p>
<section id="solution-content">
<p>Here’s one possible solution.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Define a line</span>
<span class="k">def</span> <span class="nf">funcline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>   <span class="c1">#create the function</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a line using slope and intercept</span>

<span class="sd">    Args:</span>
<span class="sd">        the slope, a</span>
<span class="sd">        the intercept, b</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        the line function &quot;a * x + b&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span>
    
<span class="c1">#Define a quadratic curve</span>
<span class="k">def</span> <span class="nf">funcpoly2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>   <span class="c1">#create the function</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a quadratic curve using the first and second coefficients, a and b, and constant, c</span>

<span class="sd">    Args:</span>
<span class="sd">        the first coefficient, a</span>
<span class="sd">        the second coefficient, b</span>
<span class="sd">        the constant, c</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        the quadratic curve function &quot;a * x^2 + b * x + c&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">c</span>
</pre></div>
</div>
</section>
</div>
<div class="exercise admonition" id="myexample2-exercise7">

<p class="admonition-title"><span class="caption-number">Exercise 52 </span></p>
<section id="exercise-content">
<p>Fit the means using both functions. Use a weighted fit.</p>
</section>
</div>
<div class="solution dropdown admonition" id="myexample2-solution7">

<p class="admonition-title">Solution to<a class="reference internal" href="#myexample2-exercise7"> Exercise 52</a></p>
<section id="solution-content">
<p>Here’s one possible solution.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Fit with a line</span>
<span class="n">params1</span><span class="p">,</span> <span class="n">params_covariance1</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">funcline</span><span class="p">,</span>   <span class="c1">#the line function we try to fit to the data</span>
                                        <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;[BSA]&#39;</span><span class="p">],</span>   <span class="c1">#the x values, the concentrations</span>
                                        <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-mean&#39;</span><span class="p">],</span>   <span class="c1">#the y values, the measured absorbances</span>
                                        <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>   <span class="c1">#the starting parameters for a (=the slope) and b (=the intercept)</span>
                                        <span class="n">sigma</span><span class="o">=</span><span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-std&#39;</span><span class="p">],</span>   <span class="c1">#the standard deviations used for weighted fitting</span>
                                        <span class="n">absolute_sigma</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>   <span class="c1">#use sigma (=the standard deviations) in an absolute sense</span>

<span class="c1">#Fit with a quadratic curve</span>
<span class="n">params2</span><span class="p">,</span> <span class="n">params_covariance2</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">funcpoly2</span><span class="p">,</span>   <span class="c1">#the quadratic curve function we try to fit to the data</span>
                                        <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;[BSA]&#39;</span><span class="p">],</span>   <span class="c1">#the x values, the concentrations</span>
                                        <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-mean&#39;</span><span class="p">],</span>   <span class="c1">#the y values, the measured absorbances</span>
                                        <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>   <span class="c1">#the starting parameters for a (=the first coefficient), b (=the second coefficient), and c (=the constant)</span>
                                        <span class="n">sigma</span><span class="o">=</span><span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-std&#39;</span><span class="p">],</span>   <span class="c1">#the standard deviations used for weighted fitting</span>
                                        <span class="n">absolute_sigma</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>   <span class="c1">#use sigma (=the standard deviations) in an absolute sense</span>
</pre></div>
</div>
</section>
</div>
<div class="exercise admonition" id="myexample2-exercise8">

<p class="admonition-title"><span class="caption-number">Exercise 53 </span></p>
<section id="exercise-content">
<p>Report the fit parameters and standard errors on the fit parameters for both functions.</p>
</section>
</div>
<div class="solution dropdown admonition" id="myexample2-solution8">

<p class="admonition-title">Solution to<a class="reference internal" href="#myexample2-exercise8"> Exercise 53</a></p>
<section id="solution-content">
<p>Here’s one possible solution.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Report the fit parameters with standard errors for the line function</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Slope, a = &quot;</span><span class="p">,</span> <span class="n">params1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covariance1</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Intercept, b = &quot;</span><span class="p">,</span> <span class="n">params1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covariance1</span><span class="p">))[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1">#Report the fit parameters with standard errors for the quadratic function</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First coefficient, a =&quot;</span><span class="p">,</span> <span class="n">params2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covariance2</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Second coefficient, b = &quot;</span><span class="p">,</span> <span class="n">params2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covariance2</span><span class="p">))[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Constant, c = &quot;</span><span class="p">,</span> <span class="n">params2</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covariance2</span><span class="p">))[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</section>
</div>
<div class="exercise admonition" id="myexample2-exercise9">

<p class="admonition-title"><span class="caption-number">Exercise 54 </span></p>
<section id="exercise-content">
<p>Calculate the residuals.</p>
</section>
</div>
<div class="solution dropdown admonition" id="myexample2-solution9">

<p class="admonition-title">Solution to<a class="reference internal" href="#myexample2-exercise9"> Exercise 54</a></p>
<section id="solution-content">
<p>Here’s one possible solution.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate the residuals for the line function</span>
<span class="n">resid1</span> <span class="o">=</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-mean&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">funcline</span><span class="p">(</span><span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;[BSA]&#39;</span><span class="p">],</span> <span class="o">*</span><span class="n">params1</span><span class="p">)</span>   <span class="c1">#calculate the residuals, the star in _*params1_ unpacks the array so the two optimized parameter values become the second and third arguments (after the x-values) to the function</span>

<span class="c1">#Calculate the residuals for the quadratic function</span>
<span class="n">resid2</span> <span class="o">=</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-mean&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">funcpoly2</span><span class="p">(</span><span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;[BSA]&#39;</span><span class="p">],</span> <span class="o">*</span><span class="n">params2</span><span class="p">)</span>   <span class="c1">#calculate the residuals, the star in _*params2_ unpacks the array so the two optimized parameter values become the second, third, and fourth arguments (after the x-values) to the function</span>
</pre></div>
</div>
</section>
</div>
<div class="exercise admonition" id="myexample2-exercise10">

<p class="admonition-title"><span class="caption-number">Exercise 55 </span></p>
<section id="exercise-content">
<p>Produce a combined figure showing the residuals plots underneath the main plot with data with errorbars and both fitted curves. Make sure they are aligned and have the same X-axis so we can see which residual corresponds to which data point.</p>
<p>Tip: Instead of using the <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html">matplotlib.pyplot.plot</a> function, use the <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.errorbar.html">matplotlib.pyplot.errorbar</a> function to create a graph with error bars to visualize the variability of the data.</p>
<p><strong>Inspect the quality of both fits! Which one is the best model?</strong></p>
<ul class="simple">
<li><p>Look at the graph of the experimental data and the fitted curve  Do the experimental data and model match?</p></li>
<li><p>Look at the graph of the residuals. Are they around 0? Are they random or is there a trend? If the residuals display a systematic pattern, the model fits the data poorly.</p></li>
<li><p>Look at the fit parameters and the standard errors on the fit parameters. Are the fit parameters within (biological) reason? Are the standard errors on the fit parameters small? If a standard error on a fit parameter is bigger than the fit parameter, it is possible that there are not enough data points or that the model fits the data poorly.</p></li>
<li><p>Look at the goodness of fit statistics. But be careful! For example, R-square, ranging from 0 (worst possible fit) to 1 (best possible fit), compares the fit of your model to the fit of a horizontal line through the mean of all Y values, which is valid for linear regression, but not for non-linear regression. For those reasons, these fit statistics are not readily available as output of the SciPy curve_fit() function…</p></li>
</ul>
</section>
</div>
<div class="solution dropdown admonition" id="myexample2-solution10">

<p class="admonition-title">Solution to<a class="reference internal" href="#myexample2-exercise10"> Exercise 55</a></p>
<section id="solution-content">
<p>Here’s one possible solution.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Generate X-values to calculate the function</span>
<span class="n">xvalues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2200</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>   <span class="c1">#create an array with 100 evenly distributed elements between 0 (included) and 2200 (included)</span>

<span class="c1">#Produce a combined graph</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>   <span class="c1">#to create a figure object</span>

<span class="n">xlimits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2200</span><span class="p">]</span>   <span class="c1">#to make sure we use the same of the X-axis boundaries for both plots</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.81</span><span class="p">])</span>   <span class="c1">#to specify the coordinates, width and height of the top plot</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>   <span class="c1">#to specify the coordinates, width and height of the bottom plot</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;[BSA]&#39;</span><span class="p">],</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-mean&#39;</span><span class="p">],</span>   <span class="c1">#plot a set of x (= the concentrations),y (= the mean absorbances) data points</span>
             <span class="n">yerr</span><span class="o">=</span><span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-std&#39;</span><span class="p">],</span>   <span class="c1">#use an error bar (= the standard deviations)</span>
             <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="c1">#use a round, black marker with size 8</span>
             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvalues</span><span class="p">,</span> <span class="n">funcline</span><span class="p">(</span><span class="n">xvalues</span><span class="p">,</span> <span class="o">*</span><span class="n">params1</span><span class="p">),</span>   <span class="c1">#add the fitted line to plot. Use the generated BSA concentrations as x-values. Use the fitted parameters to calculate the y-values. The star in _*params1_ unpacks the array so the two optimized parameter values become the second and third arguments (after the x-values) to the function.</span>
         <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>   <span class="c1">#use a gray line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit $y=ax+b$&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvalues</span><span class="p">,</span> <span class="n">funcpoly2</span><span class="p">(</span><span class="n">xvalues</span><span class="p">,</span> <span class="o">*</span><span class="n">params2</span><span class="p">),</span>   <span class="c1">#add the fitted quadratic curve to plot. Use the generated BSA concentrations as x-values. Use the fitted parameters to calculate the y-values. The star in _*params2_ unpacks the array so the two optimized parameter values become the second, third, and fourth arguments (after the x-values) to the function.</span>
         <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>   <span class="c1">#use a red line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit $y=ax^2+bx$+c&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">xlimits</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>   <span class="c1">#sets the X-axis and Y-axis boundaries for the top plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>   <span class="c1">#removes the ticks and tick labels on the X-axis for the top plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Absorbance (AU)&#39;</span><span class="p">)</span>   <span class="c1">#adds Y-axis title for the top plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>   <span class="c1">#include legend</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;[BSA]&#39;</span><span class="p">],</span> <span class="n">resid1</span><span class="p">,</span>   <span class="c1">#plot a set of x (= the concentrations),y (= the residuals for y=ax+b) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>   <span class="c1">#use gray datapoints size 8 and a line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Residuals $y=ax+b$&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;[BSA]&#39;</span><span class="p">],</span> <span class="n">resid2</span><span class="p">,</span>   <span class="c1">#plot a set of x (= the concentrations),y (= the residuals for y=ax^2+bx+c) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>   <span class="c1">#use red datapoints size 8 and a line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Residuals $y=ax^2+bx$+c&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>   <span class="c1">#adds a horizontal line at y=0</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">xlimits</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">])</span>   <span class="c1">#sets the X-axis and Y-axis boundaries for the bottom plot</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$[BSA]$ ($\mu$g $ml^{-1}$)&#39;</span><span class="p">)</span>   <span class="c1">#adds X-axis title for the bottom plot, which is the same for the top plot</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Absorbance (AU)&#39;</span><span class="p">)</span>   <span class="c1">#adds Y-axis title for the bottom plot</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>   <span class="c1">#include legend</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1">#show the figure object</span>
</pre></div>
</div>
<p>Both fits look ok, but the quadratic curve fit looks better. We can see that there is a trend in the residuals (becoming more negative at higher <span class="math notranslate nohighlight">\([BSA]\)</span>). The fit paramaters seem within reason.</p>
</section>
</div>
</section>
<section id="font-color-blue-data-analysis-using-the-standard-curve-font">
<h2><strong><font color=blue>Data analysis - using the standard curve</font></strong><a class="headerlink" href="#font-color-blue-data-analysis-using-the-standard-curve-font" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>Two replicates at four different dilutions (2,5 x, 5 x, 10 x, and 20 x) of a protein sample of unknown concentration were prepared and the absorbance measured.</p>
<ul class="simple">
<li><p>We calculate the concentration for each sample, and</p></li>
<li><p>we calculate the average concentration taking the dilution factors into account.</p></li>
</ul>
<p>The absorbances of the diluted samples need to be within the range of the standard curve. One might need to discard measurements that are not.</p>
<p>In our example, the 20 x dilution factor is not within the range of the standard curve, <em>e.g.</em> ~0.1 &lt; ~0.2, the lower detection limit in the standard curve. We need to exclude this data point.</p>
<a class="reference internal image-reference" href="../_images/DataColorimetricAssayLowerDetectionLimit.png"><img alt="Data falling below the lower detection limit" class="align-center" src="../_images/DataColorimetricAssayLowerDetectionLimit.png" style="width: 600px;" /></a>
<section id="calculate-the-concentration-for-each-of-the-dilution-factors">
<h3><em>Calculate the concentration for each of the dilution factors</em><a class="headerlink" href="#calculate-the-concentration-for-each-of-the-dilution-factors" title="Permalink to this heading">#</a></h3>
<p>To create a column with our solutions, we use the <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.apply.html">pandas.DataFrame.apply</a> function. We first specify the function that defines the solution for the standard curve, and we then apply this function to the pandas DataFrame columns we want as input, <em>i.e.</em> Sample-1 and Sample-2.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">solcalc</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>   <span class="c1">#create the function</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve the quadratic equation for x when y is given using the quadratic formula</span>

<span class="sd">    Args:</span>
<span class="sd">        the first coefficient, a</span>
<span class="sd">        the second coefficient, b</span>
<span class="sd">        the constant, c</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        the solution x-values of a quadratic equation with y given</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="n">y</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>

<span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;Solution-1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;Sample-1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">solcalc</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">params2</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>   <span class="c1">#apply the function that calculates the solution x-values of a quadratic equation with y given to the Sample-1 absorbances. Use the fitted parameters (converted from NumPy array to list) as arguments for the function (after the y-values). </span>
<span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;Solution-2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;Sample-2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">solcalc</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">params2</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>   <span class="c1">#apply the function that calculates the solution x-values of a quadratic equation with y given to the Sample-2 absorbances. Use the fitted parameters (converted from NumPy array to list) as arguments for the function (after the y-values). </span>
</pre></div>
</div>
</section>
<section id="take-the-dilution-factors-into-account">
<h3><em>Take the dilution factors into account</em><a class="headerlink" href="#take-the-dilution-factors-into-account" title="Permalink to this heading">#</a></h3>
<p>We now add a column with the dilution factors. We calculate the dilution-factor corrected concentrations in two new columns.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;DF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>   <span class="c1">#add a column containing the dilution factors</span>
<span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;Concentration-1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;Solution-1&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;DF&#39;</span><span class="p">]</span>   <span class="c1">#add a column with the calculated values for undiluted samples for 1</span>
<span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;Concentration-2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;Solution-2&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;DF&#39;</span><span class="p">]</span>   <span class="c1">#add a column with the calculated values for undiluted samples for 2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dfCA</span><span class="p">)</span>   <span class="c1">#print the DataFrame</span>
</pre></div>
</div>
</section>
<section id="calculate-the-overal-concentration">
<h3><em>Calculate the overal concentration</em><a class="headerlink" href="#calculate-the-overal-concentration" title="Permalink to this heading">#</a></h3>
<p>We extract the data with the concentrations we want to use to calculate the average concentration in a new DataFrame, called. We then calculate the mean and standard deviation for all values in the new DataFrame.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate the overal concentration</span>
<span class="n">dfCAnew</span><span class="o">=</span><span class="n">dfCA</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>   <span class="c1">#create a new DataFrame containing all values you want to calculate the mean and standard deviation for</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dfCAnew</span><span class="p">)</span>   <span class="c1">#print the new DataFrame </span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dfCAnew</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>   <span class="c1">#convert the new DataFrame into a NumPy array and calulcate the mean of all elements</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dfCAnew</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>   <span class="c1">#convert the new DataFrame into a NumPy array and calulcate the standard deviation of all elements</span>
</pre></div>
</div>
<p>The concentration of the undiluted, original, protein sample is 2018 <span class="math notranslate nohighlight">\(\pm\)</span> 242 <span class="math notranslate nohighlight">\(\mu\)</span>g/mL. The error is derived from technical repeats.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./examples"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="DoseResponseCurve.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Dose response curve</p>
      </div>
    </a>
    <a class="right-next"
       href="RedoxPotential.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Redox potential</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-introduction-font"><strong><font color="blue">Introduction</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-data-font"><strong><font color="blue">Data</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-data-analysis-creating-the-standard-curve-font"><strong><font color="blue">Data analysis - creating the standard curve</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-data-analysis-using-the-standard-curve-font"><strong><font color="blue">Data analysis - using the standard curve</font></strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-concentration-for-each-of-the-dilution-factors"><em>Calculate the concentration for each of the dilution factors</em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#take-the-dilution-factors-into-account"><em>Take the dilution factors into account</em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-overal-concentration"><em>Calculate the overal concentration</em></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Renee Vancraenenbroeck, UCL
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>