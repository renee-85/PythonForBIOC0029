

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Dose response curve &#8212; Python For BIOC0029</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.4cbf315f70debaebd550c87a6162cf0f.min.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/SolutionsExamples';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../WelcomeToPythonForBIOC0029.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Python For BIOC0029 - Home"/>
    <img src="../_static/logo.png" class="logo__image only-dark pst-js-only" alt="Python For BIOC0029 - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../WelcomeToPythonForBIOC0029.html">
                    Welcome to Python for BIOC0029
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Running Python code</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapters/JupyterNotebooksGettingStarted.html">Jupyter Notebooks: Getting Started</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Python basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapters/VariablesDataTypesIndicesSlices.html">Variables, Data Types, Indices, and Slices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/ForLoopsLogicStatementsFunctions.html">For Loops, Logic Statements, and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/Libraries.html">Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/NumPyForArithmeticOperations.html">NumPy For Arithmetic Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/PandasForTabularData.html">Pandas For Working With Tabular Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/MatplotlibForPlotting.html">Matplotlib For Plotting And Data Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/SciPyForDataFitting.html">SciPy For Data Fitting</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Outliers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../outliers/Introduction.html">Outliers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../outliers/GrubbsTest.html">The Grubbsâ€™ test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../outliers/GeneralizedESDTest.html">The generalized (Extreme Studentized Deviate) ESD test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../outliers/Residuals.html">Ordinary, standardized and studentized residuals</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DoseResponseCurve.html">Dose response curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="ColorimetricAssay.html">Colorimetric assay</a></li>
<li class="toctree-l1"><a class="reference internal" href="RedoxPotential.html">Redox potential</a></li>
<li class="toctree-l1"><a class="reference internal" href="ThermalShiftAssay.html">Thermal shift assay</a></li>
<li class="toctree-l1"><a class="reference internal" href="ChemicalUnfolding.html">Chemical unfolding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Michaelis-MentenCurve.html">Michaelis-Menten curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="SimulatingData.html">Simulating data</a></li>
<li class="toctree-l1"><a class="reference internal" href="ProteinLigandBinding.html">Protein-ligand binding</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fexamples/SolutionsExamples.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/examples/SolutionsExamples.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Dose response curve</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Dose response curve</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#colorimetric-assay">Colorimetric assay</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#redox-potential">Redox potential</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#chemical-unfolding">Chemical unfolding</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#michaelis-menten-curve">Michaelis-Menten curve</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermal-shift-assay">Thermal shift assay</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#for-well-a1">For well A1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-1-first-derivative-method">Analysis 1: First derivative method</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tip-make-a-plot-with-a-secondary-y-axis">Tip: Make a plot with a secondary Y-axis</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tip-smoothen-a-curve">Tip: Smoothen a curve</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-2-curve-fitting-using-a-boltzmann-model">Analysis 2: Curve fitting using a Boltzmann model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-3-curve-fitting-using-the-equation-describing-the-unfolding-of-a-monomer-via-a-two-state-mechanism">Analysis 3: Curve fitting using the equation describing the unfolding of a monomer via a two-state mechanism</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#advice-overfitting">Advice: Overfitting</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#for-each-well">For each wellâ€¦</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-data">Simulating data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-rightarrow-b"><span class="math notranslate nohighlight">\(A\)</span> <span class="math notranslate nohighlight">\(\rightarrow\)</span> <span class="math notranslate nohighlight">\(B\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-b-rightleftharpoons-ab"><span class="math notranslate nohighlight">\(A + B\)</span> <span class="math notranslate nohighlight">\(\rightleftharpoons\)</span> <span class="math notranslate nohighlight">\(AB\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#e-s-rightleftharpoons-es-rightarrow-e-p"><span class="math notranslate nohighlight">\(E + S\)</span> <span class="math notranslate nohighlight">\(\rightleftharpoons\)</span> <span class="math notranslate nohighlight">\(ES\)</span> <span class="math notranslate nohighlight">\(\rightarrow\)</span> <span class="math notranslate nohighlight">\(E + P\)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-pre-steady-state-or-transient-phase">The pre-steady state (or transient) phase</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-steady-state-phase">The steady state phase</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#after-10-s">After ~10 s</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-s-0-1-10-mum-and-s-0-2-1-mum-for-k-1-1-k-1-2-1-mum-1-s-1-k-1-1-k-1-2-0-1-s-1-k-2-1-k-2-2-0-5-s-1-es-0-1-es-0-2-0-mum-p-0-1-p-0-2-0-mum-and-e-0-1-e-0-2-1-mum-we-can-see-that-the-initial-reaction-rate-decreases-and-that-es-decreases-rapidly-for-s-0-2-there-is-only-enough-substrate-for-a-single-turnover-where-does-each-curve-reach-a-plateau">Compare <span class="math notranslate nohighlight">\([S]_{0,1} = 10\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span> and <span class="math notranslate nohighlight">\([S]_{0,2} = 1\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span> for <span class="math notranslate nohighlight">\(k_{+1,1} = k_{+1,2} = 1\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M^{-1} s^{-1}\)</span>; <span class="math notranslate nohighlight">\(k_{-1,1} = k_{-1,2} = 0.1\)</span> <span class="math notranslate nohighlight">\(s^{-1}\)</span>; <span class="math notranslate nohighlight">\(k_{2,1} = k_{2,2} = 0.5\)</span> <span class="math notranslate nohighlight">\(s^{-1}\)</span>, <span class="math notranslate nohighlight">\([ES]_{0,1} = [ES]_{0,2} = 0\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span>, <span class="math notranslate nohighlight">\([P]_{0,1} = [P]_{0,2} = 0\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span>, and <span class="math notranslate nohighlight">\([E]_{0,1} = [E]_{0,2} = 1\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span>. We can see that the initial reaction rate decreases and that <span class="math notranslate nohighlight">\([ES]\)</span> decreases rapidly for <span class="math notranslate nohighlight">\([S]_{0,2}\)</span>. There is only enough substrate for a single turnover. Where does each curve reach a plateau?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-e-0-1-1-mum-and-e-0-2-0-1-mum-for-k-1-1-k-1-2-1-mum-1-s-1-k-1-1-k-1-2-0-1-s-1-k-2-1-k-2-2-0-5-s-1-es-0-1-es-0-2-0-mum-p-0-1-p-0-2-0-mum-and-s-0-1-s-0-2-10-mum-we-can-see-that-the-duration-of-the-steady-state-phase-increases-for-e-0-2-the-enzyme-undergoes-multiple-rounds-of-catalysis-without-depleting-the-substrate-when-we-study-steady-state-kinetics-conditions-are-chosen-so-that-s-0-gg-e-0">Compare <span class="math notranslate nohighlight">\([E]_{0,1} = 1\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span> and <span class="math notranslate nohighlight">\([E]_{0,2} = 0.1\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span> for <span class="math notranslate nohighlight">\(k_{+1,1} = k_{+1,2} = 1\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M^{-1} s^{-1}\)</span>; <span class="math notranslate nohighlight">\(k_{-1,1} = k_{-1,2} = 0.1\)</span> <span class="math notranslate nohighlight">\(s^{-1}\)</span>; <span class="math notranslate nohighlight">\(k_{2,1} = k_{2,2} = 0.5\)</span> <span class="math notranslate nohighlight">\(s^{-1}\)</span>, <span class="math notranslate nohighlight">\([ES]_{0,1} = [ES]_{0,2} = 0\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span>, <span class="math notranslate nohighlight">\([P]_{0,1} = [P]_{0,2} = 0\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span>, and <span class="math notranslate nohighlight">\([S]_{0,1} = [S]_{0,2} = 10\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span>. We can see that the duration of the steady-state phase increases for <span class="math notranslate nohighlight">\([E]_{0,2}\)</span>. The enzyme undergoes multiple rounds of catalysis without depleting the substrate. When we study steady-state kinetics, conditions are chosen so that <span class="math notranslate nohighlight">\([S]_0 \gg [E]_0\)</span>.</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="dose-response-curve">
<h1>Dose response curve<a class="headerlink" href="#dose-response-curve" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Import the libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Read the Excel file</span>
<span class="n">dfDRC</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span> <span class="p">(</span><span class="s1">&#39;../data/DoseResponseCurveAssay.xlsx&#39;</span><span class="p">,</span>   <span class="c1">#create a pandas DataFrame from the filename with file path and extension shown!</span>
                       <span class="n">sheet_name</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>   <span class="c1">#use the first sheet (no need to specifically include this as we use the default setting)</span>
                       <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>   <span class="c1">#our data has column names</span>

<span class="nb">print</span><span class="p">(</span><span class="n">dfDRC</span><span class="p">)</span>   <span class="c1">#print the DataFrame created</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    [Drug 1] (ng/ml)  Response 1  [Drug 2] (ng/ml)  Response 2
0             0.0005       0.013            0.0003       0.007
1             0.0010       0.011            0.0006       0.007
2             0.0050       0.008            0.0060       0.011
3             0.0100       0.016            0.0120       0.030
4             0.0500       0.029            0.0300       0.024
5             0.1000       0.040            0.1200       0.049
6             0.5000       0.063            0.3000       0.051
7             1.5000       0.079            1.2000       0.066
8             3.0000       0.089            3.0000       0.077
9            10.0000       0.093           12.0000       0.098
10           30.0000       0.092           30.0000       0.087
11          100.0000       0.088          120.0000       0.084
12          300.0000       0.076          300.0000       0.100
13         1000.0000       0.078         1200.0000       0.097
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate log10[Drug]</span>
<span class="n">dfDRC</span><span class="p">[</span><span class="s1">&#39;log[Drug 1]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dfDRC</span><span class="p">[</span><span class="s1">&#39;[Drug 1] (ng/ml)&#39;</span><span class="p">])</span>
<span class="n">dfDRC</span><span class="p">[</span><span class="s1">&#39;log[Drug 2]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dfDRC</span><span class="p">[</span><span class="s1">&#39;[Drug 2] (ng/ml)&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot the data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>   <span class="c1">#start a figure object</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfDRC</span><span class="p">[</span><span class="s1">&#39;log[Drug 1]&#39;</span><span class="p">],</span> <span class="n">dfDRC</span><span class="p">[</span><span class="s1">&#39;Response 1&#39;</span><span class="p">],</span>   <span class="c1">#plot a set of x (= the log concentrations) ,y (=the responses) data</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>   <span class="c1">#use a round, gray marker with size 8</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfDRC</span><span class="p">[</span><span class="s1">&#39;log[Drug 2]&#39;</span><span class="p">],</span> <span class="n">dfDRC</span><span class="p">[</span><span class="s1">&#39;Response 2&#39;</span><span class="p">],</span>   <span class="c1">#plot a set of x (= the log concentrations) ,y (=the responses) data, a different experiment</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>   <span class="c1">#use a square, black marker with size 8</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Dose-response Curve&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>   <span class="c1">#title of graph</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;log $[Drug]$ (ng ml$^{-1}$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#X-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Response&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#Y-axis label</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1">#show the figure object</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4161f732318054708c9387a8b41e538efab4ca9a175cf04bc90b730c5e96c538.png" src="../_images/4161f732318054708c9387a8b41e538efab4ca9a175cf04bc90b730c5e96c538.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Define the Hill function</span>
<span class="k">def</span> <span class="nf">funcDRC</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Rmin</span><span class="p">,</span> <span class="n">Rmax</span><span class="p">,</span> <span class="n">EC50</span><span class="p">,</span> <span class="n">nHill</span><span class="p">):</span>   <span class="c1">#create the function</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the Hill equation using Rmin, Rmax, EC50, and nHill</span>

<span class="sd">    Args:</span>
<span class="sd">        Rmin, the response effect in the absence of drug</span>
<span class="sd">        Rmax, the maximum effect</span>
<span class="sd">        EC50, the relative 50% effective dose or concentration</span>
<span class="sd">        nHill, the Hill exponent which describes the steepness of the curve</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        the Hill equation function &quot;a * x + b&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Rmin</span> <span class="o">+</span> <span class="p">(</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(((</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">EC50</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">x</span><span class="p">))</span><span class="o">**</span><span class="n">nHill</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Combine all data</span>
<span class="n">xDRC</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">dfDRC</span><span class="p">[</span><span class="s1">&#39;log[Drug 1]&#39;</span><span class="p">],</span> <span class="n">dfDRC</span><span class="p">[</span><span class="s1">&#39;log[Drug 2]&#39;</span><span class="p">]])</span>
<span class="n">yDRC</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">dfDRC</span><span class="p">[</span><span class="s1">&#39;Response 1&#39;</span><span class="p">],</span> <span class="n">dfDRC</span><span class="p">[</span><span class="s1">&#39;Response 2&#39;</span><span class="p">]])</span>

<span class="c1">#Fit all data</span>
<span class="n">paramsDRC</span><span class="p">,</span> <span class="n">params_covarianceDRC</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">funcDRC</span><span class="p">,</span>   <span class="c1">#the function we try to fit to the data</span>
                                            <span class="n">xDRC</span><span class="p">,</span>   <span class="c1">#the x values, the log10 concentrations</span>
                                            <span class="n">yDRC</span><span class="p">,</span>   <span class="c1">#the y values, the responses</span>
                                            <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>   <span class="c1">#the starting parameters, guesses from graph</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Report the fit parameters with standard errors</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rmin, the effect in the absence of drug = &quot;</span><span class="p">,</span> <span class="n">paramsDRC</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;Â±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covarianceDRC</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rmax, the maximum effect = &quot;</span><span class="p">,</span> <span class="n">paramsDRC</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;Â±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covarianceDRC</span><span class="p">))[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;EC50 in (ng/ml), the relative 50</span><span class="si">% e</span><span class="s2">ffective concentration = &quot;</span><span class="p">,</span> <span class="n">paramsDRC</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;Â±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covarianceDRC</span><span class="p">))[</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;nHill, the Hill exponent = &quot;</span><span class="p">,</span> <span class="n">paramsDRC</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;Â±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covarianceDRC</span><span class="p">))[</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rmin, the effect in the absence of drug =  0.008498737616173405 Â± 0.003651549867015662
Rmax, the maximum effect =  0.09020671030749035 Â± 0.002591463050546109
EC50 in (ng/ml), the relative 50% effective concentration =  0.18338955867846177 Â± 0.048639840934997174
nHill, the Hill exponent =  0.7526341501947715 Â± 0.13216413421539713
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate the residuals</span>
<span class="n">residDRC</span> <span class="o">=</span> <span class="n">yDRC</span> <span class="o">-</span> <span class="n">funcDRC</span><span class="p">(</span><span class="n">xDRC</span><span class="p">,</span> <span class="o">*</span><span class="n">paramsDRC</span><span class="p">)</span>   <span class="c1">#calculate the residuals, the star in *paramsDRC unpacks the array so the two optimized parameter values become the second to fifth arguments (after the x-values) to the function</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Generate X-values to calculate the function</span>
<span class="n">xvalues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>   <span class="c1">#create an array with 1000 evenly distributed elements between 0 (included) and -10 (included)</span>

<span class="c1">#Produce a combined graph</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>   <span class="c1">#to create a figure object</span>

<span class="n">xlimits</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>   <span class="c1">#to make sure we use the same of the X-axis boundaries for both plots</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.51</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>   <span class="c1">#to specify the coordinates, width and height of the top plot</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>   <span class="c1">#to specify the coordinates, width and height of the bottom plot</span>


<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xDRC</span><span class="p">,</span> <span class="n">yDRC</span><span class="p">,</span>   <span class="c1">#plot a set of x (= the log concentrations) ,y (=the responses) data</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>   <span class="c1">#use a round, gray marker with size 8 but no line </span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvalues</span><span class="p">,</span> <span class="n">funcDRC</span><span class="p">(</span><span class="n">xvalues</span><span class="p">,</span> <span class="o">*</span><span class="n">paramsDRC</span><span class="p">),</span>   <span class="c1">#add the fitted curve to plot. Use the generated log10 concentrations as x-values. Use the fit parameters to calculate the y-values. The star in *paramsDRC unpacks the array so the two optimized parameter values become the second to fifth arguments (after the x-values) to the function.</span>
         <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>   <span class="c1">#use a red line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label </span>

<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">xlimits</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">])</span>   <span class="c1">#sets the X-axis and Y-axis boundaries for the top plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>   <span class="c1">#removes the ticks and tick labels on the X-axis for the top plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Response&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#adds Y-axis title for the top plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>   <span class="c1">#include legend</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xDRC</span><span class="p">,</span> <span class="n">residDRC</span><span class="p">,</span>     <span class="c1">#plot a set of x (=the concentrations),y (= the residuals) data points</span>
          <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>   <span class="c1">#use a round, gray marker with size 8 but no line </span>

<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>   <span class="c1">#adds a horizontal line at y=0</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">xlimits</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.025</span><span class="p">,</span><span class="mf">0.025</span><span class="p">])</span>   <span class="c1">#sets the X-axis and Y-axis boundaries for the bottom plot</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;log $[Drug]$ (ng ml$^{-1}$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#adds X-axis title for the bottom plot, which is the same for the top plot</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Residuals&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#adds Y-axis title for the bottom plot</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1">#show the figure object</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c9e0070189521a51acb86b6391de5f1591b08dd91fafdc2c24cf4f3b3ab197ae.png" src="../_images/c9e0070189521a51acb86b6391de5f1591b08dd91fafdc2c24cf4f3b3ab197ae.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="colorimetric-assay">
<h1>Colorimetric assay<a class="headerlink" href="#colorimetric-assay" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Import the libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Read the Excel file</span>
<span class="n">dfCA</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span> <span class="p">(</span><span class="s1">&#39;../data/ColorimetricAssay.xlsx&#39;</span><span class="p">,</span>   <span class="c1">#create a pandas DataFrame from the filename with file path and extension shown</span>
                    <span class="n">sheet_name</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>   <span class="c1">#use the first sheet (no need to specifically include this as we use the default setting)</span>
                    <span class="n">skiprows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>   <span class="c1">#skip the first three rows</span>
                    <span class="n">skipfooter</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>   <span class="c1">#skip the last three rows </span>
                    <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span>   <span class="c1">#only import columns 6 to 9 - be aware that column numbers start with zero!</span>
                    <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>   <span class="c1">#our data does not have column names</span>
                    <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;BSA-1&#39;</span><span class="p">,</span><span class="s1">&#39;BSA-2&#39;</span><span class="p">,</span> <span class="s1">&#39;Sample-1&#39;</span><span class="p">,</span> <span class="s1">&#39;Sample-2&#39;</span><span class="p">])</span>   <span class="c1">#use BSA-1, BSA-2, Sample-1, and Sample-2 as column names</span>

<span class="nb">print</span> <span class="p">(</span><span class="n">dfCA</span><span class="p">)</span>   <span class="c1">#print the DataFrame created</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   BSA-1  BSA-2  Sample-1  Sample-2
0  1.405  1.240    0.6570    0.6090
1  1.125  0.974    0.4322    0.3690
2  0.844  0.686    0.2870    0.2580
3  0.705  0.560    0.1090    0.1050
4  0.539  0.436    0.0560    0.0648
5  0.311  0.278    0.0586    0.0562
6  0.209  0.188    0.0682    0.0567
7  0.100  0.095    0.0589    0.0563
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Insert a column containing the concentrations of the standards</span>
<span class="n">x1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>   <span class="c1">#create a list with integers containing the concentrations</span>

<span class="n">dfCA</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;[BSA]&#39;</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>   <span class="c1">#insert the column at index 0 (i.e. make it the first column) in dfCA, name the column [BSA], and fill it with the data provided by x1</span>

<span class="nb">print</span><span class="p">(</span><span class="n">dfCA</span><span class="p">)</span>   <span class="c1">#print the DataFrame created</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   [BSA]  BSA-1  BSA-2  Sample-1  Sample-2
0   2000  1.405  1.240    0.6570    0.6090
1   1500  1.125  0.974    0.4322    0.3690
2   1000  0.844  0.686    0.2870    0.2580
3    750  0.705  0.560    0.1090    0.1050
4    500  0.539  0.436    0.0560    0.0648
5    250  0.311  0.278    0.0586    0.0562
6    125  0.209  0.188    0.0682    0.0567
7      0  0.100  0.095    0.0589    0.0563
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot the data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>   <span class="c1">#start a figure object</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;[BSA]&#39;</span><span class="p">],</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-1&#39;</span><span class="p">],</span>   <span class="c1">#plot a set of x (= the concentrations),y (= the measured absorbances) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>   <span class="c1">#use a round, gray marker with size 8</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;[BSA]&#39;</span><span class="p">],</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-2&#39;</span><span class="p">],</span>   <span class="c1">#plot another set of x (= the concentrations),y (= the measured absorbances) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>   <span class="c1">#use a round, black marker with size 8</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Standard Curve&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>   <span class="c1">#title of graph</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$[BSA]$ ($\mu$g $ml^{-1}$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#X-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Absorbance (AU)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#Y-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>   <span class="c1">#axis boundaries, in this case from -10 to 2200 for the X-axis and 0 to 1.5 for the Y-axis</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1">#show the figure object</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:11: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:11: SyntaxWarning: invalid escape sequence &#39;\m&#39;
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\761490774.py:11: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.xlabel(&#39;$[BSA]$ ($\mu$g $ml^{-1}$)&#39;, fontsize=14)   #X-axis label
</pre></div>
</div>
<img alt="../_images/1a673cabbe393d34b8ad53759b14b20849c6bd10160cca9a540a948af5cc2c7b.png" src="../_images/1a673cabbe393d34b8ad53759b14b20849c6bd10160cca9a540a948af5cc2c7b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate mean and stdev</span>
<span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCA</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>   <span class="c1">#we use axis 1 to get the mean of the elements of one row, we use columns 1 = BSA-1 and 2 = BSA-2, represented by [1:3]. The result is added to a new column.</span>
<span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCA</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>   <span class="c1">#we use axis 1 to get the standard deviation of the elements of one row, we use columns 1 = BSA-1 and 2 = BSA-2, represented by [1:3]. The result is added to a new column.</span>

<span class="nb">print</span><span class="p">(</span><span class="n">dfCA</span><span class="p">)</span>   <span class="c1">#print the DataFrame created</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   [BSA]  BSA-1  BSA-2  Sample-1  Sample-2  BSA-mean   BSA-std
0   2000  1.405  1.240    0.6570    0.6090    1.3225  0.116673
1   1500  1.125  0.974    0.4322    0.3690    1.0495  0.106773
2   1000  0.844  0.686    0.2870    0.2580    0.7650  0.111723
3    750  0.705  0.560    0.1090    0.1050    0.6325  0.102530
4    500  0.539  0.436    0.0560    0.0648    0.4875  0.072832
5    250  0.311  0.278    0.0586    0.0562    0.2945  0.023335
6    125  0.209  0.188    0.0682    0.0567    0.1985  0.014849
7      0  0.100  0.095    0.0589    0.0563    0.0975  0.003536
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Define a line</span>
<span class="k">def</span> <span class="nf">funcline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>   <span class="c1">#create the function</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a line using slope and intercept</span>

<span class="sd">    Args:</span>
<span class="sd">        the slope, a</span>
<span class="sd">        the intercept, b</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        the line function &quot;a * x + b&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span>
    
<span class="c1">#Define a quadratic curve</span>
<span class="k">def</span> <span class="nf">funcpoly2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>   <span class="c1">#create the function</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a quadratic curve using the first and second coefficients, a and b, and constant, c</span>

<span class="sd">    Args:</span>
<span class="sd">        the first coefficient, a</span>
<span class="sd">        the second coefficient, b</span>
<span class="sd">        the constant, c</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        the quadratic curve function &quot;a * x^2 + b * x + c&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">c</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Fit with a line</span>
<span class="n">params1</span><span class="p">,</span> <span class="n">params_covariance1</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">funcline</span><span class="p">,</span>   <span class="c1">#the line function we try to fit to the data</span>
                                        <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;[BSA]&#39;</span><span class="p">],</span>   <span class="c1">#the x values, the concentrations</span>
                                        <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-mean&#39;</span><span class="p">],</span>   <span class="c1">#the y values, the measured absorbances</span>
                                        <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>   <span class="c1">#the starting parameters for a (=the slope) and b (=the intercept)</span>
                                        <span class="n">sigma</span><span class="o">=</span><span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-std&#39;</span><span class="p">],</span>   <span class="c1">#the standard deviations used for weighted fitting</span>
                                        <span class="n">absolute_sigma</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>   <span class="c1">#use sigma (=the standard deviations) in an absolute sense</span>

<span class="c1">#Fit with a quadratic curve</span>
<span class="n">params2</span><span class="p">,</span> <span class="n">params_covariance2</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">funcpoly2</span><span class="p">,</span>   <span class="c1">#the quadratic curve function we try to fit to the data</span>
                                        <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;[BSA]&#39;</span><span class="p">],</span>   <span class="c1">#the x values, the concentrations</span>
                                        <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-mean&#39;</span><span class="p">],</span>   <span class="c1">#the y values, the measured absorbances</span>
                                        <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>   <span class="c1">#the starting parameters for a (=the first coefficient), b (=the second coefficient), and c (=the constant)</span>
                                        <span class="n">sigma</span><span class="o">=</span><span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-std&#39;</span><span class="p">],</span>   <span class="c1">#the standard deviations used for weighted fitting</span>
                                        <span class="n">absolute_sigma</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>   <span class="c1">#use sigma (=the standard deviations) in an absolute sense</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Report the fit parameters with standard errors for the line function</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Slope, a = &quot;</span><span class="p">,</span> <span class="n">params1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;Â±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covariance1</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Intercept, b = &quot;</span><span class="p">,</span> <span class="n">params1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;Â±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covariance1</span><span class="p">))[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1">#Report the fit parameters with standard errors for the quadratic function</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First coefficient, a =&quot;</span><span class="p">,</span> <span class="n">params2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;Â±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covariance2</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Second coefficient, b = &quot;</span><span class="p">,</span> <span class="n">params2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;Â±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covariance2</span><span class="p">))[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Constant, c = &quot;</span><span class="p">,</span> <span class="n">params2</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;Â±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covariance2</span><span class="p">))[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Slope, a =  0.0006752911504972768 Â± 3.4711561818850496e-05
Intercept, b =  0.09893123662572621 Â± 0.0034483918891948778
First coefficient, a = -1.0251269659569087e-07 Â± 4.918443551362741e-08
Second coefficient, b =  0.000804959044796896 Â± 7.124165832527459e-05
Constant, c =  0.097629671857749 Â± 0.003504479565086863
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate the residuals for the line function</span>
<span class="n">resid1</span> <span class="o">=</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-mean&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">funcline</span><span class="p">(</span><span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;[BSA]&#39;</span><span class="p">],</span> <span class="o">*</span><span class="n">params1</span><span class="p">)</span>   <span class="c1">#calculate the residuals, the star in _*params1_ unpacks the array so the two optimized parameter values become the second and third arguments (after the x-values) to the function</span>

<span class="c1">#Calculate the residuals for the quadratic function</span>
<span class="n">resid2</span> <span class="o">=</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-mean&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">funcpoly2</span><span class="p">(</span><span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;[BSA]&#39;</span><span class="p">],</span> <span class="o">*</span><span class="n">params2</span><span class="p">)</span>   <span class="c1">#calculate the residuals, the star in _*params2_ unpacks the array so the two optimized parameter values become the second, third, and fourth arguments (after the x-values) to the function</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Generate X-values to calculate the function</span>
<span class="n">xvalues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2200</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>   <span class="c1">#create an array with 100 evenly distributed elements between 0 (included) and 2200 (included)</span>

<span class="c1">#Produce a combined graph</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>   <span class="c1">#to create a figure object</span>

<span class="n">xlimits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2200</span><span class="p">]</span>   <span class="c1">#to make sure we use the same of the X-axis boundaries for both plots</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.81</span><span class="p">])</span>   <span class="c1">#to specify the coordinates, width and height of the top plot</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>   <span class="c1">#to specify the coordinates, width and height of the bottom plot</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;[BSA]&#39;</span><span class="p">],</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-mean&#39;</span><span class="p">],</span>   <span class="c1">#plot a set of x (= the concentrations),y (= the mean absorbances) data points</span>
             <span class="n">yerr</span><span class="o">=</span><span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;BSA-std&#39;</span><span class="p">],</span>   <span class="c1">#use an error bar (= the standard deviations)</span>
             <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="c1">#use a round, black marker with size 8</span>
             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvalues</span><span class="p">,</span> <span class="n">funcline</span><span class="p">(</span><span class="n">xvalues</span><span class="p">,</span> <span class="o">*</span><span class="n">params1</span><span class="p">),</span>   <span class="c1">#add the fitted line to plot. Use the generated BSA concentrations as x-values. Use the fitted parameters to calculate the y-values. The star in _*params1_ unpacks the array so the two optimized parameter values become the second and third arguments (after the x-values) to the function.</span>
         <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>   <span class="c1">#use a gray line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit $y=ax+b$&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvalues</span><span class="p">,</span> <span class="n">funcpoly2</span><span class="p">(</span><span class="n">xvalues</span><span class="p">,</span> <span class="o">*</span><span class="n">params2</span><span class="p">),</span>   <span class="c1">#add the fitted quadratic curve to plot. Use the generated BSA concentrations as x-values. Use the fitted parameters to calculate the y-values. The star in _*params2_ unpacks the array so the two optimized parameter values become the second, third, and fourth arguments (after the x-values) to the function.</span>
         <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>   <span class="c1">#use a red line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit $y=ax^2+bx$+c&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">xlimits</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>   <span class="c1">#sets the X-axis and Y-axis boundaries for the top plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>   <span class="c1">#removes the ticks and tick labels on the X-axis for the top plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Absorbance (AU)&#39;</span><span class="p">)</span>   <span class="c1">#adds Y-axis title for the top plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>   <span class="c1">#include legend</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;[BSA]&#39;</span><span class="p">],</span> <span class="n">resid1</span><span class="p">,</span>   <span class="c1">#plot a set of x (= the concentrations),y (= the residuals for y=ax) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>   <span class="c1">#use gray datapoints size 8 and a line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Residuals $y=ax+b$&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;[BSA]&#39;</span><span class="p">],</span> <span class="n">resid2</span><span class="p">,</span>   <span class="c1">#plot a set of x (= the concentrations),y (= the residuals for y=ax^2+bx+c) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>   <span class="c1">#use red datapoints size 8 and a line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Residuals $y=ax^2+bx$+c&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>   <span class="c1">#adds a horizontal line at y=0</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">xlimits</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">])</span>   <span class="c1">#sets the X-axis and Y-axis boundaries for the bottom plot</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$[BSA]$ ($\mu$g $ml^{-1}$)&#39;</span><span class="p">)</span>   <span class="c1">#adds X-axis title for the bottom plot, which is the same for the top plot</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Absorbance (AU)&#39;</span><span class="p">)</span>   <span class="c1">#adds Y-axis title for the bottom plot</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>   <span class="c1">#include legend</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1">#show the figure object</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:41: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:41: SyntaxWarning: invalid escape sequence &#39;\m&#39;
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\3878947254.py:41: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  ax2.set_xlabel(&#39;$[BSA]$ ($\mu$g $ml^{-1}$)&#39;)   #adds X-axis title for the bottom plot, which is the same for the top plot
</pre></div>
</div>
<img alt="../_images/926a601ecd6139dd2c40912a9e1690bb949b899afa072f79c8a3773d922743c4.png" src="../_images/926a601ecd6139dd2c40912a9e1690bb949b899afa072f79c8a3773d922743c4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate the concentration for each of the dilution factors</span>
<span class="k">def</span> <span class="nf">solcalc</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>   <span class="c1">#create the function</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve the quadratic equation for x when y is given using the quadratic formula</span>

<span class="sd">    Args:</span>
<span class="sd">        the first coefficient, a</span>
<span class="sd">        the second coefficient, b</span>
<span class="sd">        the constant, c</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        the solution x-values of a quadratic equation with y given</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="n">y</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>

<span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;Solution-1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;Sample-1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">solcalc</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">params2</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>   <span class="c1">#apply the function that calculates the solution x-values of a quadratic equation with y given to the Sample-1 absorbances. Use the fitted parameters (converted from NumPy array to list) as arguments for the function (after the y-values). </span>
<span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;Solution-2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;Sample-2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">solcalc</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">params2</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>   <span class="c1">#apply the function that calculates the solution x-values of a quadratic equation with y given to the Sample-2 absorbances. Use the fitted parameters (converted from NumPy array to list) as arguments for the function (after the y-values). </span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Take the dilution factors into account</span>
<span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;DF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>   <span class="c1">#add a column containing the dilution factors</span>
<span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;Concentration-1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;Solution-1&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;DF&#39;</span><span class="p">]</span>   <span class="c1">#add a column with the calculated values for undiluted samples for 1</span>
<span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;Concentration-2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;Solution-2&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfCA</span><span class="p">[</span><span class="s1">&#39;DF&#39;</span><span class="p">]</span>   <span class="c1">#add a column with the calculated values for undiluted samples for 2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dfCA</span><span class="p">)</span>   <span class="c1">#print the DataFrame</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   [BSA]  BSA-1  BSA-2  Sample-1  Sample-2  BSA-mean   BSA-std  Solution-1  \
0   2000  1.405  1.240    0.6570    0.6090    1.3225  0.116673  770.512554   
1   1500  1.125  0.974    0.4322    0.3690    1.0495  0.106773  440.328532   
2   1000  0.844  0.686    0.2870    0.2580    0.7650  0.111723  242.759724   
3    750  0.705  0.560    0.1090    0.1050    0.6325  0.102530   14.150852   
4    500  0.539  0.436    0.0560    0.0648    0.4875  0.072832  -51.380310   
5    250  0.311  0.278    0.0586    0.0562    0.2945  0.023335  -48.190776   
6    125  0.209  0.188    0.0682    0.0567    0.1985  0.014849  -36.391799   
7      0  0.100  0.095    0.0589    0.0563    0.0975  0.003536  -47.822589   

   Solution-2    DF  Concentration-1  Concentration-2  
0  697.174408   2.5      1926.281385      1742.936019  
1  352.991523   5.0      2201.642660      1764.957615  
2  204.556761  10.0      2427.597239      2045.567610  
3    9.166854  20.0       283.017031       183.337089  
4  -40.574617   0.0        -0.000000        -0.000000  
5  -51.135052   0.0        -0.000000        -0.000000  
6  -50.521841   0.0        -0.000000        -0.000000  
7  -51.012417   0.0        -0.000000        -0.000000  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate the overal concentration</span>
<span class="n">dfCAnew</span><span class="o">=</span><span class="n">dfCA</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>   <span class="c1">#create a new DataFrame containing all values you want to calculate the mean and standard deviation for</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dfCAnew</span><span class="p">)</span>   <span class="c1">#print the new DataFrame </span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dfCAnew</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>   <span class="c1">#convert the new DataFrame into a NumPy array and calulcate the mean of all elements</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dfCAnew</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>   <span class="c1">#convert the new DataFrame into a NumPy array and calulcate the standard deviation of all elements</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Concentration-1  Concentration-2
0      1926.281385      1742.936019
1      2201.642660      1764.957615
2      2427.597239      2045.567610
2018.1637547413357
241.6461886993642
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="redox-potential">
<h1>Redox potential<a class="headerlink" href="#redox-potential" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Import the libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Read the Excel file</span>
<span class="n">dfRP</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span> <span class="p">(</span><span class="s1">&#39;../data/RedoxPotential.xlsx&#39;</span><span class="p">,</span>   <span class="c1">#create a pandas DataFrame from the filename with file path and extension shown</span>
                    <span class="n">sheet_name</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>   <span class="c1">#use the first sheet (no need to specifically include this as we use the default setting)</span>
                    <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>   <span class="c1">#our data has column names</span>

<span class="nb">print</span><span class="p">(</span><span class="n">dfRP</span><span class="p">)</span>   <span class="c1">#print the DataFrame created</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    A550nm (AU)  [Ferricyanide] (mM)  [Ferrocyanide] (mM)  \
0         0.264            10.000000             0.000000   
1         0.738             0.000000             0.000000   
2         0.433             0.024938             9.975062   
3         0.374             0.049751             9.950249   
4         0.342             0.074442             9.925558   
5         0.326             0.099010             9.900990   
6         0.315             0.123457             9.876543   
7         0.307             0.147783             9.852217   
8         0.302             0.196078             9.803922   
9         0.296             0.243902             9.756098   
10        0.289             0.291262             9.708738   

    [Sodium dithionite] (mM)  
0                          0  
1                         10  
2                          0  
3                          0  
4                          0  
5                          0  
6                          0  
7                          0  
8                          0  
9                          0  
10                         0  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate log10([Ferrocyanide]/[Ferricyanide])</span>

<span class="n">dfRP</span><span class="p">[</span><span class="s1">&#39;Log10([FerroCN]/[FerriCN])&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="n">dfRP</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">dfRP</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span><span class="mi">1</span><span class="p">]))</span>   <span class="c1">#Calculate log10([Ferrocyanide]/[Ferricyanide]), but not for the first two rows as specified using iloc[start_index_row:(to end row), index_column] = [2:,2] and [2:,1] with column 1 (we start counting from 0!) = [Ferricyanide] and column 2 = [Ferrocyanide]. Store the information in a new column called &#39;Log10([FerroCN]/[FerriCN])&#39;.</span>

<span class="nb">print</span><span class="p">(</span><span class="n">dfRP</span><span class="p">)</span>   <span class="c1">#print the DataFrame created</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    A550nm (AU)  [Ferricyanide] (mM)  [Ferrocyanide] (mM)  \
0         0.264            10.000000             0.000000   
1         0.738             0.000000             0.000000   
2         0.433             0.024938             9.975062   
3         0.374             0.049751             9.950249   
4         0.342             0.074442             9.925558   
5         0.326             0.099010             9.900990   
6         0.315             0.123457             9.876543   
7         0.307             0.147783             9.852217   
8         0.302             0.196078             9.803922   
9         0.296             0.243902             9.756098   
10        0.289             0.291262             9.708738   

    [Sodium dithionite] (mM)  Log10([FerroCN]/[FerriCN])  
0                          0                         NaN  
1                         10                         NaN  
2                          0                    2.602060  
3                          0                    2.301030  
4                          0                    2.124939  
5                          0                    2.000000  
6                          0                    1.903090  
7                          0                    1.823909  
8                          0                    1.698970  
9                          0                    1.602060  
10                         0                    1.522879  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate log10([FerrocytC]/[FerricytC]) using a function</span>
<span class="k">def</span> <span class="nf">funclog10_FerrocytC_FerricytC</span><span class="p">(</span><span class="n">Aobs</span><span class="p">,</span> <span class="n">Aferri</span><span class="p">,</span> <span class="n">Aferro</span><span class="p">):</span>   <span class="c1">#create the function</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate log10([FerrocytC]/[FerricytC]) = log10((Aobs - Aferri)/(Aferro - Aobs))</span>

<span class="sd">    Args:</span>
<span class="sd">        Aobs in AU = the observed signal for a mixture of ferro- and ferricyt c. The column containing the absorbances at 550 nm (in AU) in the presence of 25 to 300 Î¼M ferricyanide and 9.975 to 9.700 mM ferrocyanide.</span>
<span class="sd">        Aferri in AU = the observed signal for fully oxidized cyt c, i.e. ferricyt c. The absorbance at 550 nm (in AU) in the presence of 10 mM potassium ferricyanide.</span>
<span class="sd">        Aferro in AU = the observed signal for fully reduced cyt c, i.e. ferrocyt c. The absorbance at 550 nm (in AU) in the presence of 10 mM sodium dithionite.</span>

<span class="sd">    Returns:</span>
<span class="sd">        log10([FerrocytC]/[FerricytC])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">log10FerrocytCFerricytC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="n">Aobs</span><span class="o">-</span><span class="n">Aferri</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">Aferro</span><span class="o">-</span><span class="n">Aobs</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">log10FerrocytCFerricytC</span>

<span class="n">dfRP</span><span class="p">[</span><span class="s1">&#39;Log10([FerrocytC]/[FerricytC])&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfRP</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">funclog10_FerrocytC_FerricytC</span><span class="p">,</span>   <span class="c1">#Apply the function with arguments Aferri and Aferro (after Aobs) to our data set. Use iloc[start_index_row:(to end row), index_column] = [2:,0] to select Aobs for the data set but not for the first two rows. Store the information in a new column called &#39;Log10([FerrocytC]/[FerricytC])&#39;.</span>
                                                                   <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">dfRP</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dfRP</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>   <span class="c1">#Use iloc[index_row,index_column] to select Aferri = [0,0] and Aferro = [1,0] for the data set. </span>

<span class="nb">print</span><span class="p">(</span><span class="n">dfRP</span><span class="p">)</span>   <span class="c1">#print the DataFrame created</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    A550nm (AU)  [Ferricyanide] (mM)  [Ferrocyanide] (mM)  \
0         0.264            10.000000             0.000000   
1         0.738             0.000000             0.000000   
2         0.433             0.024938             9.975062   
3         0.374             0.049751             9.950249   
4         0.342             0.074442             9.925558   
5         0.326             0.099010             9.900990   
6         0.315             0.123457             9.876543   
7         0.307             0.147783             9.852217   
8         0.302             0.196078             9.803922   
9         0.296             0.243902             9.756098   
10        0.289             0.291262             9.708738   

    [Sodium dithionite] (mM)  Log10([FerroCN]/[FerriCN])  \
0                          0                         NaN   
1                         10                         NaN   
2                          0                    2.602060   
3                          0                    2.301030   
4                          0                    2.124939   
5                          0                    2.000000   
6                          0                    1.903090   
7                          0                    1.823909   
8                          0                    1.698970   
9                          0                    1.602060   
10                         0                    1.522879   

    Log10([FerrocytC]/[FerricytC])  
0                              NaN  
1                              NaN  
2                        -0.256413  
3                        -0.519709  
4                        -0.705601  
5                        -0.822506  
6                        -0.918770  
7                        -1.001009  
8                        -1.059703  
9                        -1.140272  
10                       -1.254306  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot the data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>   <span class="c1">#start a figure object</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfRP</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span><span class="mi">4</span><span class="p">],</span> <span class="n">dfRP</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span><span class="mi">5</span><span class="p">],</span>   <span class="c1">#plot a set of x (= Log10([FerroCN]/[FerriCN]), i.e. column 4),y (= Log10([FerrocytC]/[FerricytC]), i.e. column 5) data points, but do not include the first two rows as specified using iloc[start_index_row:(to end row), index_column] = [2:,4] and [2:,5]</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>   <span class="c1">#use a round, gray marker with size 8; use no line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>
       
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Cytochrome c&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>   <span class="c1">#title of graph</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$log10([Ferrocyanide]/[Ferricyanide]$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#X-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$log10([FerrocytC]/[FerricytC])$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#Y-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>   <span class="c1">#axis boundaries, in this case from 1 to 3 for the X-axis and -1.5 to 0 for the Y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>   <span class="c1">#show legend in lower right corner</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1">#show the figure object</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1213914af884d2420105699d5f5d73b473e04985b99871aa079778f71683b2f7.png" src="../_images/1213914af884d2420105699d5f5d73b473e04985b99871aa079778f71683b2f7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Define a line</span>
<span class="k">def</span> <span class="nf">funcline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>   <span class="c1">#create the function</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a line using slope and intercept</span>

<span class="sd">    Args:</span>
<span class="sd">        the slope, a</span>
<span class="sd">        the intercept, b</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        the line function &quot;a * x + b&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span>

<span class="c1">#Fit the data with a line</span>
<span class="n">paramsCraig</span><span class="p">,</span> <span class="n">params_covCraig</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">funcline</span><span class="p">,</span>   <span class="c1">#the line function we try to fit to the data</span>
                                         <span class="n">dfRP</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span><span class="mi">4</span><span class="p">],</span>   <span class="c1">#the x values, Log10([FerroCN]/[FerriCN]), but not the first two rows</span>
                                         <span class="n">dfRP</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span><span class="mi">5</span><span class="p">],</span>   <span class="c1">#the y values, Log10([FerrocytC]/[FerricytC]), but not the first two rows</span>
                                         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>   <span class="c1">#the starting parameters for a (=the slope) and b (=the intercept)</span>

<span class="c1">#Report the fit parameters with standard errors for the line function</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Slope, a = &quot;</span><span class="p">,</span> <span class="n">paramsCraig</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;Â±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covCraig</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Intercept, b = &quot;</span><span class="p">,</span> <span class="n">paramsCraig</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;Â±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covCraig</span><span class="p">))[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Slope, a =  0.9092069993196864 Â± 0.02311791055989715
Intercept, b =  -2.6290200322892794 Â± 0.04578505242299154
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate the residuals</span>
<span class="n">resid</span> <span class="o">=</span> <span class="n">dfRP</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="n">funcline</span><span class="p">(</span><span class="n">dfRP</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span><span class="mi">4</span><span class="p">],</span> <span class="o">*</span><span class="n">paramsCraig</span><span class="p">)</span>   <span class="c1">#calculate the residuals, the star in _*paramsCraig_ unpacks the array so the two optimized parameter values become the second and third arguments (after the x-values) to the function</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Generate X-values to calculate the function</span>
<span class="n">xvalues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>   <span class="c1">#create an array with 100 evenly distributed elements between 0 (included) and 3 (included)</span>

<span class="c1">#Produce a combined graph</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>   <span class="c1">#to create a figure object</span>

<span class="n">xlimits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>   <span class="c1">#to make sure we use the same of the X-axis boundaries for both plots</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.81</span><span class="p">])</span>   <span class="c1">#to specify the coordinates, width and height of the top plot</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>   <span class="c1">#to specify the coordinates, width and height of the bottom plot</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfRP</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span><span class="mi">4</span><span class="p">],</span> <span class="n">dfRP</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span><span class="mi">5</span><span class="p">],</span>   <span class="c1">#plot a set of x (= Log10([FerroCN]/[FerriCN]), i.e. column 4),y (= Log10([FerrocytC]/[FerricytC]), i.e. column 5) data points, but do not include the first two rows as specified using iloc[start_index_row:(to end row), index_column] = [2:,4] and [2:,5]</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>   <span class="c1">#use a round, gray marker with size 8; use no line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvalues</span><span class="p">,</span> <span class="n">funcline</span><span class="p">(</span><span class="n">xvalues</span><span class="p">,</span> <span class="o">*</span><span class="n">paramsCraig</span><span class="p">),</span>   <span class="c1">#add the fitted line to plot. Use the generated Log10([FerroCN]/[FerriCN] array as x-values. Use the fitted parameters to calculate the y-values. The star in _*paramsCraig_ unpacks the array so the two optimized parameter values become the second and third arguments (after the x-values) to the function.</span>
         <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>   <span class="c1">#use a gray line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">xlimits</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>   <span class="c1">#sets the X-axis and Y-axis boundaries for the top plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>   <span class="c1">#removes the ticks and tick labels on the X-axis for the top plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$log10([FerrocytC]/[FerricytC])$&#39;</span><span class="p">)</span>   <span class="c1">#adds Y-axis title for the top plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>   <span class="c1">#include legend</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfRP</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span><span class="mi">4</span><span class="p">],</span> <span class="n">resid</span><span class="p">,</span>   <span class="c1">#plot a set of x (= Log10([FerroCN]/[FerriCN]),y (= the residuals for y=ax+b) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>   <span class="c1">#use gray datapoints size 8 and no line</span>
         
<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>   <span class="c1">#adds a horizontal line at y=0</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">xlimits</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">])</span>   <span class="c1">#sets the X-axis and Y-axis boundaries for the bottom plot</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$log10([Ferrocyanide]/[Ferricyanide]$&#39;</span><span class="p">)</span>   <span class="c1">#adds X-axis title for the bottom plot, which is the same for the top plot</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Residuals&#39;</span><span class="p">)</span>   <span class="c1">#adds Y-axis title for the bottom plot</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1">#show the figure object</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6a09912d2a852ddcf82e8034c6b435833ccfed1112e90bbdf0832235b0467349.png" src="../_images/6a09912d2a852ddcf82e8034c6b435833ccfed1112e90bbdf0832235b0467349.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Define the function</span>
<span class="k">def</span> <span class="nf">funcmidredpot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">da</span><span class="p">,</span> <span class="n">db</span><span class="p">):</span>   <span class="c1">#create the function</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the midpoint redox potential with uncertainty</span>

<span class="sd">    Args:</span>
<span class="sd">        the slope, a</span>
<span class="sd">        the standard deviation of the slope, da</span>
<span class="sd">        the intercept, b</span>
<span class="sd">        the standard deviation of the intercept, db</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        the midpoint redox potential </span>
<span class="sd">        the uncertainty of the midpoint redox potential, using error propagation rules</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rp</span> <span class="o">=</span> <span class="mf">0.430</span> <span class="o">-</span> <span class="mf">0.059</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span>
    <span class="n">drp</span> <span class="o">=</span> <span class="mf">0.059</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">db</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">da</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">4</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">rp</span><span class="p">,</span> <span class="n">drp</span>

<span class="c1">#Apply the function</span>
<span class="n">midredpot</span> <span class="o">=</span> <span class="n">funcmidredpot</span><span class="p">(</span><span class="o">*</span><span class="n">paramsCraig</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covCraig</span><span class="p">)))</span>    <span class="c1">#Use the fitted parameters with standard deviations (the stars unpack both arrays) as arguments for the function. </span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The midpoint redox potential of cytochrome c is&quot;</span><span class="p">,</span> <span class="n">midredpot</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;+/-&quot;</span><span class="p">,</span> <span class="n">midredpot</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;V. The uncertainty is one standard deviation and is derived from the errors on the fit.&quot;</span><span class="p">)</span>   <span class="c1">#Print the result of the experiment.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The midpoint redox potential of cytochrome c is 0.2593983856029154 +/- 0.005257729412117667 V. The uncertainty is one standard deviation and is derived from the errors on the fit.
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="chemical-unfolding">
<h1>Chemical unfolding<a class="headerlink" href="#chemical-unfolding" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Import the libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Read the Excel file</span>
<span class="n">dfCU</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span> <span class="p">(</span><span class="s1">&#39;../data/ChemicalUnfoldingAssay.xlsx&#39;</span><span class="p">,</span>   <span class="c1">#create a pandas DataFrame from the filename with file path and extension shown</span>
                    <span class="n">sheet_name</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>   <span class="c1">#use the first sheet (no need to specifically include this as we use the default setting)</span>
                    <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>   <span class="c1">#our data has column names</span>

<span class="nb">print</span><span class="p">(</span><span class="n">dfCU</span><span class="p">)</span>   <span class="c1">#print the DataFrame created</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    [GdnHCl] (M)  Îµ222nm (mdeg)
0          0.000        -14.746
1          0.198        -14.724
2          0.397        -14.746
3          0.595        -14.525
4          0.808        -14.657
5          0.965        -14.878
6          1.218        -14.635
7          1.422        -14.613
8          1.615        -14.657
9          1.855        -14.635
10         2.012        -14.525
11         2.234        -14.415
12         2.437        -14.063
13         2.709        -13.315
14         2.871        -12.677
15         3.023        -11.356
16         3.328         -8.363
17         3.498         -6.713
18         3.655         -5.568
19         3.932         -4.666
20         4.131         -4.292
21         4.232         -4.292
22         4.505         -3.873
23         4.698         -3.763
24         4.985         -3.565
25         5.100         -3.543
26         5.298         -3.433
27         5.478         -3.345
28         5.742         -3.191
29         5.919         -3.081
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot the data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>   <span class="c1">#start a figure object</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfCU</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dfCU</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>   <span class="c1">#plot a set of x (= [GdnHCl], i.e. column 1),y (= epsilon), i.e. column 2) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>   <span class="c1">#use a round, gray marker with size 8; use no line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>
       
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Chemical unfolding&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>   <span class="c1">#title of graph</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$[GdnHCl] (M)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#X-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\epsilon_</span><span class="si">{222nm}</span><span class="s1"> (mdeg)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#Y-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">])</span>   <span class="c1">#axis boundaries, in this case from -0.1 to 6.5 for the X-axis and -15.5 to -2.5 for the Y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>   <span class="c1">#show legend in lower right corner</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1">#show the figure object</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:10: SyntaxWarning: invalid escape sequence &#39;\e&#39;
&lt;&gt;:10: SyntaxWarning: invalid escape sequence &#39;\e&#39;
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\2615624514.py:10: SyntaxWarning: invalid escape sequence &#39;\e&#39;
  plt.ylabel(&#39;$\epsilon_{222nm} (mdeg)$&#39;, fontsize=14)   #Y-axis label
</pre></div>
</div>
<img alt="../_images/ae927039b25287580dc25f8c61ba4c767ea9e257f027a85052382dd5a26f4cfb.png" src="../_images/ae927039b25287580dc25f8c61ba4c767ea9e257f027a85052382dd5a26f4cfb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Define the temperature</span>
<span class="n">temp</span> <span class="o">=</span> <span class="mi">20</span>

<span class="c1">#Define the chemical unfolding function</span>
<span class="k">def</span> <span class="nf">chemicalunfolding</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">yn</span><span class="p">,</span> <span class="n">mn</span><span class="p">,</span> <span class="n">yu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">DGu</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">yn</span> <span class="o">+</span> <span class="n">mn</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">yu</span> <span class="o">+</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">DGu</span> <span class="o">+</span> <span class="n">m</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">8.314</span> <span class="o">*</span> <span class="p">(</span><span class="mf">273.15</span> <span class="o">+</span> <span class="n">temp</span><span class="p">)))))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">DGu</span> <span class="o">+</span> <span class="n">m</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">8.314</span> <span class="o">*</span> <span class="p">(</span><span class="mf">273.15</span> <span class="o">+</span> <span class="n">temp</span><span class="p">)))))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Create a list of GdnHCl concentrations as input for the function</span>
<span class="n">GdnHClin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1">#Test the initial guesses for the fitting parameters</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>   <span class="c1">#start a figure object</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfCU</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dfCU</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>   <span class="c1">#plot a set of x (= [GdnHCl], i.e. column 1),y (= epsilon), i.e. column 2) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>   <span class="c1">#use a round, gray marker with size 8; use no line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">GdnHClin</span><span class="p">,</span> <span class="n">chemicalunfolding</span><span class="p">(</span><span class="n">GdnHClin</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">20000</span><span class="p">,</span> <span class="o">-</span><span class="mi">5000</span><span class="p">),</span> <span class="c1">#Test my guesses for the initial parameters. Use the generated GdnHCl array between 0 and 10 as x-values.</span>
         <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span>   <span class="c1">#use red, solid line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Guesses&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>
         
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Chemical unfolding&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>   <span class="c1">#title of graph</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$[GdnHCl] (M)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#X-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\epsilon_</span><span class="si">{222nm}</span><span class="s1"> (mdeg)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#Y-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">])</span>   <span class="c1">#axis boundaries, in this case from -0.1 to 6.5 for the X-axis and -15.5 to -2.5 for the Y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>   <span class="c1">#show legend in lower right corner</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1">#show the figure object</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:17: SyntaxWarning: invalid escape sequence &#39;\e&#39;
&lt;&gt;:17: SyntaxWarning: invalid escape sequence &#39;\e&#39;
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\3035427264.py:17: SyntaxWarning: invalid escape sequence &#39;\e&#39;
  plt.ylabel(&#39;$\epsilon_{222nm} (mdeg)$&#39;, fontsize=14)   #Y-axis label
</pre></div>
</div>
<img alt="../_images/4b4c976dfb0a4034e4333cf4566735ebcbbf113408d11a80228b5911bf8c9be8.png" src="../_images/4b4c976dfb0a4034e4333cf4566735ebcbbf113408d11a80228b5911bf8c9be8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Fit the data with the chemical unfolding curve</span>
<span class="n">paramsCU</span><span class="p">,</span> <span class="n">params_covCU</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">chemicalunfolding</span><span class="p">,</span>   <span class="c1">#the line function we try to fit to the data</span>
                                          <span class="n">dfCU</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>   <span class="c1">#the x values</span>
                                          <span class="n">dfCU</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>   <span class="c1">#the y values</span>
                                          <span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">20000</span><span class="p">,</span> <span class="o">-</span><span class="mi">5000</span><span class="p">])</span> <span class="c1">#my guesses for the initial parameters</span>

<span class="c1">#Report the fit parameters with standard errors for the line function</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Yn = &quot;</span><span class="p">,</span> <span class="n">paramsCU</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;Â±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covCU</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Yu = &quot;</span><span class="p">,</span> <span class="n">paramsCU</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;Â±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covCU</span><span class="p">))[</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mn = &quot;</span><span class="p">,</span> <span class="n">paramsCU</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;Â±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covCU</span><span class="p">))[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mu = &quot;</span><span class="p">,</span> <span class="n">paramsCU</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;Â±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covCU</span><span class="p">))[</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DGu = &quot;</span><span class="p">,</span> <span class="n">paramsCU</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;Â±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covCU</span><span class="p">))[</span><span class="mi">4</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m = &quot;</span><span class="p">,</span> <span class="n">paramsCU</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="s2">&quot;Â±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covCU</span><span class="p">))[</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Yn =  -14.752468337068821 Â± 0.045346805669152904
Yu =  -6.30234970924443 Â± 0.2502534953583287
mn =  0.08365002494085823 Â± 0.03513344022643853
mu =  0.5425704214074223 Â± 0.049048047815214345
DGu =  32338.784334711927 Â± 823.0157211433537
m =  -10079.733839632392 Â± 257.13568891470453
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate the residuals</span>
<span class="n">resid</span> <span class="o">=</span> <span class="n">dfCU</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">chemicalunfolding</span><span class="p">(</span><span class="n">dfCU</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="o">*</span><span class="n">paramsCU</span><span class="p">)</span>   <span class="c1">#calculate the residuals, the star in _*paramsCU_ unpacks the array so the optimized parameter values become the arguments (after the x-values) to the function</span>

<span class="c1">#Produce a combined graph</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>   <span class="c1">#to create a figure object</span>

<span class="n">xlimits</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">6.1</span><span class="p">]</span>   <span class="c1">#to make sure we use the same of the X-axis boundaries for both plots</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.81</span><span class="p">])</span>   <span class="c1">#to specify the coordinates, width and height of the top plot</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>   <span class="c1">#to specify the coordinates, width and height of the bottom plot</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfCU</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dfCU</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>   <span class="c1">#plot a set of x (= [GdnHCl], i.e. column 1),y (= epsilon), i.e. column 2) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>   <span class="c1">#use a round, gray marker with size 8; use no line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">GdnHClin</span><span class="p">,</span> <span class="n">chemicalunfolding</span><span class="p">(</span><span class="n">GdnHClin</span><span class="p">,</span> <span class="o">*</span><span class="n">paramsCU</span><span class="p">),</span>   <span class="c1">#Add the fitted line to plot. Use the generated GdnHCl array between 0 and 10 as x-values. Use the fitted parameters to calculate the y-values. The star in _*paramsCU_ unpacks the array so the optimized parameter values become the arguments (after the x-values) to the function.</span>
         <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>   <span class="c1">#use a gray, solid line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">xlimits</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mf">15.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">])</span>   <span class="c1">#sets the X-axis and Y-axis boundaries for the top plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>   <span class="c1">#removes the ticks and tick labels on the X-axis for the top plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\epsilon_</span><span class="si">{222nm}</span><span class="s1"> (mdeg)$&#39;</span><span class="p">)</span>   <span class="c1">#adds Y-axis title for the top plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>   <span class="c1">#include legend</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfCU</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">resid</span><span class="p">,</span>   <span class="c1">#plot a set of x (= [GdnHCl]),y (= the residuals) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>   <span class="c1">#use gray datapoints size 8 and no line</span>
         
<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>   <span class="c1">#adds a horizontal line at y=0</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">xlimits</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="p">])</span>   <span class="c1">#sets the X-axis and Y-axis boundaries (needs some trial and error to find the right ones!) for the bottom plot</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$[GdnHCl] (M)$&#39;</span><span class="p">)</span>   <span class="c1">#adds X-axis title for the bottom plot, which is the same for the top plot</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Residuals&#39;</span><span class="p">)</span>   <span class="c1">#adds Y-axis title for the bottom plot</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1">#show the figure object</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:23: SyntaxWarning: invalid escape sequence &#39;\e&#39;
&lt;&gt;:23: SyntaxWarning: invalid escape sequence &#39;\e&#39;
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\1257317264.py:23: SyntaxWarning: invalid escape sequence &#39;\e&#39;
  ax1.set_ylabel(&#39;$\epsilon_{222nm} (mdeg)$&#39;)   #adds Y-axis title for the top plot
</pre></div>
</div>
<img alt="../_images/5e028bebb9e6ddde6502e0dddaed68b0fa1a58ec4ea23e1c71b9abd7e2e2b4fa.png" src="../_images/5e028bebb9e6ddde6502e0dddaed68b0fa1a58ec4ea23e1c71b9abd7e2e2b4fa.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="michaelis-menten-curve">
<h1>Michaelis-Menten curve<a class="headerlink" href="#michaelis-menten-curve" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Import the libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Read the Excel file</span>
<span class="n">dfEK</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span> <span class="p">(</span><span class="s1">&#39;../data/EnzymeKineticsAssay.xlsx&#39;</span><span class="p">,</span>   <span class="c1">#create a pandas DataFrame from the filename with file path and extension shown</span>
                    <span class="n">sheet_name</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>   <span class="c1">#use the first sheet (no need to specifically include this as we use the default setting)</span>
                    <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>   <span class="c1">#our data has column names</span>

<span class="nb">print</span><span class="p">(</span><span class="n">dfEK</span><span class="p">)</span>   <span class="c1">#print the DataFrame created</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    [S]0 (ÂµM)  v0 (mM s-1)
0         0.0    -0.024261
1         2.5     0.281586
2         5.0     0.503380
3        10.0     0.882312
4        20.0     1.528808
5        40.0     1.963921
6        80.0     2.322012
7       160.0     2.426638
8       320.0     2.783801
9       640.0     2.874228
10     1280.0     2.734735
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot the data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>   <span class="c1">#start a figure object</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfEK</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dfEK</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>   <span class="c1">#plot a set of x (= [S]0, i.e. column 1),y (= V0), i.e. column 2) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>   <span class="c1">#use a round, gray marker with size 8; use no line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>
       
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Michaelis-Menten curve&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>   <span class="c1">#title of graph</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$[S]_0$ in $\mu$$M$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#X-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$v_0$ in $mM s^{-1}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#Y-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1300</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>   <span class="c1">#axis boundaries, in this case from -0.1 to 1300 for the X-axis and -0.05 to 3 for the Y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>   <span class="c1">#show legend in lower right corner</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1">#show the figure object</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:9: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:9: SyntaxWarning: invalid escape sequence &#39;\m&#39;
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\55317108.py:9: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.xlabel(&#39;$[S]_0$ in $\mu$$M$&#39;, fontsize=14)   #X-axis label
</pre></div>
</div>
<img alt="../_images/dc466793a35ecbbb8c638d9e98d9e128a929c15d0ff49d071c83ceee5435feda.png" src="../_images/dc466793a35ecbbb8c638d9e98d9e128a929c15d0ff49d071c83ceee5435feda.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Define the Michaelis-Menten function</span>
<span class="k">def</span> <span class="nf">MichaelisMentenF</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Km</span><span class="p">,</span> <span class="n">Vmax</span><span class="p">)</span> <span class="p">:</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">Vmax</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Km</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Create a list of substrate concentrations as input for the function</span>
<span class="n">Sin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="c1">#Test the initial guesses for the fitting parameters</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>   <span class="c1">#start a figure object</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfEK</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dfEK</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>   <span class="c1">#plot a set of x (= [GdnHCl], i.e. column 1),y (= Î¸), i.e. column 2) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>   <span class="c1">#use a round, gray marker with size 8; use no line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Sin</span><span class="p">,</span> <span class="n">MichaelisMentenF</span><span class="p">(</span><span class="n">Sin</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">2.8</span><span class="p">),</span> <span class="c1">#Test my guesses for the initial parameters. Use the generated [S]0 array between 0 and 1500 as x-values.</span>
         <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span>   <span class="c1">#use red, solid line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Guesses&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>
         
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Michaelis-Menten curve&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>   <span class="c1">#title of graph</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$[S]_0$ in $\mu$$M$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#X-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$v_0$ in $mM s^{-1}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#Y-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1300</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>   <span class="c1">#axis boundaries, in this case from -0.1 to 1300 for the X-axis and -0.05 to 3 for the Y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>   <span class="c1">#show legend in lower right corner</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1">#show the figure object</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:16: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:16: SyntaxWarning: invalid escape sequence &#39;\m&#39;
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\342232315.py:16: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.xlabel(&#39;$[S]_0$ in $\mu$$M$&#39;, fontsize=14)   #X-axis label
</pre></div>
</div>
<img alt="../_images/c0bfd4251e1358b0f76478c22184c1e36ad1ccd85ac533404ae19560ca1f6fe0.png" src="../_images/c0bfd4251e1358b0f76478c22184c1e36ad1ccd85ac533404ae19560ca1f6fe0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Fit the data with the chemical unfolding curve</span>
<span class="n">paramsEK</span><span class="p">,</span> <span class="n">params_covEK</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">MichaelisMentenF</span><span class="p">,</span>   <span class="c1">#the line function we try to fit to the data</span>
                                          <span class="n">dfEK</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>   <span class="c1">#the x values</span>
                                          <span class="n">dfEK</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>   <span class="c1">#the y values</span>
                                          <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mf">2.8</span><span class="p">])</span> <span class="c1">#my guesses for the initial parameters</span>

<span class="c1">#Report the fit parameters with standard errors for the line function</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Km = &quot;</span><span class="p">,</span> <span class="n">paramsEK</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;Â±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covEK</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Vmax = &quot;</span><span class="p">,</span> <span class="n">paramsEK</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;Â±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covEK</span><span class="p">))[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Km =  20.116403196685493 Â± 1.5716578691778114
Vmax =  2.877072644358705 Â± 0.048488907316231296
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate the residuals</span>
<span class="n">resid</span> <span class="o">=</span> <span class="n">dfEK</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">MichaelisMentenF</span><span class="p">(</span><span class="n">dfEK</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="o">*</span><span class="n">paramsEK</span><span class="p">)</span>   <span class="c1">#calculate the residuals, the star in _*paramsEK_ unpacks the array so the optimized parameter values become the arguments (after the x-values) to the function</span>

<span class="c1">#Produce a combined graph</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>   <span class="c1">#to create a figure object</span>

<span class="n">xlimits</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1300</span><span class="p">]</span>   <span class="c1">#to make sure we use the same of the X-axis boundaries for both plots</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.81</span><span class="p">])</span>   <span class="c1">#to specify the coordinates, width and height of the top plot</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>   <span class="c1">#to specify the coordinates, width and height of the bottom plot</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfEK</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dfEK</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>   <span class="c1">#plot a set of x (= [S]0, i.e. column 1),y (= V0), i.e. column 2) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>   <span class="c1">#use a round, gray marker with size 8; use no line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Sin</span><span class="p">,</span> <span class="n">MichaelisMentenF</span><span class="p">(</span><span class="n">Sin</span><span class="p">,</span> <span class="o">*</span><span class="n">paramsEK</span><span class="p">),</span>   <span class="c1">#Add the fitted line to plot. Use the generated [S]0 array between 0 and 1500 as x-values. Use the fitted parameters to calculate the y-values. The star in _*paramsEK_ unpacks the array so the optimized parameter values become the arguments (after the x-values) to the function.</span>
         <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>   <span class="c1">#use a gray, solid line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span><span class="p">)</span>   <span class="c1">#add a legend label</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">xlimits</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>   <span class="c1">#sets the X-axis and Y-axis boundaries for the top plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>   <span class="c1">#removes the ticks and tick labels on the X-axis for the top plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$v_0$ in $mM s^{-1}$&#39;</span><span class="p">)</span>   <span class="c1">#adds Y-axis title for the top plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>   <span class="c1">#include legend</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfEK</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">resid</span><span class="p">,</span>   <span class="c1">#plot a set of x (= [S]0),y (= the residuals) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>   <span class="c1">#use gray datapoints size 8 and no line</span>
         
<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>   <span class="c1">#adds a horizontal line at y=0</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">xlimits</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="p">])</span>   <span class="c1">#sets the X-axis and Y-axis boundaries (needs some trial and error to find the right ones!) for the bottom plot</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$[S]_0$ in $\mu$$M$&#39;</span><span class="p">)</span>   <span class="c1">#adds X-axis title for the bottom plot, which is the same for the top plot</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Residuals&#39;</span><span class="p">)</span>   <span class="c1">#adds Y-axis title for the bottom plot</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1">#show the figure object</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:31: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:31: SyntaxWarning: invalid escape sequence &#39;\m&#39;
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\3313014866.py:31: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  ax2.set_xlabel(&#39;$[S]_0$ in $\mu$$M$&#39;)   #adds X-axis title for the bottom plot, which is the same for the top plot
</pre></div>
</div>
<img alt="../_images/d6ba924ef33a1065b3ef0a2db348a2817323d89076873af1d1a853185e823aad.png" src="../_images/d6ba924ef33a1065b3ef0a2db348a2817323d89076873af1d1a853185e823aad.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="thermal-shift-assay">
<h1>Thermal shift assay<a class="headerlink" href="#thermal-shift-assay" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Import the libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
<span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="kn">import</span> <span class="n">uniform_filter1d</span> <span class="c1"># to smoothen data, see the tip below</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">savgol_filter</span> <span class="c1"># to smoothen data, see the tip below</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Read the Excel file</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/ThermalShiftAssay.txt&#39;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="c1"># We use pd.read_csv to read in the file and store the information in a new dataframe, i.e. df.</span>
<span class="c1"># We use skiprows=1 to skip the first row.</span>
<span class="c1"># We use sep=&#39;\t&#39; to specify that we have a tab-delimited text format.</span>
<span class="c1"># We use usecols=[0, 1, 6, 7] to only read in columns 1, 2, 7, and 8.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      SamplePos  SampleName   Temp  465-580
0            A1  T4L wt 8uM  20.01     6.94
1            A1  T4L wt 8uM  20.01     6.99
2            A1  T4L wt 8uM  20.16     6.97
3            A1  T4L wt 8uM  20.32     7.00
4            A1  T4L wt 8uM  20.40     6.96
...         ...         ...    ...      ...
61915       H12       Empty  84.47     4.32
61916       H12       Empty  84.59     4.35
61917       H12       Empty  84.67     4.34
61918       H12       Empty  84.76     4.35
61919       H12       Empty  84.88     4.33

[61920 rows x 4 columns]
</pre></div>
</div>
</div>
</div>
<section id="for-well-a1">
<h2>For well A1<a class="headerlink" href="#for-well-a1" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Select data for A1</span>
<span class="n">dfa1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SamplePos&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;A1&#39;</span><span class="p">]</span>
<span class="c1"># We select all rows that contain A1 as sample position and store them in a new dataframe, i.e. dfa1.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dfa1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    SamplePos  SampleName   Temp  465-580
0          A1  T4L wt 8uM  20.01     6.94
1          A1  T4L wt 8uM  20.01     6.99
2          A1  T4L wt 8uM  20.16     6.97
3          A1  T4L wt 8uM  20.32     7.00
4          A1  T4L wt 8uM  20.40     6.96
..        ...         ...    ...      ...
640        A1  T4L wt 8uM  84.47    78.21
641        A1  T4L wt 8uM  84.59    77.87
642        A1  T4L wt 8uM  84.67    77.57
643        A1  T4L wt 8uM  84.76    77.29
644        A1  T4L wt 8uM  84.88    76.92

[645 rows x 4 columns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot â€œfluorescence versus temperature data from well A1</span>
<span class="n">xdfa1</span><span class="o">=</span><span class="n">dfa1</span><span class="p">[</span><span class="s1">&#39;Temp&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">273.15</span>
<span class="c1"># We select the temperature = x and convert it from Â°C to Â°K, the result is stored in a new dataframe, i.e. xdfa1.</span>

<span class="n">ydfa1</span><span class="o">=</span><span class="n">dfa1</span><span class="p">[</span><span class="s1">&#39;465-580&#39;</span><span class="p">]</span>
<span class="c1"># We select the fluorescence signal = y, the result is stored in a new dataframe, i.e. ydfa1.</span>

<span class="c1"># We now plot the graph &quot;fluorescence signal&quot; versus &quot;temperature&quot;.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Thermal Shift Assay&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;T (Â°K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fluorescence (AU)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/41a9850af7b45c05d3e4b8e1144b0cbcf114ccf15c1f38bcde99cb7e5d518fc1.png" src="../_images/41a9850af7b45c05d3e4b8e1144b0cbcf114ccf15c1f38bcde99cb7e5d518fc1.png" />
</div>
</div>
<section id="analysis-1-first-derivative-method">
<h3>Analysis 1: First derivative method<a class="headerlink" href="#analysis-1-first-derivative-method" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Investigate the difference between a Pandas series and Numpy array</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[293.16 293.16 293.31 293.47 293.55 293.69 293.84 293.92 294.08 294.08
 294.23 294.31 294.38 294.52 294.6  294.68 294.83 294.91 295.05 295.12
 295.19 295.34 295.41 295.49 295.56 295.7  295.84 295.91 295.98 296.05
 296.2  296.27 296.34 296.49 296.56 296.68 296.75 296.83 296.96 297.03
 297.18 297.24 297.31 297.44 297.51 297.58 297.71 297.78 297.92 298.05
 298.11 298.18 298.38 298.44 298.51 298.64 298.71 298.83 298.9  299.02
 299.16 299.22 299.35 299.48 299.55 299.6  299.79 299.92 299.98 300.1
 300.17 300.3  300.41 300.48 300.54 300.66 300.78 300.91 301.03 301.09
 301.2  301.32 301.45 301.51 301.63 301.68 301.8  301.92 302.03 302.1
 302.15 302.33 302.45 302.51 302.55 302.68 302.85 302.91 303.03 303.08
 303.2  303.36 303.47 303.59 303.59 303.7  303.81 303.92 304.02 304.14
 304.25 304.36 304.42 304.53 304.64 304.74 304.85 304.96 305.07 305.12
 305.28 305.39 305.45 305.54 305.65 305.76 305.87 305.92 306.02 306.13
 306.22 306.34 306.44 306.54 306.64 306.75 306.85 306.94 307.05 307.15
 307.25 307.36 307.46 307.56 307.62 307.71 307.85 307.96 308.06 308.16
 308.26 308.36 308.49 308.55 308.65 308.74 308.85 308.99 309.04 309.14
 309.23 309.32 309.47 309.56 309.66 309.76 309.85 309.98 310.08 310.17
 310.27 310.37 310.5  310.6  310.64 310.78 310.87 310.97 311.1  311.2
 311.29 311.37 311.47 311.6  311.69 311.79 311.88 311.96 312.06 312.14
 312.27 312.41 312.5  312.59 312.68 312.81 312.89 312.98 313.11 313.2
 313.29 313.37 313.47 313.59 313.67 313.81 313.89 313.98 314.11 314.2
 314.28 314.4  314.53 314.61 314.7  314.79 314.91 315.   315.12 315.2
 315.32 315.41 315.54 315.62 315.71 315.78 315.9  315.99 316.11 316.19
 316.32 316.4  316.48 316.64 316.72 316.84 316.92 317.   317.12 317.24
 317.32 317.44 317.51 317.64 317.76 317.83 317.92 318.03 318.14 318.23
 318.34 318.42 318.47 318.62 318.72 318.81 318.92 319.   319.16 319.23
 319.31 319.43 319.53 319.65 319.73 319.84 319.96 320.04 320.15 320.21
 320.33 320.44 320.52 320.67 320.74 320.83 320.93 321.04 321.15 321.26
 321.37 321.49 321.56 321.66 321.74 321.85 321.95 322.03 322.14 322.25
 322.37 322.46 322.57 322.64 322.75 322.87 322.97 323.04 323.15 323.25
 323.36 323.47 323.58 323.69 323.79 323.89 323.96 324.07 324.17 324.28
 324.35 324.49 324.57 324.66 324.77 324.87 324.98 325.08 325.19 325.26
 325.39 325.49 325.6  325.7  325.81 325.91 325.98 326.11 326.18 326.31
 326.39 326.49 326.59 326.7  326.79 326.92 327.02 327.13 327.19 327.33
 327.37 327.5  327.59 327.73 327.79 327.93 328.03 328.13 328.2  328.29
 328.39 328.49 328.59 328.72 328.79 328.92 329.02 329.11 329.21 329.31
 329.41 329.54 329.64 329.73 329.83 329.92 330.05 330.12 330.22 330.32
 330.41 330.51 330.6  330.73 330.83 330.93 331.02 331.12 331.22 331.3
 331.41 331.53 331.62 331.73 331.82 331.95 332.03 332.16 332.23 332.35
 332.42 332.54 332.64 332.73 332.85 332.95 333.05 333.14 333.23 333.32
 333.43 333.54 333.63 333.76 333.85 333.98 334.08 334.17 334.25 334.35
 334.44 334.56 334.66 334.75 334.87 334.96 335.06 335.18 335.24 335.34
 335.46 335.55 335.65 335.76 335.85 335.98 336.07 336.16 336.22 336.34
 336.45 336.55 336.67 336.76 336.86 336.98 337.04 337.16 337.25 337.36
 337.49 337.58 337.67 337.8  337.88 337.96 338.08 338.18 338.27 338.39
 338.45 338.57 338.68 338.78 338.89 338.98 339.08 339.2  339.28 339.4
 339.49 339.61 339.7  339.79 339.88 339.97 340.06 340.2  340.29 340.41
 340.5  340.59 340.68 340.8  340.88 341.   341.12 341.21 341.3  341.42
 341.51 341.59 341.7  341.8  341.92 342.   342.13 342.21 342.29 342.41
 342.53 342.62 342.71 342.83 342.91 343.03 343.11 343.23 343.32 343.44
 343.53 343.59 343.71 343.81 343.94 344.02 344.14 344.23 344.32 344.43
 344.49 344.6  344.75 344.84 344.93 345.07 345.14 345.24 345.33 345.42
 345.54 345.65 345.75 345.86 345.95 346.03 346.15 346.23 346.33 346.44
 346.53 346.65 346.72 346.84 346.96 347.05 347.16 347.23 347.37 347.45
 347.57 347.66 347.77 347.84 347.95 348.04 348.13 348.24 348.35 348.47
 348.56 348.67 348.77 348.88 348.96 349.05 349.17 349.28 349.4  349.46
 349.58 349.66 349.77 349.86 349.98 350.07 350.15 350.28 350.36 350.47
 350.59 350.68 350.76 350.86 350.97 351.1  351.17 351.29 351.4  351.5
 351.58 351.7  351.79 351.87 351.95 352.11 352.19 352.31 352.4  352.49
 352.57 352.66 352.8  352.93 353.01 353.13 353.22 353.31 353.42 353.51
 353.6  353.71 353.81 353.92 354.01 354.12 354.21 354.3  354.41 354.51
 354.6  354.71 354.8  354.91 355.03 355.1  355.21 355.3  355.4  355.51
 355.59 355.71 355.8  355.92 356.01 356.1  356.22 356.31 356.42 356.51
 356.63 356.72 356.81 356.94 357.01 357.13 357.2  357.32 357.43 357.53
 357.62 357.74 357.82 357.91 358.03]
0      293.16
1      293.16
2      293.31
3      293.47
4      293.55
        ...  
640    357.62
641    357.74
642    357.82
643    357.91
644    358.03
Name: Temp, Length: 645, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate the approximate first derivative</span>
<span class="n">outa1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ydfa1</span><span class="p">))</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<span class="n">derya1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ydfa1</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">)),</span> <span class="n">out</span><span class="o">=</span><span class="n">outa1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">))</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># The np.diff function calculates the n-th discrete difference. When n = 1 (default), np.diff calculates the difference between subsequent elements in our array, and returns an array that is one element shorter. </span>
<span class="c1"># The np.divide function returns a division of the inputs. To prevent division by zero, we can take advantage of the &quot;where&quot; option.</span>
<span class="c1"># We pre-initialize the output &#39;outa1&#39; that we will use when the &quot;divide by zero encountered&quot; error happens. The input of &#39;out=&#39; needs to be an array.</span>
<span class="c1"># To create the array &#39;outa1&#39;, we use the np.ones function which returns an array of given shape (i.e. n-1 data points, the &#39;len()&#39; function gives us n) and type, filled with ones.</span>

<span class="n">derxa1</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="mi">2</span>
<span class="c1"># The derivative is of size n-1, and is evaluated at the midpoints. The x data for the derivative can be calculated via (all but the last elements of x (represented by x[:-1]) + all but the first element of x (represented by x[1:])) / 2.</span>

<span class="c1"># We now plot the graph &quot;fluorescence signal&quot; versus &quot;temperature&quot; and add the calculated first derivative to it.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">derxa1</span><span class="p">,</span> <span class="n">derya1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Thermal Shift Assay&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;T (Â°K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fluorescence (AU)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3f86bb8ba09e1cec8529eeca74646d68374ec5705445c6491c61747a33bad886.png" src="../_images/3f86bb8ba09e1cec8529eeca74646d68374ec5705445c6491c61747a33bad886.png" />
</div>
</div>
<section id="tip-make-a-plot-with-a-secondary-y-axis">
<h4>Tip: Make a plot with a secondary Y-axis<a class="headerlink" href="#tip-make-a-plot-with-a-secondary-y-axis" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Create a plot with a secondary Y-axis</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="c1"># create figure and axis objects with subplots()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="c1"># make a plot</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;T (Â°K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Fluorescence (AU)&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1"># set x- and y-axis labels</span>

<span class="n">ax2</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="c1"># instantiate a second axes that shares the same x-axis</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">derxa1</span><span class="p">,</span> <span class="n">derya1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="c1"># make a plot with different y-axis using second axis object</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;First derivative&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1"># set y-axis label for the second axis object</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1cfac6e1c019f346e5c3d7da60923aa6389f306dba1f16a1cf79ccdbd8391967.png" src="../_images/1cfac6e1c019f346e5c3d7da60923aa6389f306dba1f16a1cf79ccdbd8391967.png" />
</div>
</div>
</section>
<section id="tip-smoothen-a-curve">
<h4>Tip: Smoothen a curve<a class="headerlink" href="#tip-smoothen-a-curve" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#See the difference between a moving average filter and a Savitzky-Golay filter</span>
<span class="n">xtestsmooth</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>
<span class="n">ytestsmooth</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xtestsmooth</span><span class="p">,</span> <span class="n">ytestsmooth</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xtestsmooth</span><span class="p">,</span> <span class="n">uniform_filter1d</span><span class="p">(</span><span class="n">ytestsmooth</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Moving average&#39;</span><span class="p">)</span> <span class="c1"># length of filter is 3</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xtestsmooth</span><span class="p">,</span> <span class="n">savgol_filter</span><span class="p">(</span><span class="n">ytestsmooth</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Savitzky-Golay&#39;</span><span class="p">)</span> <span class="c1"># window size is 5, polynomial order is 3</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Smoothing&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/14a39572fa3aff88c708718a319554a5c8da9afd338d6815ba78dcae2d8b513e.png" src="../_images/14a39572fa3aff88c708718a319554a5c8da9afd338d6815ba78dcae2d8b513e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Smoothen data with Savitzky-Golay filter</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;T (Â°K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Fluorescence (AU)&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">derxa1</span><span class="p">,</span> <span class="n">savgol_filter</span><span class="p">(</span><span class="n">derya1</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;First derivative&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/57639e9166cd0f040f1c21efb1803be5fde6d59dc43955edfbdb2467aed45197.png" src="../_images/57639e9166cd0f040f1c21efb1803be5fde6d59dc43955edfbdb2467aed45197.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate the maximum of the first derivative and its corresponding x-value, i.e. the Tm </span>
<span class="n">max_derya1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">derya1</span><span class="p">)</span>
<span class="c1"># find the maximum y value</span>

<span class="n">max_derxa1</span> <span class="o">=</span> <span class="n">derxa1</span><span class="p">[</span><span class="n">derya1</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span> 
<span class="c1"># find the x value corresponding to the maximum y value</span>

<span class="nb">print</span><span class="p">(</span><span class="n">max_derxa1</span><span class="p">,</span> <span class="n">max_derya1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>334.21 36.62499999998117
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="analysis-2-curve-fitting-using-a-boltzmann-model">
<h3>Analysis 2: Curve fitting using a Boltzmann model<a class="headerlink" href="#analysis-2-curve-fitting-using-a-boltzmann-model" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Define the Boltzmann function to fit the data</span>
<span class="k">def</span> <span class="nf">funcBoltzmann</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Ymin</span><span class="p">,</span> <span class="n">Ymax</span><span class="p">,</span> <span class="n">Tm</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">Ymin</span> <span class="o">+</span> <span class="p">((</span><span class="n">Ymax</span><span class="p">)</span> <span class="o">-</span> <span class="n">Ymin</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">Tm</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">a</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We plot our curve with initial guesses for the parameters onto the data. Change these guesses if needed.</span>
<span class="c1"># Note that we first create a list of temperatures as input for our function using the numpy.linspace command.</span>

<span class="n">xin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">290</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="n">funcBoltzmann</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">333</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Guess&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Thermal Shift Assay&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;T (Â°K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fluorescence (AU)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/517fc3e3118a52d3d9f8cc240b32d56b9bc1313370ad2f2770c8aacad33d9e03.png" src="../_images/517fc3e3118a52d3d9f8cc240b32d56b9bc1313370ad2f2770c8aacad33d9e03.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We fit the data.</span>
<span class="n">paramsBoltzmann</span><span class="p">,</span> <span class="n">params_covarianceBoltzmann</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">funcBoltzmann</span><span class="p">,</span> <span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span>
                                               <span class="p">[</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">333</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">maxfev</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="c1"># We print the fitted parameters.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">paramsBoltzmann</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covarianceBoltzmann</span><span class="p">)))</span>

<span class="c1"># We plot the fitted curve onto the data.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="n">funcBoltzmann</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="o">*</span><span class="n">paramsBoltzmann</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Thermal Shift Assay&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;T (Â°K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fluorescence (AU)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  8.46641251 117.38342176 332.50319245   0.96940869]
[0.72752489 0.92834356 0.10142863 0.08840673]
</pre></div>
</div>
<img alt="../_images/4a117e9cca3e6f8befa1c219fff29a1b40ad15ef8d836efcc9084d5c92b577c5.png" src="../_images/4a117e9cca3e6f8befa1c219fff29a1b40ad15ef8d836efcc9084d5c92b577c5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Include an empirical term to model decrease after the peak</span>
<span class="c1"># We define the new function.</span>
<span class="k">def</span> <span class="nf">funcBoltzmannEmpirical</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Ymin</span><span class="p">,</span> <span class="n">Ymax</span><span class="p">,</span> <span class="n">Tm</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">Ymin</span> <span class="o">+</span> <span class="p">((</span><span class="n">Ymax</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">Tm</span><span class="p">)</span> <span class="o">-</span> <span class="n">Ymin</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">Tm</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">a</span><span class="p">)))</span>

<span class="c1"># We fit the data.</span>
<span class="n">paramsBoltzmannEmpirical</span><span class="p">,</span> <span class="n">params_covarianceBoltzmannEmpirical</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">funcBoltzmannEmpirical</span><span class="p">,</span> <span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span>
                                               <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">333</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">maxfev</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="c1"># We print the fitted parameters.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">paramsBoltzmannEmpirical</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covarianceBoltzmannEmpirical</span><span class="p">)))</span>

<span class="c1"># We plot the fitted curve onto the data.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="n">funcBoltzmannEmpirical</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="o">*</span><span class="n">paramsBoltzmannEmpirical</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Thermal Shift Assay&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;T (Â°K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fluorescence (AU)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  7.85990258 171.68481688 333.74524363   1.52565204   3.97356596]
[0.09701873 0.33837075 0.01447148 0.0111816  0.0236133 ]
</pre></div>
</div>
<img alt="../_images/9503119c2a7e21ca5bab55cdf741acd9d7934701c8192e9f1c819a5e4c827178.png" src="../_images/9503119c2a7e21ca5bab55cdf741acd9d7934701c8192e9f1c819a5e4c827178.png" />
</div>
</div>
</section>
<section id="analysis-3-curve-fitting-using-the-equation-describing-the-unfolding-of-a-monomer-via-a-two-state-mechanism">
<h3>Analysis 3: Curve fitting using the equation describing the unfolding of a monomer via a two-state mechanism<a class="headerlink" href="#analysis-3-curve-fitting-using-the-equation-describing-the-unfolding-of-a-monomer-via-a-two-state-mechanism" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Define the unfolding function to fit the data</span>
<span class="k">def</span> <span class="nf">funcUF</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">yn</span><span class="p">,</span> <span class="n">mn</span><span class="p">,</span> <span class="n">yu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">DHm</span><span class="p">,</span> <span class="n">Tm</span><span class="p">,</span> <span class="n">DCp</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="p">((</span><span class="n">yn</span> <span class="o">+</span> <span class="n">mn</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">yu</span> <span class="o">+</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">DHm</span> <span class="o">*</span> <span class="p">((</span><span class="n">x</span> <span class="o">/</span> <span class="n">Tm</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">DCp</span> <span class="o">*</span> <span class="p">(</span><span class="n">Tm</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">Tm</span><span class="p">)))</span> <span class="o">/</span> <span class="p">(</span><span class="mf">8.314</span> <span class="o">*</span> <span class="n">x</span><span class="p">)))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">DHm</span> <span class="o">*</span> <span class="p">((</span><span class="n">x</span> <span class="o">/</span> <span class="n">Tm</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">DCp</span> <span class="o">*</span> <span class="p">(</span><span class="n">Tm</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">Tm</span><span class="p">)))</span> <span class="o">/</span> <span class="p">(</span><span class="mf">8.314</span> <span class="o">*</span> <span class="n">x</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Test input parameters</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="n">funcUF</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">402000</span><span class="p">,</span> <span class="mi">330</span><span class="p">,</span> <span class="mi">6000</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Thermal Shift Assay&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;T (Â°K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fluorescence (AU)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/aab6d92862a9aae45010816bdb432dafb90babe73f1d225bada2d590acc0ad6c.png" src="../_images/aab6d92862a9aae45010816bdb432dafb90babe73f1d225bada2d590acc0ad6c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Fit the data using the determined input parameters</span>
<span class="n">paramsUF</span><span class="p">,</span> <span class="n">params_covarianceUF</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">funcUF</span><span class="p">,</span> <span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span>
                                               <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">402000</span><span class="p">,</span> <span class="mi">330</span><span class="p">,</span> <span class="mi">6000</span><span class="p">],</span> <span class="n">maxfev</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">paramsUF</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covarianceUF</span><span class="p">)))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="n">funcUF</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="o">*</span><span class="n">paramsUF</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Thermal Shift Assay&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;T (Â°K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fluorescence (AU)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-3.60741800e+01  1.40218168e-01  1.46004700e+03 -3.86614730e+00
  6.48921008e+05  3.33813581e+02  2.63591358e+04]
[2.16781537e+00 6.94593293e-03 4.86727186e+00 1.39736487e-02
 3.32159245e+03 9.06504468e-03 2.19021576e+02]
</pre></div>
</div>
<img alt="../_images/9b97cd93f5b9f1bd156f6da94bebddc32f509458fa2d105da7c8a847099e129e.png" src="../_images/9b97cd93f5b9f1bd156f6da94bebddc32f509458fa2d105da7c8a847099e129e.png" />
</div>
</div>
<section id="advice-overfitting">
<h4>Advice: Overfitting<a class="headerlink" href="#advice-overfitting" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Define the unfolding function without the change in heat capacity to fit the data</span>
<span class="k">def</span> <span class="nf">funcUFnoDCp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">yn</span><span class="p">,</span> <span class="n">mn</span><span class="p">,</span> <span class="n">yu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">DHm</span><span class="p">,</span> <span class="n">Tm</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="p">((</span><span class="n">yn</span> <span class="o">+</span> <span class="n">mn</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">yu</span> <span class="o">+</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">DHm</span> <span class="o">/</span> <span class="mf">8.314</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="n">Tm</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">x</span><span class="p">))))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">DHm</span> <span class="o">/</span> <span class="mf">8.314</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="n">Tm</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">x</span><span class="p">))))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Fit the data</span>
<span class="n">paramsUFnoDCp</span><span class="p">,</span> <span class="n">params_covarianceUFnoDCp</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">funcUFnoDCp</span><span class="p">,</span> <span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span>
                                               <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">402000</span><span class="p">,</span> <span class="mi">330</span><span class="p">],</span> <span class="n">maxfev</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">paramsUFnoDCp</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covarianceUFnoDCp</span><span class="p">)))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdfa1</span><span class="p">,</span> <span class="n">ydfa1</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="n">funcUF</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="o">*</span><span class="n">paramsUF</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Change in heat capacity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="n">funcUFnoDCp</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span> <span class="o">*</span><span class="n">paramsUFnoDCp</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Change in heat capacity = 0&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Unfolding&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;T (Â°K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\Delta$$A_</span><span class="si">{286nm}</span><span class="s1">$ (AU) x 100&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:14: SyntaxWarning: invalid escape sequence &#39;\D&#39;
&lt;&gt;:14: SyntaxWarning: invalid escape sequence &#39;\D&#39;
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\1401809076.py:14: SyntaxWarning: invalid escape sequence &#39;\D&#39;
  plt.ylabel(&#39;$\Delta$$A_{286nm}$ (AU) x 100&#39;, fontsize=14)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-3.87419869e+01  1.50303538e-01  1.48440857e+03 -3.93535895e+00
  6.41886743e+05  3.33812832e+02]
[2.47012998e+00 7.94675118e-03 6.88836674e+00 1.97610448e-02
 4.46184075e+03 1.24515726e-02]
</pre></div>
</div>
<img alt="../_images/326d632c7bcac700eb233f6eff2878ab145ea628040bd1063cbd0e077d61020d.png" src="../_images/326d632c7bcac700eb233f6eff2878ab145ea628040bd1063cbd0e077d61020d.png" />
</div>
</div>
</section>
</section>
</section>
<section id="for-each-well">
<h2>For each wellâ€¦<a class="headerlink" href="#for-each-well" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Group by SamplePos column and convert its result into a dictionary of DataFrames</span>
<span class="n">dict_of_wells</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;SamplePos&quot;</span><span class="p">)))</span>
<span class="c1"># We group by SamplePos column and convert its result into a dictionary of DataFrames.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dict_of_wells</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;A1&#39;:     SamplePos  SampleName   Temp  465-580
0          A1  T4L wt 8uM  20.01     6.94
1          A1  T4L wt 8uM  20.01     6.99
2          A1  T4L wt 8uM  20.16     6.97
3          A1  T4L wt 8uM  20.32     7.00
4          A1  T4L wt 8uM  20.40     6.96
..        ...         ...    ...      ...
640        A1  T4L wt 8uM  84.47    78.21
641        A1  T4L wt 8uM  84.59    77.87
642        A1  T4L wt 8uM  84.67    77.57
643        A1  T4L wt 8uM  84.76    77.29
644        A1  T4L wt 8uM  84.88    76.92

[645 rows x 4 columns], &#39;A10&#39;:      SamplePos SampleName   Temp  465-580
5805       A10      Empty  20.01     5.22
5806       A10      Empty  20.01     5.23
5807       A10      Empty  20.16     5.20
5808       A10      Empty  20.32     5.19
5809       A10      Empty  20.40     5.20
...        ...        ...    ...      ...
6445       A10      Empty  84.47     3.11
6446       A10      Empty  84.59     3.13
6447       A10      Empty  84.67     3.12
6448       A10      Empty  84.76     3.09
6449       A10      Empty  84.88     3.11

[645 rows x 4 columns], &#39;A11&#39;:      SamplePos SampleName   Temp  465-580
6450       A11      Empty  20.01     6.95
6451       A11      Empty  20.01     6.93
6452       A11      Empty  20.16     6.91
6453       A11      Empty  20.32     6.91
6454       A11      Empty  20.40     6.88
...        ...        ...    ...      ...
7090       A11      Empty  84.47     4.02
7091       A11      Empty  84.59     4.02
7092       A11      Empty  84.67     4.03
7093       A11      Empty  84.76     4.04
7094       A11      Empty  84.88     4.01

[645 rows x 4 columns], &#39;A12&#39;:      SamplePos SampleName   Temp  465-580
7095       A12      Empty  20.01     7.11
7096       A12      Empty  20.01     7.06
7097       A12      Empty  20.16     7.08
7098       A12      Empty  20.32     7.09
7099       A12      Empty  20.40     7.05
...        ...        ...    ...      ...
7735       A12      Empty  84.47     4.14
7736       A12      Empty  84.59     4.11
7737       A12      Empty  84.67     4.10
7738       A12      Empty  84.76     4.11
7739       A12      Empty  84.88     4.11

[645 rows x 4 columns], &#39;A2&#39;:      SamplePos  SampleName   Temp  465-580
645         A2  T4L wt 8uM  20.01     7.15
646         A2  T4L wt 8uM  20.01     7.12
647         A2  T4L wt 8uM  20.16     7.15
648         A2  T4L wt 8uM  20.32     7.12
649         A2  T4L wt 8uM  20.40     7.16
...        ...         ...    ...      ...
1285        A2  T4L wt 8uM  84.47    73.00
1286        A2  T4L wt 8uM  84.59    72.65
1287        A2  T4L wt 8uM  84.67    72.36
1288        A2  T4L wt 8uM  84.76    72.08
1289        A2  T4L wt 8uM  84.88    71.80

[645 rows x 4 columns], &#39;A3&#39;:      SamplePos  SampleName   Temp  465-580
1290        A3  T4L wt 8uM  20.01     8.77
1291        A3  T4L wt 8uM  20.01     8.78
1292        A3  T4L wt 8uM  20.16     8.78
1293        A3  T4L wt 8uM  20.32     8.80
1294        A3  T4L wt 8uM  20.40     8.82
...        ...         ...    ...      ...
1930        A3  T4L wt 8uM  84.47    49.05
1931        A3  T4L wt 8uM  84.59    48.96
1932        A3  T4L wt 8uM  84.67    48.80
1933        A3  T4L wt 8uM  84.76    48.57
1934        A3  T4L wt 8uM  84.88    48.41

[645 rows x 4 columns], &#39;A4&#39;:      SamplePos  SampleName   Temp  465-580
1935        A4  T4L wt 8uM  20.01     7.77
1936        A4  T4L wt 8uM  20.01     7.80
1937        A4  T4L wt 8uM  20.16     7.76
1938        A4  T4L wt 8uM  20.32     7.83
1939        A4  T4L wt 8uM  20.40     7.82
...        ...         ...    ...      ...
2575        A4  T4L wt 8uM  84.47    24.66
2576        A4  T4L wt 8uM  84.59    24.58
2577        A4  T4L wt 8uM  84.67    24.51
2578        A4  T4L wt 8uM  84.76    24.47
2579        A4  T4L wt 8uM  84.88    24.36

[645 rows x 4 columns], &#39;A5&#39;:      SamplePos SampleName   Temp  465-580
2580        A5      Empty  20.01     7.61
2581        A5      Empty  20.01     7.59
2582        A5      Empty  20.16     7.55
2583        A5      Empty  20.32     7.59
2584        A5      Empty  20.40     7.55
...        ...        ...    ...      ...
3220        A5      Empty  84.47     4.32
3221        A5      Empty  84.59     4.35
3222        A5      Empty  84.67     4.34
3223        A5      Empty  84.76     4.35
3224        A5      Empty  84.88     4.33

[645 rows x 4 columns], &#39;A6&#39;:      SamplePos SampleName   Temp  465-580
3225        A6      Empty  20.01     7.61
3226        A6      Empty  20.01     7.59
3227        A6      Empty  20.16     7.55
3228        A6      Empty  20.32     7.59
3229        A6      Empty  20.40     7.55
...        ...        ...    ...      ...
3865        A6      Empty  84.47     4.32
3866        A6      Empty  84.59     4.35
3867        A6      Empty  84.67     4.34
3868        A6      Empty  84.76     4.35
3869        A6      Empty  84.88     4.33

[645 rows x 4 columns], &#39;A7&#39;:      SamplePos SampleName   Temp  465-580
3870        A7      Empty  20.01     7.61
3871        A7      Empty  20.01     7.59
3872        A7      Empty  20.16     7.55
3873        A7      Empty  20.32     7.59
3874        A7      Empty  20.40     7.55
...        ...        ...    ...      ...
4510        A7      Empty  84.47     4.32
4511        A7      Empty  84.59     4.35
4512        A7      Empty  84.67     4.34
4513        A7      Empty  84.76     4.35
4514        A7      Empty  84.88     4.33

[645 rows x 4 columns], &#39;A8&#39;:      SamplePos SampleName   Temp  465-580
4515        A8      Empty  20.01     7.61
4516        A8      Empty  20.01     7.59
4517        A8      Empty  20.16     7.55
4518        A8      Empty  20.32     7.59
4519        A8      Empty  20.40     7.55
...        ...        ...    ...      ...
5155        A8      Empty  84.47     4.32
5156        A8      Empty  84.59     4.35
5157        A8      Empty  84.67     4.34
5158        A8      Empty  84.76     4.35
5159        A8      Empty  84.88     4.33

[645 rows x 4 columns], &#39;A9&#39;:      SamplePos SampleName   Temp  465-580
5160        A9      Empty  20.01     6.45
5161        A9      Empty  20.01     6.44
5162        A9      Empty  20.16     6.41
5163        A9      Empty  20.32     6.39
5164        A9      Empty  20.40     6.41
...        ...        ...    ...      ...
5800        A9      Empty  84.47     3.73
5801        A9      Empty  84.59     3.74
5802        A9      Empty  84.67     3.75
5803        A9      Empty  84.76     3.75
5804        A9      Empty  84.88     3.72

[645 rows x 4 columns], &#39;B1&#39;:      SamplePos   SampleName   Temp  465-580
7740        B1  T4L wt 4 uM  20.01     5.48
7741        B1  T4L wt 4 uM  20.01     5.47
7742        B1  T4L wt 4 uM  20.16     5.46
7743        B1  T4L wt 4 uM  20.32     5.47
7744        B1  T4L wt 4 uM  20.40     5.48
...        ...          ...    ...      ...
8380        B1  T4L wt 4 uM  84.47    37.90
8381        B1  T4L wt 4 uM  84.59    37.86
8382        B1  T4L wt 4 uM  84.67    37.63
8383        B1  T4L wt 4 uM  84.76    37.48
8384        B1  T4L wt 4 uM  84.88    37.29

[645 rows x 4 columns], &#39;B10&#39;:       SamplePos SampleName   Temp  465-580
13545       B10      Empty  20.01     7.45
13546       B10      Empty  20.01     7.43
13547       B10      Empty  20.16     7.44
13548       B10      Empty  20.32     7.40
13549       B10      Empty  20.40     7.41
...         ...        ...    ...      ...
14185       B10      Empty  84.47     4.24
14186       B10      Empty  84.59     4.25
14187       B10      Empty  84.67     4.26
14188       B10      Empty  84.76     4.28
14189       B10      Empty  84.88     4.26

[645 rows x 4 columns], &#39;B11&#39;:       SamplePos SampleName   Temp  465-580
14190       B11      Empty  20.01     7.87
14191       B11      Empty  20.01     7.89
14192       B11      Empty  20.16     7.86
14193       B11      Empty  20.32     7.84
14194       B11      Empty  20.40     7.82
...         ...        ...    ...      ...
14830       B11      Empty  84.47     4.50
14831       B11      Empty  84.59     4.49
14832       B11      Empty  84.67     4.50
14833       B11      Empty  84.76     4.50
14834       B11      Empty  84.88     4.50

[645 rows x 4 columns], &#39;B12&#39;:       SamplePos SampleName   Temp  465-580
14835       B12      Empty  20.01     6.61
14836       B12      Empty  20.01     6.60
14837       B12      Empty  20.16     6.59
14838       B12      Empty  20.32     6.56
14839       B12      Empty  20.40     6.60
...         ...        ...    ...      ...
15475       B12      Empty  84.47     3.82
15476       B12      Empty  84.59     3.81
15477       B12      Empty  84.67     3.80
15478       B12      Empty  84.76     3.84
15479       B12      Empty  84.88     3.80

[645 rows x 4 columns], &#39;B2&#39;:      SamplePos   SampleName   Temp  465-580
8385        B2  T4L wt 4 uM  20.01     7.09
8386        B2  T4L wt 4 uM  20.01     7.09
8387        B2  T4L wt 4 uM  20.16     7.07
8388        B2  T4L wt 4 uM  20.32     7.10
8389        B2  T4L wt 4 uM  20.40     7.09
...        ...          ...    ...      ...
9025        B2  T4L wt 4 uM  84.47    35.78
9026        B2  T4L wt 4 uM  84.59    35.55
9027        B2  T4L wt 4 uM  84.67    35.58
9028        B2  T4L wt 4 uM  84.76    35.45
9029        B2  T4L wt 4 uM  84.88    35.30

[645 rows x 4 columns], &#39;B3&#39;:      SamplePos   SampleName   Temp  465-580
9030        B3  T4L wt 4 uM  20.01     7.55
9031        B3  T4L wt 4 uM  20.01     7.60
9032        B3  T4L wt 4 uM  20.16     7.61
9033        B3  T4L wt 4 uM  20.32     7.60
9034        B3  T4L wt 4 uM  20.40     7.60
...        ...          ...    ...      ...
9670        B3  T4L wt 4 uM  84.47    20.66
9671        B3  T4L wt 4 uM  84.59    20.57
9672        B3  T4L wt 4 uM  84.67    20.52
9673        B3  T4L wt 4 uM  84.76    20.52
9674        B3  T4L wt 4 uM  84.88    20.48

[645 rows x 4 columns], &#39;B4&#39;:       SamplePos   SampleName   Temp  465-580
9675         B4  T4L wt 4 uM  20.01     7.04
9676         B4  T4L wt 4 uM  20.01     7.05
9677         B4  T4L wt 4 uM  20.16     7.07
9678         B4  T4L wt 4 uM  20.32     7.04
9679         B4  T4L wt 4 uM  20.40     7.08
...         ...          ...    ...      ...
10315        B4  T4L wt 4 uM  84.47    11.98
10316        B4  T4L wt 4 uM  84.59    11.97
10317        B4  T4L wt 4 uM  84.67    11.96
10318        B4  T4L wt 4 uM  84.76    11.91
10319        B4  T4L wt 4 uM  84.88    11.86

[645 rows x 4 columns], &#39;B5&#39;:       SamplePos SampleName   Temp  465-580
10320        B5      Empty  20.01     7.61
10321        B5      Empty  20.01     7.59
10322        B5      Empty  20.16     7.55
10323        B5      Empty  20.32     7.59
10324        B5      Empty  20.40     7.55
...         ...        ...    ...      ...
10960        B5      Empty  84.47     4.32
10961        B5      Empty  84.59     4.35
10962        B5      Empty  84.67     4.34
10963        B5      Empty  84.76     4.35
10964        B5      Empty  84.88     4.33

[645 rows x 4 columns], &#39;B6&#39;:       SamplePos SampleName   Temp  465-580
10965        B6      Empty  20.01     7.61
10966        B6      Empty  20.01     7.59
10967        B6      Empty  20.16     7.55
10968        B6      Empty  20.32     7.59
10969        B6      Empty  20.40     7.55
...         ...        ...    ...      ...
11605        B6      Empty  84.47     4.32
11606        B6      Empty  84.59     4.35
11607        B6      Empty  84.67     4.34
11608        B6      Empty  84.76     4.35
11609        B6      Empty  84.88     4.33

[645 rows x 4 columns], &#39;B7&#39;:       SamplePos SampleName   Temp  465-580
11610        B7      Empty  20.01     7.61
11611        B7      Empty  20.01     7.59
11612        B7      Empty  20.16     7.55
11613        B7      Empty  20.32     7.59
11614        B7      Empty  20.40     7.55
...         ...        ...    ...      ...
12250        B7      Empty  84.47     4.32
12251        B7      Empty  84.59     4.35
12252        B7      Empty  84.67     4.34
12253        B7      Empty  84.76     4.35
12254        B7      Empty  84.88     4.33

[645 rows x 4 columns], &#39;B8&#39;:       SamplePos SampleName   Temp  465-580
12255        B8      Empty  20.01     7.61
12256        B8      Empty  20.01     7.59
12257        B8      Empty  20.16     7.55
12258        B8      Empty  20.32     7.59
12259        B8      Empty  20.40     7.55
...         ...        ...    ...      ...
12895        B8      Empty  84.47     4.32
12896        B8      Empty  84.59     4.35
12897        B8      Empty  84.67     4.34
12898        B8      Empty  84.76     4.35
12899        B8      Empty  84.88     4.33

[645 rows x 4 columns], &#39;B9&#39;:       SamplePos SampleName   Temp  465-580
12900        B9      Empty  20.01     6.97
12901        B9      Empty  20.01     6.95
12902        B9      Empty  20.16     6.95
12903        B9      Empty  20.32     6.96
12904        B9      Empty  20.40     6.94
...         ...        ...    ...      ...
13540        B9      Empty  84.47     4.01
13541        B9      Empty  84.59     4.01
13542        B9      Empty  84.67     4.04
13543        B9      Empty  84.76     4.01
13544        B9      Empty  84.88     3.99

[645 rows x 4 columns], &#39;C1&#39;:       SamplePos   SampleName   Temp  465-580
15480        C1  T4L wt 2 uM  20.01     4.71
15481        C1  T4L wt 2 uM  20.01     4.71
15482        C1  T4L wt 2 uM  20.16     4.70
15483        C1  T4L wt 2 uM  20.32     4.70
15484        C1  T4L wt 2 uM  20.40     4.72
...         ...          ...    ...      ...
16120        C1  T4L wt 2 uM  84.47    19.52
16121        C1  T4L wt 2 uM  84.59    19.46
16122        C1  T4L wt 2 uM  84.67    19.37
16123        C1  T4L wt 2 uM  84.76    19.31
16124        C1  T4L wt 2 uM  84.88    19.23

[645 rows x 4 columns], &#39;C10&#39;:       SamplePos SampleName   Temp  465-580
21285       C10      Empty  20.01     7.36
21286       C10      Empty  20.01     7.35
21287       C10      Empty  20.16     7.35
21288       C10      Empty  20.32     7.33
21289       C10      Empty  20.40     7.31
...         ...        ...    ...      ...
21925       C10      Empty  84.47     4.23
21926       C10      Empty  84.59     4.20
21927       C10      Empty  84.67     4.19
21928       C10      Empty  84.76     4.20
21929       C10      Empty  84.88     4.19

[645 rows x 4 columns], &#39;C11&#39;:       SamplePos SampleName   Temp  465-580
21930       C11      Empty  20.01     7.01
21931       C11      Empty  20.01     7.01
21932       C11      Empty  20.16     7.00
21933       C11      Empty  20.32     6.98
21934       C11      Empty  20.40     7.01
...         ...        ...    ...      ...
22570       C11      Empty  84.47     4.07
22571       C11      Empty  84.59     4.07
22572       C11      Empty  84.67     4.07
22573       C11      Empty  84.76     4.04
22574       C11      Empty  84.88     4.05

[645 rows x 4 columns], &#39;C12&#39;:       SamplePos SampleName   Temp  465-580
22575       C12      Empty  20.01     4.76
22576       C12      Empty  20.01     4.74
22577       C12      Empty  20.16     4.75
22578       C12      Empty  20.32     4.74
22579       C12      Empty  20.40     4.71
...         ...        ...    ...      ...
23215       C12      Empty  84.47     2.74
23216       C12      Empty  84.59     2.77
23217       C12      Empty  84.67     2.74
23218       C12      Empty  84.76     2.71
23219       C12      Empty  84.88     2.71

[645 rows x 4 columns], &#39;C2&#39;:       SamplePos   SampleName   Temp  465-580
16125        C2  T4L wt 2 uM  20.01     5.72
16126        C2  T4L wt 2 uM  20.01     5.70
16127        C2  T4L wt 2 uM  20.16     5.71
16128        C2  T4L wt 2 uM  20.32     5.70
16129        C2  T4L wt 2 uM  20.40     5.72
...         ...          ...    ...      ...
16765        C2  T4L wt 2 uM  84.47    17.49
16766        C2  T4L wt 2 uM  84.59    17.48
16767        C2  T4L wt 2 uM  84.67    17.38
16768        C2  T4L wt 2 uM  84.76    17.31
16769        C2  T4L wt 2 uM  84.88    17.27

[645 rows x 4 columns], &#39;C3&#39;:       SamplePos   SampleName   Temp  465-580
16770        C3  T4L wt 2 uM  20.01     6.25
16771        C3  T4L wt 2 uM  20.01     6.29
16772        C3  T4L wt 2 uM  20.16     6.32
16773        C3  T4L wt 2 uM  20.32     6.30
16774        C3  T4L wt 2 uM  20.40     6.33
...         ...          ...    ...      ...
17410        C3  T4L wt 2 uM  84.47    10.23
17411        C3  T4L wt 2 uM  84.59    10.23
17412        C3  T4L wt 2 uM  84.67    10.18
17413        C3  T4L wt 2 uM  84.76    10.17
17414        C3  T4L wt 2 uM  84.88    10.18

[645 rows x 4 columns], &#39;C4&#39;:       SamplePos   SampleName   Temp  465-580
17415        C4  T4L wt 2 uM  20.01     6.07
17416        C4  T4L wt 2 uM  20.01     6.09
17417        C4  T4L wt 2 uM  20.16     6.05
17418        C4  T4L wt 2 uM  20.32     6.07
17419        C4  T4L wt 2 uM  20.40     6.09
...         ...          ...    ...      ...
18055        C4  T4L wt 2 uM  84.47     7.37
18056        C4  T4L wt 2 uM  84.59     7.36
18057        C4  T4L wt 2 uM  84.67     7.34
18058        C4  T4L wt 2 uM  84.76     7.34
18059        C4  T4L wt 2 uM  84.88     7.32

[645 rows x 4 columns], &#39;C5&#39;:       SamplePos SampleName   Temp  465-580
18060        C5      Empty  20.01     7.61
18061        C5      Empty  20.01     7.59
18062        C5      Empty  20.16     7.55
18063        C5      Empty  20.32     7.59
18064        C5      Empty  20.40     7.55
...         ...        ...    ...      ...
18700        C5      Empty  84.47     4.32
18701        C5      Empty  84.59     4.35
18702        C5      Empty  84.67     4.34
18703        C5      Empty  84.76     4.35
18704        C5      Empty  84.88     4.33

[645 rows x 4 columns], &#39;C6&#39;:       SamplePos SampleName   Temp  465-580
18705        C6      Empty  20.01     7.61
18706        C6      Empty  20.01     7.59
18707        C6      Empty  20.16     7.55
18708        C6      Empty  20.32     7.59
18709        C6      Empty  20.40     7.55
...         ...        ...    ...      ...
19345        C6      Empty  84.47     4.32
19346        C6      Empty  84.59     4.35
19347        C6      Empty  84.67     4.34
19348        C6      Empty  84.76     4.35
19349        C6      Empty  84.88     4.33

[645 rows x 4 columns], &#39;C7&#39;:       SamplePos SampleName   Temp  465-580
19350        C7      Empty  20.01     7.61
19351        C7      Empty  20.01     7.59
19352        C7      Empty  20.16     7.55
19353        C7      Empty  20.32     7.59
19354        C7      Empty  20.40     7.55
...         ...        ...    ...      ...
19990        C7      Empty  84.47     4.32
19991        C7      Empty  84.59     4.35
19992        C7      Empty  84.67     4.34
19993        C7      Empty  84.76     4.35
19994        C7      Empty  84.88     4.33

[645 rows x 4 columns], &#39;C8&#39;:       SamplePos SampleName   Temp  465-580
19995        C8      Empty  20.01     7.61
19996        C8      Empty  20.01     7.59
19997        C8      Empty  20.16     7.55
19998        C8      Empty  20.32     7.59
19999        C8      Empty  20.40     7.55
...         ...        ...    ...      ...
20635        C8      Empty  84.47     4.32
20636        C8      Empty  84.59     4.35
20637        C8      Empty  84.67     4.34
20638        C8      Empty  84.76     4.35
20639        C8      Empty  84.88     4.33

[645 rows x 4 columns], &#39;C9&#39;:       SamplePos SampleName   Temp  465-580
20640        C9      Empty  20.01     7.19
20641        C9      Empty  20.01     7.14
20642        C9      Empty  20.16     7.16
20643        C9      Empty  20.32     7.12
20644        C9      Empty  20.40     7.12
...         ...        ...    ...      ...
21280        C9      Empty  84.47     4.12
21281        C9      Empty  84.59     4.12
21282        C9      Empty  84.67     4.12
21283        C9      Empty  84.76     4.10
21284        C9      Empty  84.88     4.09

[645 rows x 4 columns], &#39;D1&#39;:       SamplePos   SampleName   Temp  465-580
23220        D1  T4L wt 1 uM  20.01     4.53
23221        D1  T4L wt 1 uM  20.01     4.57
23222        D1  T4L wt 1 uM  20.16     4.55
23223        D1  T4L wt 1 uM  20.32     4.55
23224        D1  T4L wt 1 uM  20.40     4.57
...         ...          ...    ...      ...
23860        D1  T4L wt 1 uM  84.47    10.43
23861        D1  T4L wt 1 uM  84.59    10.41
23862        D1  T4L wt 1 uM  84.67    10.37
23863        D1  T4L wt 1 uM  84.76    10.32
23864        D1  T4L wt 1 uM  84.88    10.32

[645 rows x 4 columns], &#39;D10&#39;:       SamplePos SampleName   Temp  465-580
29025       D10      Empty  20.01     6.80
29026       D10      Empty  20.01     6.80
29027       D10      Empty  20.16     6.79
29028       D10      Empty  20.32     6.74
29029       D10      Empty  20.40     6.75
...         ...        ...    ...      ...
29665       D10      Empty  84.47     3.94
29666       D10      Empty  84.59     3.94
29667       D10      Empty  84.67     3.91
29668       D10      Empty  84.76     3.92
29669       D10      Empty  84.88     3.94

[645 rows x 4 columns], &#39;D11&#39;:       SamplePos SampleName   Temp  465-580
29670       D11      Empty  20.01     6.91
29671       D11      Empty  20.01     6.88
29672       D11      Empty  20.16     6.91
29673       D11      Empty  20.32     6.88
29674       D11      Empty  20.40     6.85
...         ...        ...    ...      ...
30310       D11      Empty  84.47     3.97
30311       D11      Empty  84.59     3.99
30312       D11      Empty  84.67     3.97
30313       D11      Empty  84.76     3.99
30314       D11      Empty  84.88     4.01

[645 rows x 4 columns], &#39;D12&#39;:       SamplePos SampleName   Temp  465-580
30315       D12      Empty  20.01     6.67
30316       D12      Empty  20.01     6.62
30317       D12      Empty  20.16     6.62
30318       D12      Empty  20.32     6.60
30319       D12      Empty  20.40     6.58
...         ...        ...    ...      ...
30955       D12      Empty  84.47     3.86
30956       D12      Empty  84.59     3.85
30957       D12      Empty  84.67     3.86
30958       D12      Empty  84.76     3.87
30959       D12      Empty  84.88     3.85

[645 rows x 4 columns], &#39;D2&#39;:       SamplePos   SampleName   Temp  465-580
23865        D2  T4L wt 1 uM  20.01     4.97
23866        D2  T4L wt 1 uM  20.01     4.99
23867        D2  T4L wt 1 uM  20.16     4.99
23868        D2  T4L wt 1 uM  20.32     4.96
23869        D2  T4L wt 1 uM  20.40     4.98
...         ...          ...    ...      ...
24505        D2  T4L wt 1 uM  84.47    11.06
24506        D2  T4L wt 1 uM  84.59    11.03
24507        D2  T4L wt 1 uM  84.67    10.96
24508        D2  T4L wt 1 uM  84.76    10.98
24509        D2  T4L wt 1 uM  84.88    10.93

[645 rows x 4 columns], &#39;D3&#39;:       SamplePos   SampleName   Temp  465-580
24510        D3  T4L wt 1 uM  20.01     5.14
24511        D3  T4L wt 1 uM  20.01     5.17
24512        D3  T4L wt 1 uM  20.16     5.22
24513        D3  T4L wt 1 uM  20.32     5.15
24514        D3  T4L wt 1 uM  20.40     5.16
...         ...          ...    ...      ...
25150        D3  T4L wt 1 uM  84.47     7.46
25151        D3  T4L wt 1 uM  84.59     7.43
25152        D3  T4L wt 1 uM  84.67     7.43
25153        D3  T4L wt 1 uM  84.76     7.42
25154        D3  T4L wt 1 uM  84.88     7.41

[645 rows x 4 columns], &#39;D4&#39;:       SamplePos   SampleName   Temp  465-580
25155        D4  T4L wt 1 uM  20.01     5.53
25156        D4  T4L wt 1 uM  20.01     5.54
25157        D4  T4L wt 1 uM  20.16     5.54
25158        D4  T4L wt 1 uM  20.32     5.54
25159        D4  T4L wt 1 uM  20.40     5.53
...         ...          ...    ...      ...
25795        D4  T4L wt 1 uM  84.47     4.93
25796        D4  T4L wt 1 uM  84.59     4.93
25797        D4  T4L wt 1 uM  84.67     4.95
25798        D4  T4L wt 1 uM  84.76     4.94
25799        D4  T4L wt 1 uM  84.88     4.94

[645 rows x 4 columns], &#39;D5&#39;:       SamplePos SampleName   Temp  465-580
25800        D5      Empty  20.01     7.61
25801        D5      Empty  20.01     7.59
25802        D5      Empty  20.16     7.55
25803        D5      Empty  20.32     7.59
25804        D5      Empty  20.40     7.55
...         ...        ...    ...      ...
26440        D5      Empty  84.47     4.32
26441        D5      Empty  84.59     4.35
26442        D5      Empty  84.67     4.34
26443        D5      Empty  84.76     4.35
26444        D5      Empty  84.88     4.33

[645 rows x 4 columns], &#39;D6&#39;:       SamplePos SampleName   Temp  465-580
26445        D6      Empty  20.01     7.61
26446        D6      Empty  20.01     7.59
26447        D6      Empty  20.16     7.55
26448        D6      Empty  20.32     7.59
26449        D6      Empty  20.40     7.55
...         ...        ...    ...      ...
27085        D6      Empty  84.47     4.32
27086        D6      Empty  84.59     4.35
27087        D6      Empty  84.67     4.34
27088        D6      Empty  84.76     4.35
27089        D6      Empty  84.88     4.33

[645 rows x 4 columns], &#39;D7&#39;:       SamplePos SampleName   Temp  465-580
27090        D7      Empty  20.01     7.61
27091        D7      Empty  20.01     7.59
27092        D7      Empty  20.16     7.55
27093        D7      Empty  20.32     7.59
27094        D7      Empty  20.40     7.55
...         ...        ...    ...      ...
27730        D7      Empty  84.47     4.32
27731        D7      Empty  84.59     4.35
27732        D7      Empty  84.67     4.34
27733        D7      Empty  84.76     4.35
27734        D7      Empty  84.88     4.33

[645 rows x 4 columns], &#39;D8&#39;:       SamplePos SampleName   Temp  465-580
27735        D8      Empty  20.01     7.61
27736        D8      Empty  20.01     7.59
27737        D8      Empty  20.16     7.55
27738        D8      Empty  20.32     7.59
27739        D8      Empty  20.40     7.55
...         ...        ...    ...      ...
28375        D8      Empty  84.47     4.32
28376        D8      Empty  84.59     4.35
28377        D8      Empty  84.67     4.34
28378        D8      Empty  84.76     4.35
28379        D8      Empty  84.88     4.33

[645 rows x 4 columns], &#39;D9&#39;:       SamplePos SampleName   Temp  465-580
28380        D9      Empty  20.01     7.51
28381        D9      Empty  20.01     7.49
28382        D9      Empty  20.16     7.51
28383        D9      Empty  20.32     7.49
28384        D9      Empty  20.40     7.45
...         ...        ...    ...      ...
29020        D9      Empty  84.47     4.32
29021        D9      Empty  84.59     4.30
29022        D9      Empty  84.67     4.30
29023        D9      Empty  84.76     4.32
29024        D9      Empty  84.88     4.31

[645 rows x 4 columns], &#39;E1&#39;:       SamplePos SampleName   Temp  465-580
30960        E1      Empty  20.01     6.56
30961        E1      Empty  20.01     6.53
30962        E1      Empty  20.16     6.56
30963        E1      Empty  20.32     6.56
30964        E1      Empty  20.40     6.48
...         ...        ...    ...      ...
31600        E1      Empty  84.47     3.79
31601        E1      Empty  84.59     3.79
31602        E1      Empty  84.67     3.79
31603        E1      Empty  84.76     3.80
31604        E1      Empty  84.88     3.77

[645 rows x 4 columns], &#39;E10&#39;:       SamplePos SampleName   Temp  465-580
36765       E10      Empty  20.01     7.19
36766       E10      Empty  20.01     7.20
36767       E10      Empty  20.16     7.20
36768       E10      Empty  20.32     7.15
36769       E10      Empty  20.40     7.15
...         ...        ...    ...      ...
37405       E10      Empty  84.47     4.16
37406       E10      Empty  84.59     4.16
37407       E10      Empty  84.67     4.16
37408       E10      Empty  84.76     4.18
37409       E10      Empty  84.88     4.15

[645 rows x 4 columns], &#39;E11&#39;:       SamplePos SampleName   Temp  465-580
37410       E11      Empty  20.01     7.18
37411       E11      Empty  20.01     7.13
37412       E11      Empty  20.16     7.12
37413       E11      Empty  20.32     7.11
37414       E11      Empty  20.40     7.12
...         ...        ...    ...      ...
38050       E11      Empty  84.47     4.12
38051       E11      Empty  84.59     4.13
38052       E11      Empty  84.67     4.14
38053       E11      Empty  84.76     4.12
38054       E11      Empty  84.88     4.09

[645 rows x 4 columns], &#39;E12&#39;:       SamplePos SampleName   Temp  465-580
38055       E12      Empty  20.01     6.73
38056       E12      Empty  20.01     6.75
38057       E12      Empty  20.16     6.75
38058       E12      Empty  20.32     6.72
38059       E12      Empty  20.40     6.68
...         ...        ...    ...      ...
38695       E12      Empty  84.47     3.90
38696       E12      Empty  84.59     3.91
38697       E12      Empty  84.67     3.91
38698       E12      Empty  84.76     3.91
38699       E12      Empty  84.88     3.89

[645 rows x 4 columns], &#39;E2&#39;:       SamplePos SampleName   Temp  465-580
31605        E2      Empty  20.01     6.79
31606        E2      Empty  20.01     6.79
31607        E2      Empty  20.16     6.77
31608        E2      Empty  20.32     6.77
31609        E2      Empty  20.40     6.77
...         ...        ...    ...      ...
32245        E2      Empty  84.47     3.91
32246        E2      Empty  84.59     3.93
32247        E2      Empty  84.67     3.93
32248        E2      Empty  84.76     3.95
32249        E2      Empty  84.88     3.92

[645 rows x 4 columns], &#39;E3&#39;:       SamplePos SampleName   Temp  465-580
32250        E3      Empty  20.01     7.01
32251        E3      Empty  20.01     6.98
32252        E3      Empty  20.16     6.96
32253        E3      Empty  20.32     6.95
32254        E3      Empty  20.40     6.94
...         ...        ...    ...      ...
32890        E3      Empty  84.47     4.02
32891        E3      Empty  84.59     4.02
32892        E3      Empty  84.67     4.03
32893        E3      Empty  84.76     4.02
32894        E3      Empty  84.88     4.03

[645 rows x 4 columns], &#39;E4&#39;:       SamplePos SampleName   Temp  465-580
32895        E4      Empty  20.01     7.12
32896        E4      Empty  20.01     7.09
32897        E4      Empty  20.16     7.05
32898        E4      Empty  20.32     7.06
32899        E4      Empty  20.40     7.04
...         ...        ...    ...      ...
33535        E4      Empty  84.47     4.08
33536        E4      Empty  84.59     4.05
33537        E4      Empty  84.67     4.08
33538        E4      Empty  84.76     4.09
33539        E4      Empty  84.88     4.05

[645 rows x 4 columns], &#39;E5&#39;:       SamplePos SampleName   Temp  465-580
33540        E5      Empty  20.01     7.24
33541        E5      Empty  20.01     7.22
33542        E5      Empty  20.16     7.20
33543        E5      Empty  20.32     7.21
33544        E5      Empty  20.40     7.18
...         ...        ...    ...      ...
34180        E5      Empty  84.47     4.13
34181        E5      Empty  84.59     4.14
34182        E5      Empty  84.67     4.16
34183        E5      Empty  84.76     4.15
34184        E5      Empty  84.88     4.12

[645 rows x 4 columns], &#39;E6&#39;:       SamplePos SampleName   Temp  465-580
34185        E6      Empty  20.01     7.07
34186        E6      Empty  20.01     7.06
34187        E6      Empty  20.16     7.06
34188        E6      Empty  20.32     7.03
34189        E6      Empty  20.40     7.00
...         ...        ...    ...      ...
34825        E6      Empty  84.47     4.03
34826        E6      Empty  84.59     4.07
34827        E6      Empty  84.67     4.06
34828        E6      Empty  84.76     4.05
34829        E6      Empty  84.88     4.02

[645 rows x 4 columns], &#39;E7&#39;:       SamplePos SampleName   Temp  465-580
34830        E7      Empty  20.01     7.17
34831        E7      Empty  20.01     7.14
34832        E7      Empty  20.16     7.09
34833        E7      Empty  20.32     7.07
34834        E7      Empty  20.40     7.06
...         ...        ...    ...      ...
35470        E7      Empty  84.47     4.09
35471        E7      Empty  84.59     4.08
35472        E7      Empty  84.67     4.09
35473        E7      Empty  84.76     4.07
35474        E7      Empty  84.88     4.06

[645 rows x 4 columns], &#39;E8&#39;:       SamplePos SampleName   Temp  465-580
35475        E8      Empty  20.01     7.38
35476        E8      Empty  20.01     7.35
35477        E8      Empty  20.16     7.37
35478        E8      Empty  20.32     7.36
35479        E8      Empty  20.40     7.34
...         ...        ...    ...      ...
36115        E8      Empty  84.47     4.22
36116        E8      Empty  84.59     4.22
36117        E8      Empty  84.67     4.24
36118        E8      Empty  84.76     4.24
36119        E8      Empty  84.88     4.21

[645 rows x 4 columns], &#39;E9&#39;:       SamplePos SampleName   Temp  465-580
36120        E9      Empty  20.01     7.26
36121        E9      Empty  20.01     7.23
36122        E9      Empty  20.16     7.24
36123        E9      Empty  20.32     7.19
36124        E9      Empty  20.40     7.18
...         ...        ...    ...      ...
36760        E9      Empty  84.47     4.17
36761        E9      Empty  84.59     4.18
36762        E9      Empty  84.67     4.16
36763        E9      Empty  84.76     4.17
36764        E9      Empty  84.88     4.15

[645 rows x 4 columns], &#39;F1&#39;:       SamplePos SampleName   Temp  465-580
38700        F1      Empty  20.01     6.68
38701        F1      Empty  20.01     6.67
38702        F1      Empty  20.16     6.66
38703        F1      Empty  20.32     6.66
38704        F1      Empty  20.40     6.64
...         ...        ...    ...      ...
39340        F1      Empty  84.47     3.81
39341        F1      Empty  84.59     3.84
39342        F1      Empty  84.67     3.81
39343        F1      Empty  84.76     3.83
39344        F1      Empty  84.88     3.80

[645 rows x 4 columns], &#39;F10&#39;:       SamplePos SampleName   Temp  465-580
44505       F10      Empty  20.01     8.51
44506       F10      Empty  20.01     8.46
44507       F10      Empty  20.16     8.47
44508       F10      Empty  20.32     8.45
44509       F10      Empty  20.40     8.45
...         ...        ...    ...      ...
45145       F10      Empty  84.47     4.79
45146       F10      Empty  84.59     4.81
45147       F10      Empty  84.67     4.79
45148       F10      Empty  84.76     4.77
45149       F10      Empty  84.88     4.77

[645 rows x 4 columns], &#39;F11&#39;:       SamplePos SampleName   Temp  465-580
45150       F11      Empty  20.01     7.14
45151       F11      Empty  20.01     7.10
45152       F11      Empty  20.16     7.11
45153       F11      Empty  20.32     7.10
45154       F11      Empty  20.40     7.11
...         ...        ...    ...      ...
45790       F11      Empty  84.47     4.10
45791       F11      Empty  84.59     4.13
45792       F11      Empty  84.67     4.11
45793       F11      Empty  84.76     4.12
45794       F11      Empty  84.88     4.11

[645 rows x 4 columns], &#39;F12&#39;:       SamplePos SampleName   Temp  465-580
45795       F12      Empty  20.01     6.92
45796       F12      Empty  20.01     6.87
45797       F12      Empty  20.16     6.87
45798       F12      Empty  20.32     6.89
45799       F12      Empty  20.40     6.84
...         ...        ...    ...      ...
46435       F12      Empty  84.47     3.97
46436       F12      Empty  84.59     4.01
46437       F12      Empty  84.67     3.95
46438       F12      Empty  84.76     4.00
46439       F12      Empty  84.88     3.99

[645 rows x 4 columns], &#39;F2&#39;:       SamplePos SampleName   Temp  465-580
39345        F2      Empty  20.01     7.08
39346        F2      Empty  20.01     7.04
39347        F2      Empty  20.16     7.08
39348        F2      Empty  20.32     7.05
39349        F2      Empty  20.40     7.05
...         ...        ...    ...      ...
39985        F2      Empty  84.47     4.02
39986        F2      Empty  84.59     4.03
39987        F2      Empty  84.67     4.03
39988        F2      Empty  84.76     4.04
39989        F2      Empty  84.88     4.04

[645 rows x 4 columns], &#39;F3&#39;:       SamplePos SampleName   Temp  465-580
39990        F3      Empty  20.01     7.67
39991        F3      Empty  20.01     7.69
39992        F3      Empty  20.16     7.67
39993        F3      Empty  20.32     7.66
39994        F3      Empty  20.40     7.64
...         ...        ...    ...      ...
40630        F3      Empty  84.47     4.34
40631        F3      Empty  84.59     4.32
40632        F3      Empty  84.67     4.35
40633        F3      Empty  84.76     4.37
40634        F3      Empty  84.88     4.35

[645 rows x 4 columns], &#39;F4&#39;:       SamplePos SampleName   Temp  465-580
40635        F4      Empty  20.01     7.32
40636        F4      Empty  20.01     7.33
40637        F4      Empty  20.16     7.30
40638        F4      Empty  20.32     7.29
40639        F4      Empty  20.40     7.27
...         ...        ...    ...      ...
41275        F4      Empty  84.47     4.17
41276        F4      Empty  84.59     4.20
41277        F4      Empty  84.67     4.18
41278        F4      Empty  84.76     4.21
41279        F4      Empty  84.88     4.16

[645 rows x 4 columns], &#39;F5&#39;:       SamplePos SampleName   Temp  465-580
41280        F5      Empty  20.01     7.22
41281        F5      Empty  20.01     7.22
41282        F5      Empty  20.16     7.20
41283        F5      Empty  20.32     7.21
41284        F5      Empty  20.40     7.19
...         ...        ...    ...      ...
41920        F5      Empty  84.47     4.12
41921        F5      Empty  84.59     4.14
41922        F5      Empty  84.67     4.13
41923        F5      Empty  84.76     4.13
41924        F5      Empty  84.88     4.13

[645 rows x 4 columns], &#39;F6&#39;:       SamplePos SampleName   Temp  465-580
41925        F6      Empty  20.01     8.07
41926        F6      Empty  20.01     8.08
41927        F6      Empty  20.16     8.04
41928        F6      Empty  20.32     8.03
41929        F6      Empty  20.40     8.04
...         ...        ...    ...      ...
42565        F6      Empty  84.47     4.53
42566        F6      Empty  84.59     4.53
42567        F6      Empty  84.67     4.53
42568        F6      Empty  84.76     4.56
42569        F6      Empty  84.88     4.56

[645 rows x 4 columns], &#39;F7&#39;:       SamplePos SampleName   Temp  465-580
42570        F7      Empty  20.01     8.21
42571        F7      Empty  20.01     8.16
42572        F7      Empty  20.16     8.17
42573        F7      Empty  20.32     8.15
42574        F7      Empty  20.40     8.12
...         ...        ...    ...      ...
43210        F7      Empty  84.47     4.61
43211        F7      Empty  84.59     4.62
43212        F7      Empty  84.67     4.61
43213        F7      Empty  84.76     4.64
43214        F7      Empty  84.88     4.59

[645 rows x 4 columns], &#39;F8&#39;:       SamplePos SampleName   Temp  465-580
43215        F8      Empty  20.01     7.34
43216        F8      Empty  20.01     7.30
43217        F8      Empty  20.16     7.32
43218        F8      Empty  20.32     7.32
43219        F8      Empty  20.40     7.30
...         ...        ...    ...      ...
43855        F8      Empty  84.47     4.20
43856        F8      Empty  84.59     4.25
43857        F8      Empty  84.67     4.21
43858        F8      Empty  84.76     4.21
43859        F8      Empty  84.88     4.20

[645 rows x 4 columns], &#39;F9&#39;:       SamplePos SampleName   Temp  465-580
43860        F9      Empty  20.01     7.08
43861        F9      Empty  20.01     7.11
43862        F9      Empty  20.16     7.06
43863        F9      Empty  20.32     7.06
43864        F9      Empty  20.40     7.08
...         ...        ...    ...      ...
44500        F9      Empty  84.47     4.05
44501        F9      Empty  84.59     4.08
44502        F9      Empty  84.67     4.04
44503        F9      Empty  84.76     4.05
44504        F9      Empty  84.88     4.03

[645 rows x 4 columns], &#39;G1&#39;:       SamplePos SampleName   Temp  465-580
46440        G1      Empty  20.01     6.72
46441        G1      Empty  20.01     6.67
46442        G1      Empty  20.16     6.69
46443        G1      Empty  20.32     6.66
46444        G1      Empty  20.40     6.63
...         ...        ...    ...      ...
47080        G1      Empty  84.47     3.83
47081        G1      Empty  84.59     3.81
47082        G1      Empty  84.67     3.82
47083        G1      Empty  84.76     3.81
47084        G1      Empty  84.88     3.82

[645 rows x 4 columns], &#39;G10&#39;:       SamplePos SampleName   Temp  465-580
52245       G10      Empty  20.01     7.85
52246       G10      Empty  20.01     7.85
52247       G10      Empty  20.16     7.78
52248       G10      Empty  20.32     7.79
52249       G10      Empty  20.40     7.77
...         ...        ...    ...      ...
52885       G10      Empty  84.47     4.49
52886       G10      Empty  84.59     4.47
52887       G10      Empty  84.67     4.46
52888       G10      Empty  84.76     4.45
52889       G10      Empty  84.88     4.43

[645 rows x 4 columns], &#39;G11&#39;:       SamplePos SampleName   Temp  465-580
52890       G11      Empty  20.01     7.99
52891       G11      Empty  20.01     7.98
52892       G11      Empty  20.16     7.95
52893       G11      Empty  20.32     7.97
52894       G11      Empty  20.40     7.98
...         ...        ...    ...      ...
53530       G11      Empty  84.47     4.61
53531       G11      Empty  84.59     4.59
53532       G11      Empty  84.67     4.59
53533       G11      Empty  84.76     4.60
53534       G11      Empty  84.88     4.57

[645 rows x 4 columns], &#39;G12&#39;:       SamplePos SampleName   Temp  465-580
53535       G12      Empty  20.01     6.92
53536       G12      Empty  20.01     6.92
53537       G12      Empty  20.16     6.86
53538       G12      Empty  20.32     6.87
53539       G12      Empty  20.40     6.85
...         ...        ...    ...      ...
54175       G12      Empty  84.47     4.04
54176       G12      Empty  84.59     4.02
54177       G12      Empty  84.67     4.00
54178       G12      Empty  84.76     4.00
54179       G12      Empty  84.88     4.01

[645 rows x 4 columns], &#39;G2&#39;:       SamplePos SampleName   Temp  465-580
47085        G2      Empty  20.01     7.21
47086        G2      Empty  20.01     7.17
47087        G2      Empty  20.16     7.17
47088        G2      Empty  20.32     7.14
47089        G2      Empty  20.40     7.14
...         ...        ...    ...      ...
47725        G2      Empty  84.47     4.07
47726        G2      Empty  84.59     4.10
47727        G2      Empty  84.67     4.12
47728        G2      Empty  84.76     4.10
47729        G2      Empty  84.88     4.09

[645 rows x 4 columns], &#39;G3&#39;:       SamplePos SampleName   Temp  465-580
47730        G3      Empty  20.01     7.34
47731        G3      Empty  20.01     7.32
47732        G3      Empty  20.16     7.31
47733        G3      Empty  20.32     7.29
47734        G3      Empty  20.40     7.28
...         ...        ...    ...      ...
48370        G3      Empty  84.47     4.19
48371        G3      Empty  84.59     4.18
48372        G3      Empty  84.67     4.18
48373        G3      Empty  84.76     4.17
48374        G3      Empty  84.88     4.19

[645 rows x 4 columns], &#39;G4&#39;:       SamplePos SampleName   Temp  465-580
48375        G4      Empty  20.01     6.96
48376        G4      Empty  20.01     6.97
48377        G4      Empty  20.16     6.99
48378        G4      Empty  20.32     6.98
48379        G4      Empty  20.40     6.92
...         ...        ...    ...      ...
49015        G4      Empty  84.47     3.98
49016        G4      Empty  84.59     3.99
49017        G4      Empty  84.67     3.99
49018        G4      Empty  84.76     3.99
49019        G4      Empty  84.88     3.99

[645 rows x 4 columns], &#39;G5&#39;:       SamplePos SampleName   Temp  465-580
49020        G5      Empty  20.01     7.50
49021        G5      Empty  20.01     7.47
49022        G5      Empty  20.16     7.49
49023        G5      Empty  20.32     7.49
49024        G5      Empty  20.40     7.47
...         ...        ...    ...      ...
49660        G5      Empty  84.47     4.31
49661        G5      Empty  84.59     4.32
49662        G5      Empty  84.67     4.31
49663        G5      Empty  84.76     4.29
49664        G5      Empty  84.88     4.31

[645 rows x 4 columns], &#39;G6&#39;:       SamplePos SampleName   Temp  465-580
49665        G6      Empty  20.01     7.44
49666        G6      Empty  20.01     7.45
49667        G6      Empty  20.16     7.44
49668        G6      Empty  20.32     7.42
49669        G6      Empty  20.40     7.41
...         ...        ...    ...      ...
50305        G6      Empty  84.47     4.27
50306        G6      Empty  84.59     4.28
50307        G6      Empty  84.67     4.27
50308        G6      Empty  84.76     4.26
50309        G6      Empty  84.88     4.28

[645 rows x 4 columns], &#39;G7&#39;:       SamplePos SampleName   Temp  465-580
50310        G7      Empty  20.01     7.65
50311        G7      Empty  20.01     7.64
50312        G7      Empty  20.16     7.63
50313        G7      Empty  20.32     7.61
50314        G7      Empty  20.40     7.59
...         ...        ...    ...      ...
50950        G7      Empty  84.47     4.35
50951        G7      Empty  84.59     4.37
50952        G7      Empty  84.67     4.36
50953        G7      Empty  84.76     4.34
50954        G7      Empty  84.88     4.36

[645 rows x 4 columns], &#39;G8&#39;:       SamplePos SampleName   Temp  465-580
50955        G8      Empty  20.01     7.64
50956        G8      Empty  20.01     7.62
50957        G8      Empty  20.16     7.61
50958        G8      Empty  20.32     7.61
50959        G8      Empty  20.40     7.60
...         ...        ...    ...      ...
51595        G8      Empty  84.47     4.39
51596        G8      Empty  84.59     4.40
51597        G8      Empty  84.67     4.39
51598        G8      Empty  84.76     4.38
51599        G8      Empty  84.88     4.36

[645 rows x 4 columns], &#39;G9&#39;:       SamplePos SampleName   Temp  465-580
51600        G9      Empty  20.01     7.41
51601        G9      Empty  20.01     7.43
51602        G9      Empty  20.16     7.41
51603        G9      Empty  20.32     7.37
51604        G9      Empty  20.40     7.38
...         ...        ...    ...      ...
52240        G9      Empty  84.47     4.27
52241        G9      Empty  84.59     4.25
52242        G9      Empty  84.67     4.26
52243        G9      Empty  84.76     4.23
52244        G9      Empty  84.88     4.25

[645 rows x 4 columns], &#39;H1&#39;:       SamplePos SampleName   Temp  465-580
54180        H1      Empty  20.01     7.14
54181        H1      Empty  20.01     7.08
54182        H1      Empty  20.16     7.06
54183        H1      Empty  20.32     7.03
54184        H1      Empty  20.40     7.07
...         ...        ...    ...      ...
54820        H1      Empty  84.47     4.04
54821        H1      Empty  84.59     4.03
54822        H1      Empty  84.67     4.07
54823        H1      Empty  84.76     4.02
54824        H1      Empty  84.88     4.04

[645 rows x 4 columns], &#39;H10&#39;:       SamplePos SampleName   Temp  465-580
59985       H10      Empty  20.01     7.59
59986       H10      Empty  20.01     7.62
59987       H10      Empty  20.16     7.56
59988       H10      Empty  20.32     7.52
59989       H10      Empty  20.40     7.58
...         ...        ...    ...      ...
60625       H10      Empty  84.47     4.36
60626       H10      Empty  84.59     4.40
60627       H10      Empty  84.67     4.37
60628       H10      Empty  84.76     4.37
60629       H10      Empty  84.88     4.36

[645 rows x 4 columns], &#39;H11&#39;:       SamplePos SampleName   Temp  465-580
60630       H11      Empty  20.01     7.46
60631       H11      Empty  20.01     7.45
60632       H11      Empty  20.16     7.39
60633       H11      Empty  20.32     7.39
60634       H11      Empty  20.40     7.39
...         ...        ...    ...      ...
61270       H11      Empty  84.47     4.29
61271       H11      Empty  84.59     4.33
61272       H11      Empty  84.67     4.29
61273       H11      Empty  84.76     4.29
61274       H11      Empty  84.88     4.28

[645 rows x 4 columns], &#39;H12&#39;:       SamplePos SampleName   Temp  465-580
61275       H12      Empty  20.01     7.61
61276       H12      Empty  20.01     7.59
61277       H12      Empty  20.16     7.55
61278       H12      Empty  20.32     7.59
61279       H12      Empty  20.40     7.55
...         ...        ...    ...      ...
61915       H12      Empty  84.47     4.32
61916       H12      Empty  84.59     4.35
61917       H12      Empty  84.67     4.34
61918       H12      Empty  84.76     4.35
61919       H12      Empty  84.88     4.33

[645 rows x 4 columns], &#39;H2&#39;:       SamplePos SampleName   Temp  465-580
54825        H2      Empty  20.01     7.01
54826        H2      Empty  20.01     7.02
54827        H2      Empty  20.16     6.97
54828        H2      Empty  20.32     6.97
54829        H2      Empty  20.40     6.96
...         ...        ...    ...      ...
55465        H2      Empty  84.47     4.01
55466        H2      Empty  84.59     4.01
55467        H2      Empty  84.67     4.02
55468        H2      Empty  84.76     3.99
55469        H2      Empty  84.88     3.99

[645 rows x 4 columns], &#39;H3&#39;:       SamplePos SampleName   Temp  465-580
55470        H3      Empty  20.01     7.24
55471        H3      Empty  20.01     7.25
55472        H3      Empty  20.16     7.22
55473        H3      Empty  20.32     7.20
55474        H3      Empty  20.40     7.18
...         ...        ...    ...      ...
56110        H3      Empty  84.47     4.12
56111        H3      Empty  84.59     4.12
56112        H3      Empty  84.67     4.12
56113        H3      Empty  84.76     4.12
56114        H3      Empty  84.88     4.11

[645 rows x 4 columns], &#39;H4&#39;:       SamplePos SampleName   Temp  465-580
56115        H4      Empty  20.01     7.27
56116        H4      Empty  20.01     7.25
56117        H4      Empty  20.16     7.20
56118        H4      Empty  20.32     7.23
56119        H4      Empty  20.40     7.24
...         ...        ...    ...      ...
56755        H4      Empty  84.47     4.14
56756        H4      Empty  84.59     4.17
56757        H4      Empty  84.67     4.11
56758        H4      Empty  84.76     4.12
56759        H4      Empty  84.88     4.12

[645 rows x 4 columns], &#39;H5&#39;:       SamplePos SampleName   Temp  465-580
56760        H5      Empty  20.01     6.72
56761        H5      Empty  20.01     6.72
56762        H5      Empty  20.16     6.69
56763        H5      Empty  20.32     6.70
56764        H5      Empty  20.40     6.69
...         ...        ...    ...      ...
57400        H5      Empty  84.47     3.83
57401        H5      Empty  84.59     3.83
57402        H5      Empty  84.67     3.84
57403        H5      Empty  84.76     3.84
57404        H5      Empty  84.88     3.82

[645 rows x 4 columns], &#39;H6&#39;:       SamplePos SampleName   Temp  465-580
57405        H6      Empty  20.01     6.96
57406        H6      Empty  20.01     6.98
57407        H6      Empty  20.16     6.94
57408        H6      Empty  20.32     6.93
57409        H6      Empty  20.40     6.90
...         ...        ...    ...      ...
58045        H6      Empty  84.47     3.97
58046        H6      Empty  84.59     4.00
58047        H6      Empty  84.67     3.95
58048        H6      Empty  84.76     3.99
58049        H6      Empty  84.88     3.95

[645 rows x 4 columns], &#39;H7&#39;:       SamplePos SampleName   Temp  465-580
58050        H7      Empty  20.01     7.49
58051        H7      Empty  20.01     7.45
58052        H7      Empty  20.16     7.40
58053        H7      Empty  20.32     7.41
58054        H7      Empty  20.40     7.40
...         ...        ...    ...      ...
58690        H7      Empty  84.47     4.24
58691        H7      Empty  84.59     4.27
58692        H7      Empty  84.67     4.24
58693        H7      Empty  84.76     4.22
58694        H7      Empty  84.88     4.23

[645 rows x 4 columns], &#39;H8&#39;:       SamplePos SampleName   Temp  465-580
58695        H8      Empty  20.01     6.75
58696        H8      Empty  20.01     6.75
58697        H8      Empty  20.16     6.74
58698        H8      Empty  20.32     6.68
58699        H8      Empty  20.40     6.73
...         ...        ...    ...      ...
59335        H8      Empty  84.47     3.90
59336        H8      Empty  84.59     3.89
59337        H8      Empty  84.67     3.90
59338        H8      Empty  84.76     3.89
59339        H8      Empty  84.88     3.89

[645 rows x 4 columns], &#39;H9&#39;:       SamplePos SampleName   Temp  465-580
59340        H9      Empty  20.01     7.15
59341        H9      Empty  20.01     7.13
59342        H9      Empty  20.16     7.12
59343        H9      Empty  20.32     7.12
59344        H9      Empty  20.40     7.08
...         ...        ...    ...      ...
59980        H9      Empty  84.47     4.11
59981        H9      Empty  84.59     4.13
59982        H9      Empty  84.67     4.10
59983        H9      Empty  84.76     4.08
59984        H9      Empty  84.88     4.14

[645 rows x 4 columns]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot the data for each well</span>
<span class="n">WellsAll96</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span><span class="s1">&#39;A5&#39;</span><span class="p">,</span><span class="s1">&#39;A6&#39;</span><span class="p">,</span><span class="s1">&#39;A7&#39;</span><span class="p">,</span><span class="s1">&#39;A8&#39;</span><span class="p">,</span><span class="s1">&#39;A9&#39;</span><span class="p">,</span><span class="s1">&#39;A10&#39;</span><span class="p">,</span><span class="s1">&#39;A11&#39;</span><span class="p">,</span><span class="s1">&#39;A12&#39;</span><span class="p">,</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span><span class="s1">&#39;B6&#39;</span><span class="p">,</span><span class="s1">&#39;B7&#39;</span><span class="p">,</span><span class="s1">&#39;B8&#39;</span><span class="p">,</span><span class="s1">&#39;B9&#39;</span><span class="p">,</span><span class="s1">&#39;B10&#39;</span><span class="p">,</span><span class="s1">&#39;B11&#39;</span><span class="p">,</span><span class="s1">&#39;B12&#39;</span><span class="p">,</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span><span class="s1">&#39;C5&#39;</span><span class="p">,</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span><span class="s1">&#39;C7&#39;</span><span class="p">,</span><span class="s1">&#39;C8&#39;</span><span class="p">,</span><span class="s1">&#39;C9&#39;</span><span class="p">,</span><span class="s1">&#39;C10&#39;</span><span class="p">,</span><span class="s1">&#39;C11&#39;</span><span class="p">,</span><span class="s1">&#39;C12&#39;</span><span class="p">,</span><span class="s1">&#39;D1&#39;</span><span class="p">,</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span><span class="s1">&#39;D3&#39;</span><span class="p">,</span><span class="s1">&#39;D4&#39;</span><span class="p">,</span><span class="s1">&#39;D5&#39;</span><span class="p">,</span><span class="s1">&#39;D6&#39;</span><span class="p">,</span><span class="s1">&#39;D7&#39;</span><span class="p">,</span><span class="s1">&#39;D8&#39;</span><span class="p">,</span><span class="s1">&#39;D9&#39;</span><span class="p">,</span><span class="s1">&#39;D10&#39;</span><span class="p">,</span><span class="s1">&#39;D11&#39;</span><span class="p">,</span><span class="s1">&#39;D12&#39;</span><span class="p">,</span><span class="s1">&#39;E1&#39;</span><span class="p">,</span><span class="s1">&#39;E2&#39;</span><span class="p">,</span><span class="s1">&#39;E3&#39;</span><span class="p">,</span><span class="s1">&#39;E4&#39;</span><span class="p">,</span><span class="s1">&#39;E5&#39;</span><span class="p">,</span><span class="s1">&#39;E6&#39;</span><span class="p">,</span><span class="s1">&#39;E7&#39;</span><span class="p">,</span><span class="s1">&#39;E8&#39;</span><span class="p">,</span><span class="s1">&#39;E9&#39;</span><span class="p">,</span><span class="s1">&#39;E10&#39;</span><span class="p">,</span><span class="s1">&#39;E11&#39;</span><span class="p">,</span><span class="s1">&#39;E12&#39;</span><span class="p">,</span><span class="s1">&#39;F1&#39;</span><span class="p">,</span><span class="s1">&#39;F2&#39;</span><span class="p">,</span><span class="s1">&#39;F3&#39;</span><span class="p">,</span><span class="s1">&#39;F4&#39;</span><span class="p">,</span><span class="s1">&#39;F5&#39;</span><span class="p">,</span><span class="s1">&#39;F6&#39;</span><span class="p">,</span><span class="s1">&#39;F7&#39;</span><span class="p">,</span><span class="s1">&#39;F8&#39;</span><span class="p">,</span><span class="s1">&#39;F9&#39;</span><span class="p">,</span><span class="s1">&#39;F10&#39;</span><span class="p">,</span><span class="s1">&#39;F11&#39;</span><span class="p">,</span><span class="s1">&#39;F12&#39;</span><span class="p">,</span><span class="s1">&#39;G1&#39;</span><span class="p">,</span><span class="s1">&#39;G2&#39;</span><span class="p">,</span><span class="s1">&#39;G3&#39;</span><span class="p">,</span><span class="s1">&#39;G4&#39;</span><span class="p">,</span><span class="s1">&#39;G5&#39;</span><span class="p">,</span><span class="s1">&#39;G6&#39;</span><span class="p">,</span><span class="s1">&#39;G7&#39;</span><span class="p">,</span><span class="s1">&#39;G8&#39;</span><span class="p">,</span><span class="s1">&#39;G9&#39;</span><span class="p">,</span><span class="s1">&#39;G10&#39;</span><span class="p">,</span><span class="s1">&#39;G11&#39;</span><span class="p">,</span><span class="s1">&#39;G12&#39;</span><span class="p">,</span><span class="s1">&#39;H1&#39;</span><span class="p">,</span><span class="s1">&#39;H2&#39;</span><span class="p">,</span><span class="s1">&#39;H3&#39;</span><span class="p">,</span><span class="s1">&#39;H4&#39;</span><span class="p">,</span><span class="s1">&#39;H5&#39;</span><span class="p">,</span><span class="s1">&#39;H6&#39;</span><span class="p">,</span><span class="s1">&#39;H7&#39;</span><span class="p">,</span><span class="s1">&#39;H8&#39;</span><span class="p">,</span><span class="s1">&#39;H9&#39;</span><span class="p">,</span><span class="s1">&#39;H10&#39;</span><span class="p">,</span><span class="s1">&#39;H11&#39;</span><span class="p">,</span><span class="s1">&#39;H12&#39;</span><span class="p">]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># We create a figure object. If we don&#39;t use constrained_layout, then labels overlap the axes.</span>

<span class="n">gs1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="c1"># We use gridspec to create grid-shaped combinations of graphs. P.S. an alternative is to use subplots.</span>
<span class="c1"># The number of rows (in our case 8) and number of columns (in our case 12) of the grid need to be set.</span>

<span class="n">axs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">WellsAll96</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">97</span><span class="p">)):</span>
    <span class="n">axs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="n">num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]))</span>
    <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dict_of_wells</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Temp&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">,</span> <span class="n">dict_of_wells</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;465-580&#39;</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="c1"># We loop over all wells i using for. We have 96 wells, hence range(1,97).</span>
    <span class="c1"># We append each plot to the grid previously created. The title of each plot is the name of the well, e.g. A1, A2.</span>
   
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6e468e9c7e284ac85c26ec6292dd8f15b905bcc596713f0f17faffc84003acdc.png" src="../_images/6e468e9c7e284ac85c26ec6292dd8f15b905bcc596713f0f17faffc84003acdc.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Fit the data</span>
<span class="n">dfObj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SamplePos&#39;</span><span class="p">,</span> <span class="s1">&#39;Tm&#39;</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">])</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gs1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">axs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span><span class="s1">&#39;D1&#39;</span><span class="p">,</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span><span class="s1">&#39;D3&#39;</span><span class="p">,</span><span class="s1">&#39;D4&#39;</span><span class="p">],</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">17</span><span class="p">)):</span>
    
    <span class="n">x</span><span class="o">=</span><span class="n">dict_of_wells</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Temp&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">273.15</span> <span class="c1"># convert from Â°C to Â°K </span>
    <span class="n">y</span><span class="o">=</span><span class="n">dict_of_wells</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;465-580&#39;</span><span class="p">]</span>
    
    <span class="n">params</span><span class="p">,</span> <span class="n">params_covariance</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">funcUFnoDCp</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,[</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">402000</span><span class="p">,</span> <span class="mi">330</span><span class="p">],</span> <span class="n">maxfev</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span> <span class="c1"># initial guess for curve_fit - this might not be a good estimate for each condition!</span>
    
    <span class="n">dfAdd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;SamplePos&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;Tm&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="mi">5</span><span class="p">]],</span> <span class="s1">&#39;Error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covariance</span><span class="p">))[</span><span class="mi">5</span><span class="p">]]})</span>
    
    <span class="n">dfObj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">dfObj</span><span class="p">,</span> <span class="n">dfAdd</span><span class="p">),</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        
    <span class="n">axs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="n">num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]))</span>
    <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dict_of_wells</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Temp&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">,</span> <span class="n">dict_of_wells</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;465-580&#39;</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">funcUFnoDCp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dfObj</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\2771878854.py:17: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  dfObj = pd.concat((dfObj, dfAdd), axis = 0)
</pre></div>
</div>
<img alt="../_images/38e50559d59c45a378181b90243ac41f001b7310c9d528d1c342b28a4fdbb0a3.png" src="../_images/38e50559d59c45a378181b90243ac41f001b7310c9d528d1c342b28a4fdbb0a3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  SamplePos          Tm     Error
0        A1  333.812832  0.012452
0        A2  333.365094  0.014226
0        A3  332.896370  0.021205
0        A4  331.564137  0.018647
0        B1  333.540712  0.021271
0        B2  333.053548  0.022692
0        B3  331.686003  0.015675
0        B4  329.483934  0.013724
0        C1  332.858759  0.024700
0        C2  332.166180  0.018651
0        C3  329.744508  0.014210
0        C4  327.951536  0.032072
0        D1  332.359852  0.021023
0        D2  331.910076  0.017261
0        D3  328.908492  0.023433
0        D4  326.209046  0.099373
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="simulating-data">
<h1>Simulating data<a class="headerlink" href="#simulating-data" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Import libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span> 
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
</pre></div>
</div>
</div>
</div>
<section id="a-rightarrow-b">
<h2><span class="math notranslate nohighlight">\(A\)</span> <span class="math notranslate nohighlight">\(\rightarrow\)</span> <span class="math notranslate nohighlight">\(B\)</span><a class="headerlink" href="#a-rightarrow-b" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Define the model</span>
<span class="k">def</span> <span class="nf">funcAtoB</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">kf</span><span class="p">):</span>   <span class="c1">#create the function</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Define a function for A -&gt; B </span>

<span class="sd">    Args:</span>
<span class="sd">        C, the concentrations of A and B (float) in mol/L</span>
<span class="sd">        t, the time (float) in s</span>
<span class="sd">        kf, the forward rate constant (float) in 1/s</span>

<span class="sd">    Returns:</span>
<span class="sd">        dC/dt, derivative values (float) in (mol/L)/s</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">CA</span> <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>   <span class="c1">#the initial concentration of A is the first element from the list C</span>
    <span class="n">CB</span> <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>   <span class="c1">#the initial concentration of B is the second element from the list C</span>
    
    <span class="n">dAdt</span> <span class="o">=</span> <span class="o">-</span><span class="n">kf</span> <span class="o">*</span> <span class="n">CA</span>   <span class="c1">#rate equation for [A]</span>
    <span class="n">dBdt</span> <span class="o">=</span> <span class="o">+</span><span class="n">kf</span> <span class="o">*</span> <span class="n">CA</span>   <span class="c1">#rate equation for [B]</span>
    
    <span class="k">return</span> <span class="p">[</span><span class="n">dAdt</span><span class="p">,</span> <span class="n">dBdt</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Provide initial concetrations and time points</span>
<span class="n">CAtoB</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>   <span class="c1">#y0 - initial conditions</span>

<span class="n">tAtoB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>   <span class="c1">#t - time points, an array with 1000 evenly distributed elements between 0 (included) and 2 (included)</span>

<span class="n">kfAtoB</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,)</span>   <span class="c1">#args - rate constant. Of note, a tuple with one item is constructed by following a value with a comma!</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Solve the ODE for each time point - odeint(model, y0, t, args=)</span>
<span class="n">yAtoB</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">funcAtoB</span><span class="p">,</span> <span class="n">CAtoB</span><span class="p">,</span> <span class="n">tAtoB</span><span class="p">,</span> <span class="n">kfAtoB</span><span class="p">)</span>   <span class="c1">#solve ODE - odeint(model, y0, t, args=)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">yAtoB</span><span class="p">)</span>   <span class="c1">#print the outcome</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1.00000000e+02 0.00000000e+00]
 [9.86083725e+01 1.39162750e+00]
 [9.72361113e+01 2.76388871e+00]
 ...
 [8.55163449e-05 9.99999145e+01]
 [8.43263420e-05 9.99999157e+01]
 [8.31528952e-05 9.99999168e+01]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot the data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>   <span class="c1">#to create a figure object</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tAtoB</span><span class="p">,</span><span class="n">yAtoB</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>   <span class="c1">#select the first column of yAtoB, i.e. [A], and plot versus t, use green</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tAtoB</span><span class="p">,</span><span class="n">yAtoB</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>   <span class="c1">#select the second column of yAtoB, i.e. [B], and plot versus t, use blue</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>   <span class="c1">#label the X-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;[A] (mM)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>   <span class="c1">#label the Y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>   <span class="c1">#set X-axis range</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">110</span><span class="p">])</span>   <span class="c1">#set Y-axis range</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>   <span class="c1">#include a legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1">#show the figure object</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/997a115f6e8fb803b5888e885092d2d7d83b5d98176bf05fcb201f8a505c4c96.png" src="../_images/997a115f6e8fb803b5888e885092d2d7d83b5d98176bf05fcb201f8a505c4c96.png" />
</div>
</div>
</section>
<section id="a-b-rightleftharpoons-ab">
<h2><span class="math notranslate nohighlight">\(A + B\)</span> <span class="math notranslate nohighlight">\(\rightleftharpoons\)</span> <span class="math notranslate nohighlight">\(AB\)</span><a class="headerlink" href="#a-b-rightleftharpoons-ab" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Define the model</span>
<span class="k">def</span> <span class="nf">funcAandBtofromAB</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">kf</span><span class="p">,</span> <span class="n">kr</span><span class="p">):</span>   <span class="c1">#create the function</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Define a function for A + B -&gt; AB </span>

<span class="sd">    Args:</span>
<span class="sd">        C, the concentrations of A, B, and AB (float) in mol/L</span>
<span class="sd">        t, the time (float) in s</span>
<span class="sd">        kf, the forward rate constant (float) in (mol/L)/s</span>
<span class="sd">        kr, the reverse rate constant (float) in 1/s</span>

<span class="sd">    Returns:</span>
<span class="sd">        dC/dt, derivative values (float) in (mol/L)/s</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">CA</span> <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#the initial concentration of A is the first element from the list C</span>
    <span class="n">CB</span> <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#the initial concentration of B is the second element from the list C</span>
    <span class="n">CAB</span> <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="c1">#the initial concentration of AB is the thirs element from the list C</span>
    
    <span class="n">dAdt</span> <span class="o">=</span> <span class="o">-</span><span class="n">kf</span> <span class="o">*</span> <span class="n">CA</span> <span class="o">*</span> <span class="n">CB</span> <span class="o">+</span> <span class="n">kr</span> <span class="o">*</span> <span class="n">CAB</span> <span class="c1">#rate equation for [A]</span>
    <span class="n">dBdt</span> <span class="o">=</span> <span class="o">-</span><span class="n">kf</span> <span class="o">*</span> <span class="n">CA</span> <span class="o">*</span> <span class="n">CB</span> <span class="o">+</span> <span class="n">kr</span> <span class="o">*</span> <span class="n">CAB</span> <span class="c1">#rate equation for [B]</span>
    <span class="n">dABdt</span> <span class="o">=</span> <span class="n">kf</span> <span class="o">*</span> <span class="n">CA</span> <span class="o">*</span> <span class="n">CB</span> <span class="o">-</span> <span class="n">kr</span> <span class="o">*</span> <span class="n">CAB</span> <span class="c1">#rate equation for [AB]</span>
    
    <span class="k">return</span> <span class="p">[</span><span class="n">dAdt</span><span class="p">,</span> <span class="n">dBdt</span><span class="p">,</span> <span class="n">dABdt</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Provide initial concetrations and time points</span>
<span class="n">CAandBtofromAB</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>   <span class="c1">#y0 - initial conditions</span>

<span class="n">tAandBtofromAB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>   <span class="c1">#t - time points, an array with 1000 evenly distributed elements between 0 (included) and 0.1 (included)</span>

<span class="n">ksAandBtofromAB</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>   <span class="c1">#args - rate constants</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Solve the ODE for each time point - odeint(model, y0, t, args=)</span>
<span class="n">yAandBtofromAB</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">funcAandBtofromAB</span><span class="p">,</span> <span class="n">CAandBtofromAB</span><span class="p">,</span> <span class="n">tAandBtofromAB</span><span class="p">,</span> <span class="n">ksAandBtofromAB</span><span class="p">)</span>   <span class="c1">#solve ODE - odeint(model, y0, t, args=)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">yAandBtofromAB</span><span class="p">)</span>   <span class="c1">#print the outcome</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1.00000000e+01 5.00000000e+01 0.00000000e+00]
 [9.95012480e+00 4.99501248e+01 4.98752049e-02]
 [9.90059739e+00 4.99005974e+01 9.94026072e-02]
 ...
 [1.95837942e+00 4.19583794e+01 8.04162058e+00]
 [1.95820429e+00 4.19582043e+01 8.04179571e+00]
 [1.95803011e+00 4.19580301e+01 8.04196989e+00]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot the data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>  <span class="c1">#to create a figure object</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tAandBtofromAB</span><span class="p">,</span><span class="n">yAandBtofromAB</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>   <span class="c1">#select the first column of yAandBtofromAB, i.e. [A], and plot versus t, use green</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tAandBtofromAB</span><span class="p">,</span><span class="n">yAandBtofromAB</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>   <span class="c1">#select the second column of yAandBtofromAB, i.e. [B], and plot versus t, use blue</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tAandBtofromAB</span><span class="p">,</span><span class="n">yAandBtofromAB</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>   <span class="c1">#select the third column of yAandBtofromAB, i.e. [AB], and plot versus t, use red</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>   <span class="c1">#label the X-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;[x] ($\mu$M)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>   <span class="c1">#label the Y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">])</span>   <span class="c1">#set X-axis range</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">55</span><span class="p">])</span>   <span class="c1">#set Y-axis range</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;AB&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>   <span class="c1">#include a legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1">#show the figure object</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:7: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:7: SyntaxWarning: invalid escape sequence &#39;\m&#39;
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\281931762.py:7: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.ylabel(&#39;[x] ($\mu$M)&#39;, fontsize=18)   #label the Y-axis
</pre></div>
</div>
<img alt="../_images/7090be6f9a2a18315c735878b593af3402ec48fbccf3508721b35149fa79dba4.png" src="../_images/7090be6f9a2a18315c735878b593af3402ec48fbccf3508721b35149fa79dba4.png" />
</div>
</div>
</section>
<section id="e-s-rightleftharpoons-es-rightarrow-e-p">
<h2><span class="math notranslate nohighlight">\(E + S\)</span> <span class="math notranslate nohighlight">\(\rightleftharpoons\)</span> <span class="math notranslate nohighlight">\(ES\)</span> <span class="math notranslate nohighlight">\(\rightarrow\)</span> <span class="math notranslate nohighlight">\(E + P\)</span><a class="headerlink" href="#e-s-rightleftharpoons-es-rightarrow-e-p" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Define the model - function that returns dE/dt, dS/dt, dES/dt, and dP/dt</span>
<span class="k">def</span> <span class="nf">funcEandStofromEStoP</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="n">k3</span><span class="p">)</span> <span class="p">:</span>
    <span class="c1"># constants</span>
    <span class="n">CE</span> <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">CS</span> <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">CES</span> <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">CP</span> <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    
    <span class="c1"># equations</span>
    <span class="n">dEdt</span> <span class="o">=</span> <span class="o">-</span><span class="n">k1</span> <span class="o">*</span> <span class="n">CE</span> <span class="o">*</span> <span class="n">CS</span> <span class="o">+</span> <span class="p">(</span><span class="n">k2</span> <span class="o">+</span> <span class="n">k3</span><span class="p">)</span> <span class="o">*</span> <span class="n">CES</span>
    <span class="n">dSdt</span> <span class="o">=</span> <span class="o">-</span><span class="n">k1</span> <span class="o">*</span> <span class="n">CE</span> <span class="o">*</span> <span class="n">CS</span> <span class="o">+</span> <span class="n">k2</span> <span class="o">*</span> <span class="n">CES</span>
    <span class="n">dESdt</span> <span class="o">=</span> <span class="n">k1</span> <span class="o">*</span> <span class="n">CE</span> <span class="o">*</span> <span class="n">CS</span> <span class="o">-</span> <span class="p">(</span><span class="n">k2</span> <span class="o">+</span> <span class="n">k3</span><span class="p">)</span> <span class="o">*</span> <span class="n">CES</span>
    <span class="n">dPdt</span> <span class="o">=</span> <span class="n">k3</span> <span class="o">*</span> <span class="n">CES</span>
    
    <span class="k">return</span> <span class="p">[</span><span class="n">dEdt</span><span class="p">,</span> <span class="n">dSdt</span><span class="p">,</span> <span class="n">dESdt</span><span class="p">,</span> <span class="n">dPdt</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Provide initial concetrations and time points</span>

<span class="c1">#y0 - initial conditions</span>
<span class="n">CEandStofromEStoP</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1">#t - time points</span>
<span class="n">tEandStofromEStoP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>

<span class="c1">#args - rate constants</span>
<span class="n">ksEandStofromEStoP</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Solve the ODE for each time point - odeint(model, y0, t, args=)</span>
<span class="n">yEandStofromEStoP</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">funcEandStofromEStoP</span><span class="p">,</span> <span class="n">CEandStofromEStoP</span><span class="p">,</span> <span class="n">tEandStofromEStoP</span><span class="p">,</span> <span class="n">ksEandStofromEStoP</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">yEandStofromEStoP</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1.00000000e+00 1.00000000e+01 0.00000000e+00 0.00000000e+00]
 [9.42028253e-01 9.94194028e+00 5.79717469e-02 8.79707258e-05]
 [8.87918178e-01 9.88757417e+00 1.12081822e-01 3.44004555e-04]
 ...
 [9.99999875e-01 2.17751575e-08 1.24982377e-07 9.99999985e+00]
 [9.99999875e-01 2.17194857e-08 1.24662060e-07 9.99999985e+00]
 [9.99999876e-01 2.16640125e-08 1.24342882e-07 9.99999985e+00]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot the data</span>
<span class="c1">#create plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tEandStofromEStoP</span><span class="p">,</span><span class="n">yEandStofromEStoP</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;g:&#39;</span><span class="p">)</span> <span class="c1">#select the first column of yEandStofromEStoP, i.e. [E], and plot versus t, use green</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tEandStofromEStoP</span><span class="p">,</span><span class="n">yEandStofromEStoP</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;b-&#39;</span><span class="p">)</span> <span class="c1">#select the second column of yEandStofromEStoP, i.e. [S], and plot versus t, use blue</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tEandStofromEStoP</span><span class="p">,</span><span class="n">yEandStofromEStoP</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;r--&#39;</span><span class="p">)</span> <span class="c1">#select the third column of yEandStofromEStoP, i.e. [ES], and plot versus t, use red</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tEandStofromEStoP</span><span class="p">,</span><span class="n">yEandStofromEStoP</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span><span class="s1">&#39;y-.&#39;</span><span class="p">)</span> <span class="c1">#select the fourth column of yEandStofromEStoP, i.e. [P], and plot versus t, use yellow</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="c1">#label the X-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;[x] ($\mu$M)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="c1">#label the Y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">60</span><span class="p">])</span> <span class="c1">#set X-axis range</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">])</span> <span class="c1">#set Y-axis range</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;ES&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span> <span class="c1">#include a legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:9: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:9: SyntaxWarning: invalid escape sequence &#39;\m&#39;
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\2696257987.py:9: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.ylabel(&#39;[x] ($\mu$M)&#39;, fontsize=18) #label the Y-axis
</pre></div>
</div>
<img alt="../_images/77df4168157423c9bf5c268967258fbd67910a7ab11ea1c1a6523434af045fd4.png" src="../_images/77df4168157423c9bf5c268967258fbd67910a7ab11ea1c1a6523434af045fd4.png" />
</div>
</div>
<section id="the-pre-steady-state-or-transient-phase">
<h3>The pre-steady state (or transient) phase<a class="headerlink" href="#the-pre-steady-state-or-transient-phase" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#create plot for [E] and [S] from 0 to 0.5 s</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tEandStofromEStoP</span><span class="p">,</span><span class="n">yEandStofromEStoP</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;g:&#39;</span><span class="p">)</span> <span class="c1">#select the first column of yEandStofromEStoP, i.e. [E], and plot versus t, use green</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tEandStofromEStoP</span><span class="p">,</span><span class="n">yEandStofromEStoP</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;r--&#39;</span><span class="p">)</span> <span class="c1">#select the third column of yEandStofromEStoP, i.e. [ES], and plot versus t, use red</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="c1">#label the X-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;[x] ($\mu$M)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="c1">#label the Y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">])</span> <span class="c1">#set X-axis range</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">])</span> <span class="c1">#set Y-axis range</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;ES&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span> <span class="c1">#include a legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:6: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:6: SyntaxWarning: invalid escape sequence &#39;\m&#39;
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\606441847.py:6: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.ylabel(&#39;[x] ($\mu$M)&#39;, fontsize=18) #label the Y-axis
</pre></div>
</div>
<img alt="../_images/e9dbce137b8015f952896729ebe82b8b5b8128a635644b6581955cc8f2058520.png" src="../_images/e9dbce137b8015f952896729ebe82b8b5b8128a635644b6581955cc8f2058520.png" />
</div>
</div>
</section>
<section id="the-steady-state-phase">
<h3>The steady state phase<a class="headerlink" href="#the-steady-state-phase" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#create plot for [E] and [S] from 0.5 to 10 s</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tEandStofromEStoP</span><span class="p">,</span><span class="n">yEandStofromEStoP</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;g:&#39;</span><span class="p">)</span> <span class="c1">#select the first column of yEandStofromEStoP, i.e. [E], and plot versus t, use green</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tEandStofromEStoP</span><span class="p">,</span><span class="n">yEandStofromEStoP</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;r--&#39;</span><span class="p">)</span> <span class="c1">#select the third column of yEandStofromEStoP, i.e. [ES], and plot versus t, use red</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="c1">#label the X-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;[x] ($\mu$M)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="c1">#label the Y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span> <span class="c1">#set X-axis range</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">])</span> <span class="c1">#set Y-axis range</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;ES&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span> <span class="c1">#include a legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:6: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:6: SyntaxWarning: invalid escape sequence &#39;\m&#39;
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\907882851.py:6: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.ylabel(&#39;[x] ($\mu$M)&#39;, fontsize=18) #label the Y-axis
</pre></div>
</div>
<img alt="../_images/44607f9c1fb0cc43d0f19e41ff74b7aa31b054b45787e3696b915e8ddf62a2e3.png" src="../_images/44607f9c1fb0cc43d0f19e41ff74b7aa31b054b45787e3696b915e8ddf62a2e3.png" />
</div>
</div>
</section>
<section id="after-10-s">
<h3>After ~10 s<a class="headerlink" href="#after-10-s" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#create plot for [E] and [S] from 0 to 60 s</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tEandStofromEStoP</span><span class="p">,</span><span class="n">yEandStofromEStoP</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;g:&#39;</span><span class="p">)</span> <span class="c1">#select the first column of yEandStofromEStoP, i.e. [E], and plot versus t, use green</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tEandStofromEStoP</span><span class="p">,</span><span class="n">yEandStofromEStoP</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;r--&#39;</span><span class="p">)</span> <span class="c1">#select the third column of yEandStofromEStoP, i.e. [ES], and plot versus t, use red</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="c1">#label the X-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;[x] ($\mu$M)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="c1">#label the Y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">60</span><span class="p">])</span> <span class="c1">#set X-axis range</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">])</span> <span class="c1">#set Y-axis range</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;ES&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span> <span class="c1">#include a legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:6: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:6: SyntaxWarning: invalid escape sequence &#39;\m&#39;
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\516644659.py:6: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.ylabel(&#39;[x] ($\mu$M)&#39;, fontsize=18) #label the Y-axis
</pre></div>
</div>
<img alt="../_images/e77f5601744be03436227269f7814c2415e590b6ce8d18793f0dfe50ce14afa6.png" src="../_images/e77f5601744be03436227269f7814c2415e590b6ce8d18793f0dfe50ce14afa6.png" />
</div>
</div>
</section>
<section id="compare-s-0-1-10-mum-and-s-0-2-1-mum-for-k-1-1-k-1-2-1-mum-1-s-1-k-1-1-k-1-2-0-1-s-1-k-2-1-k-2-2-0-5-s-1-es-0-1-es-0-2-0-mum-p-0-1-p-0-2-0-mum-and-e-0-1-e-0-2-1-mum-we-can-see-that-the-initial-reaction-rate-decreases-and-that-es-decreases-rapidly-for-s-0-2-there-is-only-enough-substrate-for-a-single-turnover-where-does-each-curve-reach-a-plateau">
<h3>Compare <span class="math notranslate nohighlight">\([S]_{0,1} = 10\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span> and <span class="math notranslate nohighlight">\([S]_{0,2} = 1\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span> for <span class="math notranslate nohighlight">\(k_{+1,1} = k_{+1,2} = 1\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M^{-1} s^{-1}\)</span>; <span class="math notranslate nohighlight">\(k_{-1,1} = k_{-1,2} = 0.1\)</span> <span class="math notranslate nohighlight">\(s^{-1}\)</span>; <span class="math notranslate nohighlight">\(k_{2,1} = k_{2,2} = 0.5\)</span> <span class="math notranslate nohighlight">\(s^{-1}\)</span>, <span class="math notranslate nohighlight">\([ES]_{0,1} = [ES]_{0,2} = 0\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span>, <span class="math notranslate nohighlight">\([P]_{0,1} = [P]_{0,2} = 0\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span>, and <span class="math notranslate nohighlight">\([E]_{0,1} = [E]_{0,2} = 1\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span>. We can see that the initial reaction rate decreases and that <span class="math notranslate nohighlight">\([ES]\)</span> decreases rapidly for <span class="math notranslate nohighlight">\([S]_{0,2}\)</span>. There is only enough substrate for a single turnover. Where does each curve reach a plateau?<a class="headerlink" href="#compare-s-0-1-10-mum-and-s-0-2-1-mum-for-k-1-1-k-1-2-1-mum-1-s-1-k-1-1-k-1-2-0-1-s-1-k-2-1-k-2-2-0-5-s-1-es-0-1-es-0-2-0-mum-p-0-1-p-0-2-0-mum-and-e-0-1-e-0-2-1-mum-we-can-see-that-the-initial-reaction-rate-decreases-and-that-es-decreases-rapidly-for-s-0-2-there-is-only-enough-substrate-for-a-single-turnover-where-does-each-curve-reach-a-plateau" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CEandStofromEStoP_1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">CEandStofromEStoP_2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">yEandStofromEStoP_1</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">funcEandStofromEStoP</span><span class="p">,</span> <span class="n">CEandStofromEStoP_1</span><span class="p">,</span> <span class="n">tEandStofromEStoP</span><span class="p">,</span> <span class="n">ksEandStofromEStoP</span><span class="p">)</span>
<span class="n">yEandStofromEStoP_2</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">funcEandStofromEStoP</span><span class="p">,</span> <span class="n">CEandStofromEStoP_2</span><span class="p">,</span> <span class="n">tEandStofromEStoP</span><span class="p">,</span> <span class="n">ksEandStofromEStoP</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tEandStofromEStoP</span><span class="p">,</span><span class="n">yEandStofromEStoP_1</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;g:&#39;</span><span class="p">)</span> <span class="c1">#select the third column of yEandStofromEStoP, i.e. [ES], and plot versus t, use red</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tEandStofromEStoP</span><span class="p">,</span><span class="n">yEandStofromEStoP_2</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;r--&#39;</span><span class="p">)</span> <span class="c1">#select the third column of yEandStofromEStoP, i.e. [ES], and plot versus t, use red</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="c1">#label the X-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;[ES] ($\mu$M)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="c1">#label the Y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">])</span> <span class="c1">#set X-axis range</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">])</span> <span class="c1">#set Y-axis range</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;[S] = 10 $\mu$M&#39;</span><span class="p">,</span><span class="s1">&#39;[S] = 1 $\mu$M&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span> <span class="c1">#include a legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tEandStofromEStoP</span><span class="p">,</span><span class="n">yEandStofromEStoP_1</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span><span class="s1">&#39;g:&#39;</span><span class="p">)</span> <span class="c1">#select the fourth column of yAandBtofromAB, i.e. [P], and plot versus t, use green</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tEandStofromEStoP</span><span class="p">,</span><span class="n">yEandStofromEStoP_2</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span><span class="s1">&#39;r--&#39;</span><span class="p">)</span> <span class="c1">#select the fourth column of yAandBtofromAB, i.e. [P], and plot versus t, use red</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="c1">#label the X-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;[P] ($\mu$M)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="c1">#label the Y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">])</span> <span class="c1">#set X-axis range</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">])</span> <span class="c1">#set Y-axis range</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;[S] = 10 $\mu$M&#39;</span><span class="p">,</span><span class="s1">&#39;[S] = 1 $\mu$M&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span> <span class="c1">#include a legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:11: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:14: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:14: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:21: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:24: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:24: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:11: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:14: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:14: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:21: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:24: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:24: SyntaxWarning: invalid escape sequence &#39;\m&#39;
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\2971370150.py:11: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.ylabel(&#39;[ES] ($\mu$M)&#39;, fontsize=18) #label the Y-axis
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\2971370150.py:14: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.legend([&#39;[S] = 10 $\mu$M&#39;,&#39;[S] = 1 $\mu$M&#39;], loc=&#39;best&#39;) #include a legend
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\2971370150.py:14: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.legend([&#39;[S] = 10 $\mu$M&#39;,&#39;[S] = 1 $\mu$M&#39;], loc=&#39;best&#39;) #include a legend
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\2971370150.py:21: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.ylabel(&#39;[P] ($\mu$M)&#39;, fontsize=18) #label the Y-axis
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\2971370150.py:24: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.legend([&#39;[S] = 10 $\mu$M&#39;,&#39;[S] = 1 $\mu$M&#39;], loc=&#39;best&#39;) #include a legend
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\2971370150.py:24: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.legend([&#39;[S] = 10 $\mu$M&#39;,&#39;[S] = 1 $\mu$M&#39;], loc=&#39;best&#39;) #include a legend
</pre></div>
</div>
<img alt="../_images/390a40e69216fd0a7fbfb913c555837fdb333791e87e16316842a6cf221a2f87.png" src="../_images/390a40e69216fd0a7fbfb913c555837fdb333791e87e16316842a6cf221a2f87.png" />
<img alt="../_images/045987ad4638a50d4c947009436bb8abe43c35f7cb9f119b0c337aab552fb5a6.png" src="../_images/045987ad4638a50d4c947009436bb8abe43c35f7cb9f119b0c337aab552fb5a6.png" />
</div>
</div>
</section>
<section id="compare-e-0-1-1-mum-and-e-0-2-0-1-mum-for-k-1-1-k-1-2-1-mum-1-s-1-k-1-1-k-1-2-0-1-s-1-k-2-1-k-2-2-0-5-s-1-es-0-1-es-0-2-0-mum-p-0-1-p-0-2-0-mum-and-s-0-1-s-0-2-10-mum-we-can-see-that-the-duration-of-the-steady-state-phase-increases-for-e-0-2-the-enzyme-undergoes-multiple-rounds-of-catalysis-without-depleting-the-substrate-when-we-study-steady-state-kinetics-conditions-are-chosen-so-that-s-0-gg-e-0">
<h3>Compare <span class="math notranslate nohighlight">\([E]_{0,1} = 1\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span> and <span class="math notranslate nohighlight">\([E]_{0,2} = 0.1\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span> for <span class="math notranslate nohighlight">\(k_{+1,1} = k_{+1,2} = 1\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M^{-1} s^{-1}\)</span>; <span class="math notranslate nohighlight">\(k_{-1,1} = k_{-1,2} = 0.1\)</span> <span class="math notranslate nohighlight">\(s^{-1}\)</span>; <span class="math notranslate nohighlight">\(k_{2,1} = k_{2,2} = 0.5\)</span> <span class="math notranslate nohighlight">\(s^{-1}\)</span>, <span class="math notranslate nohighlight">\([ES]_{0,1} = [ES]_{0,2} = 0\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span>, <span class="math notranslate nohighlight">\([P]_{0,1} = [P]_{0,2} = 0\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span>, and <span class="math notranslate nohighlight">\([S]_{0,1} = [S]_{0,2} = 10\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span>. We can see that the duration of the steady-state phase increases for <span class="math notranslate nohighlight">\([E]_{0,2}\)</span>. The enzyme undergoes multiple rounds of catalysis without depleting the substrate. When we study steady-state kinetics, conditions are chosen so that <span class="math notranslate nohighlight">\([S]_0 \gg [E]_0\)</span>.<a class="headerlink" href="#compare-e-0-1-1-mum-and-e-0-2-0-1-mum-for-k-1-1-k-1-2-1-mum-1-s-1-k-1-1-k-1-2-0-1-s-1-k-2-1-k-2-2-0-5-s-1-es-0-1-es-0-2-0-mum-p-0-1-p-0-2-0-mum-and-s-0-1-s-0-2-10-mum-we-can-see-that-the-duration-of-the-steady-state-phase-increases-for-e-0-2-the-enzyme-undergoes-multiple-rounds-of-catalysis-without-depleting-the-substrate-when-we-study-steady-state-kinetics-conditions-are-chosen-so-that-s-0-gg-e-0" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CEandStofromEStoP_3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">CEandStofromEStoP_4</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">yEandStofromEStoP_3</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">funcEandStofromEStoP</span><span class="p">,</span> <span class="n">CEandStofromEStoP_3</span><span class="p">,</span> <span class="n">tEandStofromEStoP</span><span class="p">,</span> <span class="n">ksEandStofromEStoP</span><span class="p">)</span>
<span class="n">yEandStofromEStoP_4</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">funcEandStofromEStoP</span><span class="p">,</span> <span class="n">CEandStofromEStoP_4</span><span class="p">,</span> <span class="n">tEandStofromEStoP</span><span class="p">,</span> <span class="n">ksEandStofromEStoP</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tEandStofromEStoP</span><span class="p">,</span><span class="n">yEandStofromEStoP_3</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;g:&#39;</span><span class="p">)</span> <span class="c1">#select the third column of yEandStofromEStoP, i.e. [ES], and plot versus t, use red</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tEandStofromEStoP</span><span class="p">,</span><span class="n">yEandStofromEStoP_4</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;r--&#39;</span><span class="p">)</span> <span class="c1">#select the third column of yEandStofromEStoP, i.e. [ES], and plot versus t, use red</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="c1">#label the X-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;[ES] ($\mu$M)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="c1">#label the Y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">])</span> <span class="c1">#set X-axis range</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">])</span> <span class="c1">#set Y-axis range</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;[S] = 1 $\mu$M&#39;</span><span class="p">,</span><span class="s1">&#39;[S] = 0.1 $\mu$M&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span> <span class="c1">#include a legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tEandStofromEStoP</span><span class="p">,</span><span class="n">yEandStofromEStoP_3</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span><span class="s1">&#39;g:&#39;</span><span class="p">)</span> <span class="c1">#select the fourth column of yAandBtofromAB, i.e. [P], and plot versus t, use green</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tEandStofromEStoP</span><span class="p">,</span><span class="n">yEandStofromEStoP_4</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span><span class="s1">&#39;r--&#39;</span><span class="p">)</span> <span class="c1">#select the fourth column of yAandBtofromAB, i.e. [P], and plot versus t, use red</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="c1">#label the X-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;[P] ($\mu$M)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="c1">#label the Y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">])</span> <span class="c1">#set X-axis range</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">])</span> <span class="c1">#set Y-axis range</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;[S] = 1 $\mu$M&#39;</span><span class="p">,</span><span class="s1">&#39;[S] = 0.1 $\mu$M&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span> <span class="c1">#include a legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:11: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:14: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:14: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:21: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:24: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:24: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:11: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:14: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:14: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:21: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:24: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:24: SyntaxWarning: invalid escape sequence &#39;\m&#39;
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\1917555078.py:11: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.ylabel(&#39;[ES] ($\mu$M)&#39;, fontsize=18) #label the Y-axis
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\1917555078.py:14: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.legend([&#39;[S] = 1 $\mu$M&#39;,&#39;[S] = 0.1 $\mu$M&#39;], loc=&#39;best&#39;) #include a legend
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\1917555078.py:14: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.legend([&#39;[S] = 1 $\mu$M&#39;,&#39;[S] = 0.1 $\mu$M&#39;], loc=&#39;best&#39;) #include a legend
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\1917555078.py:21: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.ylabel(&#39;[P] ($\mu$M)&#39;, fontsize=18) #label the Y-axis
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\1917555078.py:24: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.legend([&#39;[S] = 1 $\mu$M&#39;,&#39;[S] = 0.1 $\mu$M&#39;], loc=&#39;best&#39;) #include a legend
C:\Users\ucbtrv2\AppData\Local\Temp\ipykernel_14616\1917555078.py:24: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.legend([&#39;[S] = 1 $\mu$M&#39;,&#39;[S] = 0.1 $\mu$M&#39;], loc=&#39;best&#39;) #include a legend
</pre></div>
</div>
<img alt="../_images/7b092135f4547e2a5011acf34ffe18b06d7c28798abe2f413d85715dc9e6ff2c.png" src="../_images/7b092135f4547e2a5011acf34ffe18b06d7c28798abe2f413d85715dc9e6ff2c.png" />
<img alt="../_images/f5a74c557ff39800a1dc04d54f8aaeac73a2aaee0278ebbdb43e5939360462c1.png" src="../_images/f5a74c557ff39800a1dc04d54f8aaeac73a2aaee0278ebbdb43e5939360462c1.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "conda-base-py"
        },
        kernelOptions: {
            name: "conda-base-py",
            path: "./examples"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'conda-base-py'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Dose response curve</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#colorimetric-assay">Colorimetric assay</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#redox-potential">Redox potential</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#chemical-unfolding">Chemical unfolding</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#michaelis-menten-curve">Michaelis-Menten curve</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermal-shift-assay">Thermal shift assay</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#for-well-a1">For well A1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-1-first-derivative-method">Analysis 1: First derivative method</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tip-make-a-plot-with-a-secondary-y-axis">Tip: Make a plot with a secondary Y-axis</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tip-smoothen-a-curve">Tip: Smoothen a curve</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-2-curve-fitting-using-a-boltzmann-model">Analysis 2: Curve fitting using a Boltzmann model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-3-curve-fitting-using-the-equation-describing-the-unfolding-of-a-monomer-via-a-two-state-mechanism">Analysis 3: Curve fitting using the equation describing the unfolding of a monomer via a two-state mechanism</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#advice-overfitting">Advice: Overfitting</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#for-each-well">For each wellâ€¦</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-data">Simulating data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-rightarrow-b"><span class="math notranslate nohighlight">\(A\)</span> <span class="math notranslate nohighlight">\(\rightarrow\)</span> <span class="math notranslate nohighlight">\(B\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-b-rightleftharpoons-ab"><span class="math notranslate nohighlight">\(A + B\)</span> <span class="math notranslate nohighlight">\(\rightleftharpoons\)</span> <span class="math notranslate nohighlight">\(AB\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#e-s-rightleftharpoons-es-rightarrow-e-p"><span class="math notranslate nohighlight">\(E + S\)</span> <span class="math notranslate nohighlight">\(\rightleftharpoons\)</span> <span class="math notranslate nohighlight">\(ES\)</span> <span class="math notranslate nohighlight">\(\rightarrow\)</span> <span class="math notranslate nohighlight">\(E + P\)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-pre-steady-state-or-transient-phase">The pre-steady state (or transient) phase</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-steady-state-phase">The steady state phase</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#after-10-s">After ~10 s</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-s-0-1-10-mum-and-s-0-2-1-mum-for-k-1-1-k-1-2-1-mum-1-s-1-k-1-1-k-1-2-0-1-s-1-k-2-1-k-2-2-0-5-s-1-es-0-1-es-0-2-0-mum-p-0-1-p-0-2-0-mum-and-e-0-1-e-0-2-1-mum-we-can-see-that-the-initial-reaction-rate-decreases-and-that-es-decreases-rapidly-for-s-0-2-there-is-only-enough-substrate-for-a-single-turnover-where-does-each-curve-reach-a-plateau">Compare <span class="math notranslate nohighlight">\([S]_{0,1} = 10\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span> and <span class="math notranslate nohighlight">\([S]_{0,2} = 1\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span> for <span class="math notranslate nohighlight">\(k_{+1,1} = k_{+1,2} = 1\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M^{-1} s^{-1}\)</span>; <span class="math notranslate nohighlight">\(k_{-1,1} = k_{-1,2} = 0.1\)</span> <span class="math notranslate nohighlight">\(s^{-1}\)</span>; <span class="math notranslate nohighlight">\(k_{2,1} = k_{2,2} = 0.5\)</span> <span class="math notranslate nohighlight">\(s^{-1}\)</span>, <span class="math notranslate nohighlight">\([ES]_{0,1} = [ES]_{0,2} = 0\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span>, <span class="math notranslate nohighlight">\([P]_{0,1} = [P]_{0,2} = 0\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span>, and <span class="math notranslate nohighlight">\([E]_{0,1} = [E]_{0,2} = 1\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span>. We can see that the initial reaction rate decreases and that <span class="math notranslate nohighlight">\([ES]\)</span> decreases rapidly for <span class="math notranslate nohighlight">\([S]_{0,2}\)</span>. There is only enough substrate for a single turnover. Where does each curve reach a plateau?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-e-0-1-1-mum-and-e-0-2-0-1-mum-for-k-1-1-k-1-2-1-mum-1-s-1-k-1-1-k-1-2-0-1-s-1-k-2-1-k-2-2-0-5-s-1-es-0-1-es-0-2-0-mum-p-0-1-p-0-2-0-mum-and-s-0-1-s-0-2-10-mum-we-can-see-that-the-duration-of-the-steady-state-phase-increases-for-e-0-2-the-enzyme-undergoes-multiple-rounds-of-catalysis-without-depleting-the-substrate-when-we-study-steady-state-kinetics-conditions-are-chosen-so-that-s-0-gg-e-0">Compare <span class="math notranslate nohighlight">\([E]_{0,1} = 1\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span> and <span class="math notranslate nohighlight">\([E]_{0,2} = 0.1\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span> for <span class="math notranslate nohighlight">\(k_{+1,1} = k_{+1,2} = 1\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M^{-1} s^{-1}\)</span>; <span class="math notranslate nohighlight">\(k_{-1,1} = k_{-1,2} = 0.1\)</span> <span class="math notranslate nohighlight">\(s^{-1}\)</span>; <span class="math notranslate nohighlight">\(k_{2,1} = k_{2,2} = 0.5\)</span> <span class="math notranslate nohighlight">\(s^{-1}\)</span>, <span class="math notranslate nohighlight">\([ES]_{0,1} = [ES]_{0,2} = 0\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span>, <span class="math notranslate nohighlight">\([P]_{0,1} = [P]_{0,2} = 0\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span>, and <span class="math notranslate nohighlight">\([S]_{0,1} = [S]_{0,2} = 10\)</span> <span class="math notranslate nohighlight">\(\mu\)</span><span class="math notranslate nohighlight">\(M\)</span>. We can see that the duration of the steady-state phase increases for <span class="math notranslate nohighlight">\([E]_{0,2}\)</span>. The enzyme undergoes multiple rounds of catalysis without depleting the substrate. When we study steady-state kinetics, conditions are chosen so that <span class="math notranslate nohighlight">\([S]_0 \gg [E]_0\)</span>.</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Renee Vancraenenbroeck, UCL
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>