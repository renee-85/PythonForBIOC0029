

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>SciPy For Data Fitting &#8212; Python For BIOC0029</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/SciPyForDataFitting';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Dose response curve" href="../examples/DoseResponseCurve.html" />
    <link rel="prev" title="Matplotlib For Plotting And Data Visualization" href="MatplotlibForPlotting.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../WelcomeToPythonForBIOC0029.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../WelcomeToPythonForBIOC0029.html">
                    Welcome to Python for BIOC0029
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Running Python code</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="JupyterNotebooksGettingStarted.html">Jupyter Notebooks: Getting Started</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Python basics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="VariablesDataTypesIndicesSlices.html">Variables, Data Types, Indices, and Slices</a></li>
<li class="toctree-l1"><a class="reference internal" href="ForLoopsLogicStatementsFunctions.html">For Loops, Logic Statements, and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Libraries.html">Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="NumPyForArithmeticOperations.html">NumPy For Arithmetic Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="PandasForTabularData.html">Pandas For Working With Tabular Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="MatplotlibForPlotting.html">Matplotlib For Plotting And Data Visualization</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">SciPy For Data Fitting</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../examples/DoseResponseCurve.html">Dose response curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/ColorimetricAssay.html">Colorimetric assay</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/RedoxPotential.html">Redox potential</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/ThermalShiftAssay.html">Thermal shift assay</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fchapters/SciPyForDataFitting.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapters/SciPyForDataFitting.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>SciPy For Data Fitting</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-models-and-parameters-font"><strong><font color="blue">Models and parameters</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-least-squares-fitting-font"><strong><font color="blue">Least squares fitting</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-unweighted-and-weighted-fits-font"><strong><font color="blue">Unweighted and weighted fits</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-the-scipy-optimize-curve-fit-function-fit-parameters-and-standard-errors-of-the-fit-parameters-font"><strong><font color="blue">The <code class="docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code> function, fit parameters, and standard errors of the fit parameters</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-steps-font"><strong><font color="blue">Steps</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-linear-regression-font"><strong><font color="blue">Linear regression</font></strong></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="scipy-for-data-fitting">
<h1>SciPy For Data Fitting<a class="headerlink" href="#scipy-for-data-fitting" title="Permalink to this heading">#</a></h1>
<section id="font-color-blue-models-and-parameters-font">
<h2><strong><font color=blue>Models and parameters</font></strong><a class="headerlink" href="#font-color-blue-models-and-parameters-font" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>The goal of <strong>(non)linear regression</strong> is to fit a <strong>model</strong> to our data. A model is usually a mathematical function, describing the relationship between different physical quantities. Fitting a model produces estimates for <strong>the model parameters</strong>, which often have a biological meaning and are thus of interest.</p>
<p>One example is a standard curve in a colorimetric assay, which describes the absorbance at a specific wavelength at a given standard protein, <em>e.g.</em> BSA, concentration. Here, <span class="math notranslate nohighlight">\([BSA]\)</span> is <strong>the independent variable</strong>, the absorbance at a specific wavelength <strong>the dependent variable</strong>, and a and b the model parameters.</p>
<p>Another example is the Michaelis-Menten equation, which describes the initial reaction rate, <span class="math notranslate nohighlight">\(V_{0}\)</span>, at a given substrate concentration, <span class="math notranslate nohighlight">\([S_{0}]\)</span>, for a system that follows <span class="math notranslate nohighlight">\(E + S\)</span> <span class="math notranslate nohighlight">\(\rightleftharpoons\)</span> <span class="math notranslate nohighlight">\(ES\)</span> <span class="math notranslate nohighlight">\(\rightarrow\)</span> <span class="math notranslate nohighlight">\(E + P\)</span> (with E = enzyme, S = substrate, and P = product). Here, <span class="math notranslate nohighlight">\([S_{0}]\)</span> is the independent variable, <span class="math notranslate nohighlight">\(V_{0}\)</span> the dependent variable, and <span class="math notranslate nohighlight">\(V_{max}\)</span> and <span class="math notranslate nohighlight">\(K_m\)</span> the model parameters.</p>
<a class="reference internal image-reference" href="../_images/ExampleModels.png"><img alt="Example models" class="align-center" src="../_images/ExampleModels.png" style="width: 600px;" /></a>
<p>Of note, a model is said to be linear when the dependent variable is linear with each model parameter. If the model is not linear, then it is nonlinear. Our first example, the standard curve in a colorimetric assay, is a linear model. Our second example, the Michaelis-Menten equation, is a nonlinear model.</p>
</section>
<section id="font-color-blue-least-squares-fitting-font">
<h2><strong><font color=blue>Least squares fitting</font></strong><a class="headerlink" href="#font-color-blue-least-squares-fitting-font" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>For curve fitting, we use the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html">scipy.optimize.curve_fit</a> command. It can be used for multiple relationships - not just straight lines and polynomials! - between two sets of data. It uses <strong>least squares</strong> to fit a function, which we define, to data. It simply minimises the sum of the squares between the data point <span class="math notranslate nohighlight">\(y_{i,observed}\)</span> and the fit point <span class="math notranslate nohighlight">\(f(x_{i}) = y_{i,predicted}\)</span>:</p>
<div class="math notranslate nohighlight">
\[
 \chi^2 = \Sigma_{i=1}^n (y_{i,observed} - y_{i,predicted})^2
\]</div>
<a class="reference internal image-reference" href="../_images/LeastSquaresFitting.png"><img alt="Least squares fitting" class="align-center" src="../_images/LeastSquaresFitting.png" style="width: 600px;" /></a>
</section>
<section id="font-color-blue-unweighted-and-weighted-fits-font">
<h2><strong><font color=blue>Unweighted and weighted fits</font></strong><a class="headerlink" href="#font-color-blue-unweighted-and-weighted-fits-font" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>It can be used for data with and without errors. For a <strong>normal or unweighted</strong> least squares fit, it assumes the errors on the data points are all the same and therefore play no role in the fitting procedure. A <strong>weighted fit</strong> does depend on the uncertainties on each point. To take weights, <span class="math notranslate nohighlight">\(w_{i}\)</span> (very often non-uniform sample standard deviations, <span class="math notranslate nohighlight">\(\sigma_{i}\)</span>) into account we use:</p>
<div class="math notranslate nohighlight">
\[
 \chi^2 = \Sigma_{i=1}^n w_{i} * (\overline {y_{i,observed}} - y_{i,predicted})^2 = \Sigma_{i=1}^n \biggl(\frac{\overline {y_{i,observed}} - y_{i,predicted}}{\sigma_{i}}\biggr)^2
\]</div>
<p>Remember, the mean, <span class="math notranslate nohighlight">\(\overline {y_{i,observed}}\)</span> is:</p>
<div class="math notranslate nohighlight">
\[
 \overline {y_{i,observed}} = \frac{\Sigma_{j=1}^n y_{j,observed}}{n}
\]</div>
<p>The standard deviation, <span class="math notranslate nohighlight">\(\sigma\)</span>, is the square root of the sample variance:</p>
<div class="math notranslate nohighlight">
\[
 \Sigma = \sqrt{\frac{\Sigma_{j=1}^n (y_{j,observed} - \overline {y_{i,observed}})^2}{n-1}}
\]</div>
<p>Where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(j\)</span> indexes the data set,</p></li>
<li><p><span class="math notranslate nohighlight">\(y_{j,observed}\)</span> are the individual results,</p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span> is the number of data sets,</p></li>
<li><p><span class="math notranslate nohighlight">\(n-1\)</span> is called the degrees of freedom.</p></li>
</ul>
<p>Please see <em>AMC TB 27-2007</em>, <em>Why are we weighting?</em>, available <a class="reference external" href="https://www.rsc.org/images/why-weighting-technical-brief-27_tcm18-214826.pdf">here</a> for more information on weighted fits.</p>
</section>
<section id="font-color-blue-the-scipy-optimize-curve-fit-function-fit-parameters-and-standard-errors-of-the-fit-parameters-font">
<h2><strong><font color=blue>The <code class="docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code> function, fit parameters, and standard errors of the fit parameters</font></strong><a class="headerlink" href="#font-color-blue-the-scipy-optimize-curve-fit-function-fit-parameters-and-standard-errors-of-the-fit-parameters-font" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>The <code class="docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit(f,</span> <span class="pre">xdata,</span> <span class="pre">ydata,</span> <span class="pre">p0,</span> <span class="pre">sigma,</span> <span class="pre">absolute_sigma)</span></code> function has many arguments. Important are <code class="docutils literal notranslate"><span class="pre">f</span></code> to define the model function, <code class="docutils literal notranslate"><span class="pre">xdata</span></code> and <code class="docutils literal notranslate"><span class="pre">ydata</span></code> for the independent and dependent variables, and <code class="docutils literal notranslate"><span class="pre">p0</span></code> for the initial guesses for the model parameters.</p>
<p>The argument <code class="docutils literal notranslate"><span class="pre">sigma</span></code>, by default <code class="docutils literal notranslate"><span class="pre">None</span></code>, can be used to define the sample standard deviations. When working with uncertainties, we need to change the argument <code class="docutils literal notranslate"><span class="pre">absolute_sigma</span></code> from its default <code class="docutils literal notranslate"><span class="pre">False</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>. It relates to all values in sigma being the standard deviations and not just relative weights for the data points.</p>
<p>The function returns the optimal values for the model parameters (params, the order as defined by the function) and the covariance matrix (params_covariance, the order as defined by the function).</p>
<p>This covariance matrix can be used to calculate standard errors of the fit parameters. To compute one standard deviation errors on the fit parameters use the <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.sqrt.html">numpy.sqrt</a> and <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.diag.html">numpy.diag</a> functions from NumPy.</p>
<a class="reference internal image-reference" href="../_images/CovarianceMatrix.png"><img alt="The covariance matrix of the estimated parameters" class="align-center" src="../_images/CovarianceMatrix.png" style="width: 600px;" /></a>
</section>
<section id="font-color-blue-steps-font">
<h2><strong><font color=blue>Steps</font></strong><a class="headerlink" href="#font-color-blue-steps-font" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>The steps for curve fitting are:</p>
<ol class="arabic simple">
<li><p>Import the <code class="docutils literal notranslate"><span class="pre">optimize</span></code> module with the <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code> function from the SciPy library.</p></li>
<li><p>Create the (x,y) data, either as NumPy arrays or a Pandas DataFrame.</p></li>
<li><p>Define a function for the model we want to fit. The function should accept as inputs the independent variable(s) and all the model parameters to be fit.</p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit(f,</span> <span class="pre">xdata,</span> <span class="pre">ydata,</span> <span class="pre">p0,</span> <span class="pre">sigma,</span> <span class="pre">absolute_sigma)</span></code> function to fit the data.</p></li>
<li><p>Extract the fit parameters and standard errors on the fit parameters from the output.</p></li>
<li><p>Inspect the x,y data and fit on a graph.</p></li>
<li><p>Calculate and inspect the residuals, <em>i.e.</em> <span class="math notranslate nohighlight">\(y_{i,observed} - y_{i,predicted}\)</span>, on a graph.</p></li>
</ol>
<p>Please, look at the <a class="reference external" href="https://www.youtube.com/watch?v=Jl-Ye38qkRc">“Curve fitting in Python with curve_fit” from Brant Carlson YouTube video</a> about curve fitting in Python for more information and an example. It includes:</p>
<ul class="simple">
<li><p>computing <span class="math notranslate nohighlight">\(χ^2\)</span> when having uncertainties (at ~ 6 minutes),</p></li>
<li><p>using curve_fit (at ~ 14 minutes),</p></li>
<li><p>plotting the results and residuals (at ~ 19 minutes), and</p></li>
<li><p>interpreting curve_fit’s covariance matrix (at ~ 30 minutes).</p></li>
</ul>
<div class="exercise admonition" id="my6-exercise1">

<p class="admonition-title"><span class="caption-number">Exercise 35 </span></p>
<section id="exercise-content">
<p>Import the <code class="docutils literal notranslate"><span class="pre">optimize</span></code> module with the <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code> function from the SciPy library. Use convenient naming.</p>
</section>
</div>
<div class="solution dropdown admonition" id="my6-solution1">

<p class="admonition-title">Solution to<a class="reference internal" href="#my6-exercise1"> Exercise 35</a></p>
<section id="solution-content">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
</pre></div>
</div>
</section>
</div>
<div class="exercise admonition" id="my6-exercise2">

<p class="admonition-title"><span class="caption-number">Exercise 36 </span></p>
<section id="exercise-content">
<p>The following (x,y) data represent a BCA colorimetric assay standard curve. BSA concentrations are given in mg/ml and absorbances at 562 nm in AU.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">BSAconc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">,</span> <span class="mf">0.250</span><span class="p">,</span> <span class="mf">0.500</span><span class="p">,</span> <span class="mf">0.750</span><span class="p">,</span> <span class="mf">1.00</span><span class="p">,</span> <span class="mf">1.50</span><span class="p">,</span> <span class="mf">2.00</span><span class="p">])</span>
<span class="n">A562nm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.056333</span><span class="p">,</span> <span class="mf">0.081000</span><span class="p">,</span> <span class="mf">0.239667</span><span class="p">,</span> <span class="mf">0.512333</span><span class="p">,</span> <span class="mf">0.731667</span><span class="p">,</span> <span class="mf">1.047000</span><span class="p">,</span> <span class="mf">1.565000</span><span class="p">,</span> <span class="mf">2.016667</span><span class="p">])</span>
</pre></div>
</div>
<p>We first define the function to fit the data using</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">funcline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>   <span class="c1">#create the function to return a line</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span>
    <span class="k">return</span> <span class="n">y</span>
</pre></div>
</div>
<p>We now fit the data using</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">paramsSC</span><span class="p">,</span> <span class="n">params_covarianceSC</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">funcline</span><span class="p">,</span>   <span class="c1">#the function we try to fit to the data</span>
                                        <span class="n">BSAconc</span><span class="p">,</span>   <span class="c1">#the x values, the concentrations</span>
                                        <span class="n">df0</span><span class="p">[</span><span class="s1">&#39;BSA-mean&#39;</span><span class="p">],</span>   <span class="c1">#the y values, the measured absorbances</span>
                                        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>   <span class="c1">#the starting parameters for a (=the slope) and b (=the intercept)</span>
</pre></div>
</div>
<p>We now extract the fit parameters and calculate the standard error of the fit parameters using</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Slope, a = &quot;</span><span class="p">,</span> <span class="n">paramsSC</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covarianceSC</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>   <span class="c1">#print the slope and standard error on the slope</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Intercept, b = &quot;</span><span class="p">,</span> <span class="n">paramsSC</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;±&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">params_covarianceSC</span><span class="p">))[</span><span class="mi">1</span><span class="p">])</span>   <span class="c1">#print the intercept and standard error on the intercept</span>
</pre></div>
</div>
<p>It is up to you to</p>
<ul class="simple">
<li><p>inspect the x,y data and fit on a graph, and</p></li>
<li><p>calculate and inspect the residuals on a graph.</p></li>
</ul>
</section>
</div>
<div class="solution dropdown admonition" id="my6-solution2">

<p class="admonition-title">Solution to<a class="reference internal" href="#my6-exercise2"> Exercise 36</a></p>
<section id="solution-content">
<p>Here’s one possible solution.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#inspect the x,y data and fit on a graph</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>   <span class="c1">#start a figure object</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">BSAconc</span><span class="p">,</span> <span class="n">A562nm</span><span class="p">,</span>   <span class="c1">#plot a set of x (=the concentrations),y (= the measured absorbances) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>   <span class="c1">#use a round, red marker with size 8 but use no line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>   <span class="c1">#use a label for the legend</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">BSAconc</span><span class="p">,</span> <span class="n">funcline</span><span class="p">(</span><span class="n">BSAconc</span><span class="p">,</span> <span class="o">*</span><span class="n">paramsSC</span><span class="p">),</span>   <span class="c1">#plot a set of x (=the concentrations),y (= the calculated absorbances using the fit parameters (the star unpacks the *paramsSC array) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span>  <span class="c1">#use no marker but use a solid, gray line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span><span class="p">)</span>   <span class="c1">#use a label for the legend</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Standard Curve&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>   <span class="c1">#title of graph</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$[BSA]$ ($mg ml^{-1}$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#X-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;A562nm (AU)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#Y-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>   <span class="c1">#include a legend</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1">#show the figure object</span>


<span class="c1">#calculate the residuals</span>
<span class="n">residSC</span> <span class="o">=</span> <span class="n">A562nm</span> <span class="o">-</span> <span class="n">funcline</span><span class="p">(</span><span class="n">BSAconc</span><span class="p">,</span> <span class="o">*</span><span class="n">paramsSC</span><span class="p">)</span>   <span class="c1">#calculate the residuals</span>


<span class="c1">#inspect the residuals on a graph</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>   <span class="c1">#start a figure object</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">BSAconc</span><span class="p">,</span> <span class="n">residSC</span><span class="p">,</span>   <span class="c1">#plot a set of x (=the concentrations),y (= the residuals) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>   <span class="c1">#use a round, black marker with size 8</span>
         <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">)</span>   <span class="c1">#use a solid line</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Residuals&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>   <span class="c1">#title of graph</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$[BSA]$ ($mg ml^{-1}$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#X-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;A562nm (AU)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>   <span class="c1">#Y-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>   <span class="c1">#add a gray, dashed horizontal line across y=0</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1">#show the figure object</span>
</pre></div>
</div>
</section>
</div>
<div class="exercise admonition" id="my6-exercise3">

<p class="admonition-title"><span class="caption-number">Exercise 37 </span></p>
<section id="exercise-content">
<p>For the data and data analysis from the previous exercise, produce a combined figure showing the residuals plot underneath the main plot. Make sure they are aligned and have the same X-axis so we can see which residual corresponds to which data point.</p>
<p>Tip: Many functions can be used. Have a look at <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html">matplotlib.pyplot.subplots</a>, <a class="reference external" href="https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure.add_subplot">matplotlib.figure.figure.add_subplot</a>, or <a class="reference external" href="https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure.add_axes">matplotlib.figure.figure.add_axes</a>.</p>
</section>
</div>
<div class="solution dropdown admonition" id="my6-solution3">

<p class="admonition-title">Solution to<a class="reference internal" href="#my6-exercise3"> Exercise 37</a></p>
<section id="solution-content">
<p>Here’s one possible solution.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>   <span class="c1">#to create a figure object</span>

<span class="n">xlimits</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">]</span>   <span class="c1">#to make sure we use the same of the X-axis boundaries for both plots</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.51</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>   <span class="c1">#to specify the coordinates, width and height of the top plot</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>   <span class="c1">#to specify the coordinates, width and height of the bottom plot</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">BSAconc</span><span class="p">,</span> <span class="n">A562nm</span><span class="p">,</span>   <span class="c1">#plot a set of x (=the concentrations),y (= the measured absorbances) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>   <span class="c1">#use a round, black marker with size 8 but use no line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>   <span class="c1">#use a label for the legend</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">BSAconc</span><span class="p">,</span> <span class="n">funcline</span><span class="p">(</span><span class="n">BSAconc</span><span class="p">,</span> <span class="o">*</span><span class="n">paramsSC</span><span class="p">),</span>   <span class="c1">#plot a set of x (=the concentrations),y (= the calculated absorbances using the fit parameters (the star unpacks the *paramsSC array) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span>  <span class="c1">#use no marker but use a solid, gray line</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span><span class="p">)</span>   <span class="c1">#use a label for the legend</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>   <span class="c1">#adds a horizontal line at y=0</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">xlimits</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">])</span>   <span class="c1">#sets the X-axis and Y-axis boundaries for the top plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>   <span class="c1">#removes the ticks and tick labels on the X-axis for the top plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;A562nm (AU)&#39;</span><span class="p">)</span>   <span class="c1">#adds Y-axis title for the top plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>   <span class="c1">#include legend</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">BSAconc</span><span class="p">,</span> <span class="n">residSC</span><span class="p">,</span>   <span class="c1">#plot a set of x (=the concentrations),y (= the residuals) data points</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>   <span class="c1">#use gray datapoints size 8 and a line</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>   <span class="c1">#adds a horizontal line at y=0</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">xlimits</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.08</span><span class="p">,</span><span class="mf">0.08</span><span class="p">])</span>   <span class="c1">#sets the X-axis and Y-axis boundaries for the bottom plot</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$[BSA]$ ($mg$ $ml^{-1}$)&#39;</span><span class="p">)</span>   <span class="c1">#adds X-axis title for the bottom plot, which is the same for the top plot</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Residuals&#39;</span><span class="p">)</span>   <span class="c1">#adds Y-axis title for the bottom plot</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1">#show the figure object</span>
</pre></div>
</div>
</section>
</div>
</section>
<section id="font-color-blue-linear-regression-font">
<h2><strong><font color=blue>Linear regression</font></strong><a class="headerlink" href="#font-color-blue-linear-regression-font" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>Of note, other functions for linear regression exist:</p>
<ul class="simple">
<li><p>The <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.linregress.html">scipy.stats.linregress</a> function calculates the analytical solution. This function is more computationally efficient and the result doesn’t depend on <em>e.g.</em> starting estimates.</p></li>
<li><p>The <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.polyfit.html">numpy.polyfit</a> function is used for a least squares polynomial fit. The newer <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.polynomial.polynomial.polyfit.html">numpy.polynomial.polynomial.polyfit</a> is preferred though. These functions facilitates the coding part (no need to define the function). Also, no starting estimates are needed.</p></li>
<li><p>…</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="MatplotlibForPlotting.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Matplotlib For Plotting And Data Visualization</p>
      </div>
    </a>
    <a class="right-next"
       href="../examples/DoseResponseCurve.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Dose response curve</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-models-and-parameters-font"><strong><font color="blue">Models and parameters</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-least-squares-fitting-font"><strong><font color="blue">Least squares fitting</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-unweighted-and-weighted-fits-font"><strong><font color="blue">Unweighted and weighted fits</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-the-scipy-optimize-curve-fit-function-fit-parameters-and-standard-errors-of-the-fit-parameters-font"><strong><font color="blue">The <code class="docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code> function, fit parameters, and standard errors of the fit parameters</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-steps-font"><strong><font color="blue">Steps</font></strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-blue-linear-regression-font"><strong><font color="blue">Linear regression</font></strong></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Renee Vancraenenbroeck, UCL
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>